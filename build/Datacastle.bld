<?xml version='1.0' encoding='utf-8'?>
<project version='9' encrypted='1'>
	<steps type='0'>
		<step action='Group'>
			<name>Project steps</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>StartBuild</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Major Build Stage</SubName>
			<indent type='3'>1</indent>
			<name>Log Major Build Stage - Start</name>
		</step>
		<step action='Group'>
			<indent type='3'>1</indent>
			<name>INITIALISE</name>
		</step>
		<step action='Log Message'>
			<Message>Build Type has been set to %BUILD_TYPE%</Message>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>2</indent>
			<name>Echo Build Type Message</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ClientSxSOverrideLoopCount</MacroName>
			<MacroValue>0</MacroValue>
			<condcompareto>true</condcompareto>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>2</indent>
			<name>Set default ClientSxSOverrideLoopCount to 0</name>
		</step>
		<step action='Set Macro'>
			<MacroEnvVar type='11'>-1</MacroEnvVar>
			<MacroName>__COMPAT_LAYER</MacroName>
			<MacroValue>DisableNXShowUI RunAsAdmin</MacroValue>
			<description><![CDATA[We must override this variable in Visual Build Pro v6.
If we don't, the GUI fails to build the Wix installer with stdafx.cpp compiler errors.]]></description>
			<indent type='3'>2</indent>
			<name>Override __COMPAT_LAYER macro</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%changeset%</condexpr>
			<indent type='3'>2</indent>
			<name>Check for Shelf info</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>3</indent>
			<name>Check for FastBuildSwitches - only possible if shelf so never have half done release builds</name>
		</step>
		<step action='Set Macro'>
			<MacroName>FastBuildSwitches</MacroName>
			<MacroValue>%READ_INI(%PROJDIR%\BuildTweaks\shelf.ini, ShelfInfo, FastBuildSwitches,"NoSwitches")%</MacroValue>
			<condcompareto>true</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Retrieve FastBuildSwitches from buildtweaks\shelf.INI</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotObfusateVault</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotObfusateVault</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotObfusateVault</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotBuildClients</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotBuildClients</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotBuildClients</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotBuildAzurePackage</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotBuildAzurePackage</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotBuildAzurePackage</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeSQLExpress</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeSQLExpress</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeSQLExpress</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeQuickCache</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeQuickCache</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeQuickCache</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeVaultMSIZip</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeVaultMSIZip</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeVaultMSIZip</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeNUnitSolution</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeNUnitSolution</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeNUnitSolution</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoIncludeDebugBinariesPDBs</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoIncludeDebugBinariesPDBs</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoIncludeDebugBinariesPDBs</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeTools</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeTools</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeTools</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeResetServer</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeResetServer</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeResetServer</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeLDAPSync</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeLDAPSync</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeLDAPSync</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludePassphraseClient</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludePassphraseClient</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludePassphraseClient</name>
		</step>
		<step action='Set Macro'>
			<MacroName>IncludeLDAPSyncPDBs</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>IncludeLDAPSyncPDBs</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set IncludeLDAPSyncPDBs</name>
		</step>
		<step action='Set Macro'>
			<MacroName>SkipClientObfuscation</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>SkipClientObfuscation</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set SkipClientObfuscation</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotObfuscateQuickCache</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotObfuscateQuickCache</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotObfuscateQuickCache</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotObfuscateTools</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotObfuscateTools</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotObfuscateTools</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotObfuscateResetServer</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotObfuscateResetServer</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotObfuscateResetServer</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeSigning</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeSigning</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeSigning</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeMacClient</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeMacClient</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeMacClient</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludeAzure</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeAzure</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludeAzure</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoNotIncludePrecompiledHelp</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludePrecompiledHelp</condcompareto>
			<condcomparison type='3'>2</condcomparison>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoNotIncludePrecompiledHelp</name>
		</step>
		<step action='Log Message'>
			<Message><![CDATA[****FastBuildSwitches set to: "%FastBuildSwitches%"
]]></Message>
			<condexpr>%changeset%</condexpr>
			<indent type='3'>4</indent>
			<name>Echo FastBuildSwitches</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DoIncludeDebugBinariesPDBs</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>2</indent>
			<name>Always set DoIncludeDebugBinariesPDBs if nightly build</name>
		</step>
		<step action='Log Message'>
			<Message><![CDATA[

"Unit Tests" is set to occur later in this build

]]></Message>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%RUN_UNIT_TESTS%</condexpr>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>2</indent>
			<name>Echo Run unit Tests Message</name>
		</step>
		<step action='Set Macro'>
			<MacroName>BuildSqlProj</MacroName>
			<MacroValue>false</MacroValue>
			<condcompareto>DoNotIncludeNUnitSolution</condcompareto>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>2</indent>
			<name>Set BuildSqlProj to false</name>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Calculate Release Version</name>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Normal Non-Vault Branding build</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr><![CDATA[<Major>,<Minor> release version]]></MacroDescr>
			<MacroName>RELEASE_VERSION_BASE</MacroName>
			<MacroValue>%READ_INI(%RELEASE_VERSION_INI%, release version, releaseversion_base, 9.1)%</MacroValue>
			<indent type='3'>4</indent>
			<name>Read major/minor release version from ini file</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr><![CDATA[Format <Major>.<Minor>, stamped into user doc such as web help.]]></MacroDescr>
			<MacroName>RELEASE_VERSION_README</MacroName>
			<MacroValue>%RELEASE_VERSION_BASE%</MacroValue>
			<indent type='3'>4</indent>
			<name>Set Macro RELEASE_VERSION_README</name>
			<nologging type='11'>-1</nologging>
		</step>
		<step action='Set Macro'>
			<MacroName>BUILD_VERSION</MacroName>
			<MacroValue>%BUILD_NUMBER%</MacroValue>
			<condcompareto>INTERNAL</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<description>%BUILD_VERSION% is passed inas Jenkins environment variable %BUILD_NUMBER%</description>
			<indent type='3'>4</indent>
			<name>Set Build Version from Jenkins BUILD_NUMBER</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr>Third segment of the release version, usually a "patch" number.  A release will have a specific number while Dev work will use the build number mod 1000 (can only be three digitis).</MacroDescr>
			<MacroName>RELEASE_VERSION_THIRDSEGMENT</MacroName>
			<MacroValue>%READ_INI(%RELEASE_VERSION_INI%, release version, releaseversion_thirdsegment,[%BUILD_VERSION%  mod 1000])%</MacroValue>
			<description><![CDATA[If the "Patch" or third segment of the release version is available from the ini file
   use that,
else
     use the build version mod 1000 (must be at most three digits).

In general, a release will have a specific number in the ini file, while a Dev build will use the build number.  Product update logic looks at the first three segments of the version, so this will let Dev/QE update with every build (except when it loops through 1000), while using a release version that makes sense.]]></description>
			<indent type='3'>4</indent>
			<name>Read release version third segment (patch?) from ini file</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr><![CDATA[Format <Major>.<Minor>.<Patch>]]></MacroDescr>
			<MacroName>RELEASE_VERSION</MacroName>
			<MacroValue>%RELEASE_VERSION_BASE%.%RELEASE_VERSION_THIRDSEGMENT%</MacroValue>
			<indent type='3'>4</indent>
			<name>Set Macro RELEASE_VERSION</name>
			<nologging type='11'>-1</nologging>
		</step>
		<step action='Set Macro'>
			<MacroName>DoPDBs</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>4</indent>
			<name>Set DoPDBs if Nightly BuildType</name>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Vault Branding Build</name>
		</step>
		<step action='Set Macro'>
			<MacroName>RELEASE_VERSION</MacroName>
			<MacroType type='3'>1</MacroType>
			<MacroValue>%BRAND_VAULT_VERSION%</MacroValue>
			<condexpr>%BUILD_LABEL%</condexpr>
			<indent type='3'>4</indent>
			<name>Calculate Release Version</name>
		</step>
		<step action='Set Macro'>
			<MacroName>BUILD_DATE</MacroName>
			<MacroValue>[vbld_FormatDate()][vbld_FormatTime()]</MacroValue>
			<indent type='3'>3</indent>
			<name>Calculate New Build Date</name>
		</step>
		<step action='Set Macro'>
			<MacroName>FULL_BUILD_NUMBER</MacroName>
			<MacroValue>%RELEASE_VERSION%.%BUILD_VERSION%</MacroValue>
			<indent type='3'>3</indent>
			<name>Calculate full build number</name>
		</step>
		<step action='Set Macro'>
			<MacroName>BUILD_LABEL</MacroName>
			<MacroValue>%COMPANY_NAME% %FULL_BUILD_NUMBER%</MacroValue>
			<condexpr>%BUILD_LABEL%</condexpr>
			<description><![CDATA[Build Label calculated from Release & Build Label]]></description>
			<indent type='3'>3</indent>
			<name>Calculate Build Label</name>
		</step>
		<step action='Log Message'>
			<Message><![CDATA[

STARTING BUILD %BUILD_LABEL% AT %BUILD_DATE%

]]></Message>
			<indent type='3'>3</indent>
			<name>Echo Build Number</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>C</ParamValues>
			<ParamValues>1</ParamValues>
			<Parameters array='0'>DISK_DRIVE</Parameters>
			<Parameters>GB_FREE</Parameters>
			<SubName>Check Free Space on Disk</SubName>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>2</indent>
			<name>Check Free Space on C:\ Drive</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>D</ParamValues>
			<ParamValues>4</ParamValues>
			<Parameters array='0'>DISK_DRIVE</Parameters>
			<Parameters>GB_FREE</Parameters>
			<SubName>Check Free Space on Disk</SubName>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>2</indent>
			<name>Check Free Space on D:\ Drive</name>
		</step>
		<step action='Run Program'>
			<command>net use \\%MACBUILD%\BuildMachineUsageOnly /u:%MACBUILD_USER% %MACBUILD_PWD% </command>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeMacClient%</condexpr>
			<indent type='3'>2</indent>
			<name>Check connection to mac build machine</name>
			<outputfrom type='3'>1</outputfrom>
			<precommand>echo Attempting to connect to: \\%MACBUILD%\BuildMachineUsageOnly ...</precommand>
		</step>
		<step action='Group'>
			<indent type='3'>1</indent>
			<name>Setup DeploymentFiles Directory</name>
		</step>
		<step action='Delete Folder'>
			<Path>%WORKING_DIRECTORY%\DeploymentFiles\</Path>
			<Recurse type='11'>-1</Recurse>
			<description>Clean up from any previous builds</description>
			<indent type='3'>2</indent>
			<name>Clean DeploymentFiles folder</name>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>cmd /c mkdir %WORKING_DIRECTORY%\DeploymentFiles\</command>
			<condcompareto>INTERNAL</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>2</indent>
			<name>Create DeploymentFiles directory</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%PROJDIR%\BuildTweaks\Shelf.ini"  "%WORKING_DIRECTORY%\DeploymentFiles\Shelf.ini"</command>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%changeset%</condexpr>
			<indent type='3'>2</indent>
			<name>Copy shelf.ini to Output DeploymentFiles folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Set Macro'>
			<MacroName>OUTPUTSUBDIR</MacroName>
			<MacroValue>All</MacroValue>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%OUTPUTSUBDIR%</condexpr>
			<indent type='3'>2</indent>
			<name>Set OUTPUTSUBDIR if not set</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivateSourceCode-%FULL_BUILD_NUMBER%.zip</Dest>
			<ExclExt><![CDATA[MiscInternalTools/AWSAutomation/*.*
MiscInternalTools/VMAutomation/CreateDeviceAndActivateVNext/DCProtect.msi
Samples/EdgaFilesOData/*.*
/DeploymentFiles
/.git]]></ExclExt>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP Source for Backup</name>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>1</indent>
			<name>Compile Solutions</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>StartCompileSolutions</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Major Build Stage</SubName>
			<indent type='3'>2</indent>
			<name>Log Major Build Stage - StartCompileSolutions</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>CompileSolutions-BeforeBuildProd</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Major Build Stage</SubName>
			<indent type='3'>2</indent>
			<name>Log Major Build Stage - CompileSolutions-BeforeMasterProd</name>
		</step>
		<step action='Run Program'>
			<command>nuget restore %WORKING_DIRECTORY%\Core.sln</command>
			<description>Restore packages using nuget</description>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>2</indent>
			<name>Restore Nuget </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Make VS.NET'>
			<AssemblyVer type='11'>-1</AssemblyVer>
			<Config>Debug|Any CPU</Config>
			<FileVer type='11'>-1</FileVer>
			<Filename>%WORKING_DIRECTORY%\BuildTools.sln</Filename>
			<Location>%PROGFILES%\Microsoft Visual Studio\2017\Enterprise\MSBuild\15.0\Bin\msbuild.exe</Location>
			<LogLevel type='3'>2</LogLevel>
			<Options>/flp:logfile=%LOGFILE%;Append;Summary;Verbosity=minimal; /maxcpucount:%NUMBER_OF_PROCESSORS% /nr:false   /nologo /consoleloggerparameters:ErrorsOnly;Summary;</Options>
			<ParseOutput type='11'>-1</ParseOutput>
			<ProdVer type='11'>-1</ProdVer>
			<Property1>%COMPANY_NAME%</Property1>
			<Property3>%COPYRIGHT%</Property3>
			<Property5>%PRODUCT_NAME%</Property5>
			<PropertyOn1 type='11'>-1</PropertyOn1>
			<PropertyOn3 type='11'>-1</PropertyOn3>
			<PropertyOn5 type='11'>-1</PropertyOn5>
			<ShowCmd type='11'>-1</ShowCmd>
			<Version>%RELEASE_VERSION%.%BUILD_VERSION%</Version>
			<VersionSel type='3'>2</VersionSel>
			<indent type='3'>2</indent>
			<name>Make VS: BuildTools Solution (Debug)</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\BuildTools</DestDir>
			<Ext>*.exe</Ext>
			<FailNone type='11'>-1</FailNone>
			<Flat type='11'>-1</Flat>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\StoredProcScriptGenerator\StoredProcGeneratorCmd\bin\Debug</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Copy BuildTools to DeploymentFfiles/BuildTools</name>
		</step>
		<step action='Make VS.NET'>
			<AssemblyVer type='11'>-1</AssemblyVer>
			<Config>Release|Any CPU</Config>
			<FileVer type='11'>-1</FileVer>
			<Filename>%WORKING_DIRECTORY%\Core.sln</Filename>
			<Location>%PROGFILES%\Microsoft Visual Studio\2017\Enterprise\MSBuild\15.0\Bin\msbuild.exe</Location>
			<LogLevel type='3'>2</LogLevel>
			<Options>/flp:logfile=%LOGFILE%;Append;Summary;Verbosity=minimal; /maxcpucount:%NUMBER_OF_PROCESSORS% /nr:false   /nologo /consoleloggerparameters:ErrorsOnly;Summary /t:Server\VaultDbRESTApp /p:DeployDbHelper=CustomProfile</Options>
			<ParseOutput type='11'>-1</ParseOutput>
			<ProdVer type='11'>-1</ProdVer>
			<Property1>%COMPANY_NAME%</Property1>
			<Property3>%COPYRIGHT%</Property3>
			<Property5>%PRODUCT_NAME%</Property5>
			<PropertyOn1 type='11'>-1</PropertyOn1>
			<PropertyOn3 type='11'>-1</PropertyOn3>
			<PropertyOn5 type='11'>-1</PropertyOn5>
			<ShowCmd type='11'>-1</ShowCmd>
			<Version>%RELEASE_VERSION%.%BUILD_VERSION%</Version>
			<VersionSel type='3'>2</VersionSel>
			<indent type='3'>3</indent>
			<name>Make VS: Build VaultDBHelper Web Package (Release)</name>
		</step>
		<step action='Make VS.NET'>
			<AssemblyVer type='11'>-1</AssemblyVer>
			<Config>Release|Any CPU</Config>
			<FileVer type='11'>-1</FileVer>
			<Filename>%WORKING_DIRECTORY%\Core.sln</Filename>
			<Location>%PROGFILES%\Microsoft Visual Studio\2017\Enterprise\MSBuild\15.0\Bin\msbuild.exe</Location>
			<LogLevel type='3'>2</LogLevel>
			<Options>/flp:logfile=%LOGFILE%;Append;Summary;Verbosity=minimal; /maxcpucount:%NUMBER_OF_PROCESSORS% /nr:false   /nologo /consoleloggerparameters:ErrorsOnly;Summary; </Options>
			<ParseOutput type='11'>-1</ParseOutput>
			<ProdVer type='11'>-1</ProdVer>
			<Property1>%COMPANY_NAME%</Property1>
			<Property3>%COPYRIGHT%</Property3>
			<Property5>%PRODUCT_NAME%</Property5>
			<PropertyOn1 type='11'>-1</PropertyOn1>
			<PropertyOn3 type='11'>-1</PropertyOn3>
			<PropertyOn5 type='11'>-1</PropertyOn5>
			<ShowCmd type='11'>-1</ShowCmd>
			<Version>%RELEASE_VERSION%.%BUILD_VERSION%</Version>
			<VersionSel type='3'>2</VersionSel>
			<indent type='3'>2</indent>
			<name>Make VS: Build Solution (Release)</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\VaultDBHelper-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.cmd
*.txt
*.xml
*.zip]]></Ext>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\Server\VaultDbRESTApp\package</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP Client VaultDbHelper CMD/TXT/XMLs/ZIP for DeploymentFiles</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivatePDBBinariesClient-Release-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.dll
*.exe
*.pdb
]]></Ext>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%/Core/Client/ProtectionStatusService/bin/Release</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP Client ProtectionStatusService PDBs/DLLs for Backup</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivatePDBBinariesClient-Release-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.dll
*.exe
*.pdb
]]></Ext>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%/Core/Client/ProtectionService/bin/Release</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP Client ProtectionService PDBs/DLLs for Backup</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivatePDBBinariesClient-Release-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.dll
*.exe
*.pdb
]]></Ext>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%/Core/Client/DCProtect/bin/Release</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP Client DCProtect PDBs/DLLs for Backup</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivatePDBBinariesClient-Release-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.dll
*.exe
*.pdb
]]></Ext>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%/Core/Client/DCNotifier/bin/Release</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP Client Notifier PDBs/DLLs for Backup</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivatePDBBinariesQuickCache-Release-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.dll
*.exe
*.pdb
]]></Ext>
			<LogDetail type='11'>-1</LogDetail>
			<NoPaths type='11'>-1</NoPaths>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%/Core/Server/Datacastle.RDN/Datatcastle.RDNService/bin/Release</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP QuickCache PDBs/DLLs for Backup</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivatePDBBinariesVaultServices-Release-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.dll
*.exe
*.pdb
]]></Ext>
			<LogDetail type='11'>-1</LogDetail>
			<NoPaths type='11'>-1</NoPaths>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\Server\Datacastle.Vault.Service\bin\Release</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP Vault Services PDBs/DLLs for Backup</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivatePDBBinariesBlockManagementService-Release-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.dll
*.exe
*.pdb
]]></Ext>
			<LogDetail type='11'>-1</LogDetail>
			<NoPaths type='11'>-1</NoPaths>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\Server\Datacastle.Server.BlockManagementService\bin\Release</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP Block Management Service PDBs/DLLs for Backup</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivatePDBBinariesLDAPSync-Release-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.dll
*.exe
*.pdb
]]></Ext>
			<LogDetail type='11'>-1</LogDetail>
			<NoPaths type='11'>-1</NoPaths>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\Tools\LdapSynchronizationService\bin\Release</Source>
			<checked type='11'>0</checked>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP LDAP Sync PDBs/DLLs for Backup</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\MergeDBScripts-Release-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[CEPMergeDashboardObjectsIntoDC.sql
CEPMoveDashboardDataToDC.sql]]></Ext>
			<Hidden type='11'>-1</Hidden>
			<NoPaths type='11'>-1</NoPaths>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP Combine DB Scripts</name>
		</step>
		<step action='Delete Files'>
			<Ext>LdapSynchronization.config.xml</Ext>
			<LogDel type='11'>-1</LogDel>
			<Path>%WORKING_DIRECTORY%\Core\Tools\LdapSynchronizationService\bin\Release</Path>
			<checked type='11'>0</checked>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeLDAPSync%</condexpr>
			<indent type='3'>2</indent>
			<name>Delete dev version of LdapSynchronization.config.xml</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<checked type='11'>0</checked>
			<command>cmd /c ren "%WORKING_DIRECTORY%\Core\Tools\LdapSynchronizationService\bin\Release\LdapSynchronization.release.config.xml"  LdapSynchronization.config.xml</command>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeLDAPSync%</condexpr>
			<indent type='3'>2</indent>
			<name>Rename LdapSynchronization.release.config.xml</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\DCLdapSync-%FULL_BUILD_NUMBER%.zip</Dest>
			<ExclExt><![CDATA[*.pdb
]]></ExclExt>
			<Ext>*.*</Ext>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\Tools\LdapSynchronizationService\bin\Release</Source>
			<checked type='11'>0</checked>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeLDAPSync%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>2</indent>
			<name>ZIP LdapSyncService</name>
		</step>
		<step action='Process Files'>
			<FileExtensions>DashboardDb.sqlproj</FileExtensions>
			<FilePath>%WORKING_DIRECTORY%\Core\Database\DashboardDb</FilePath>
			<indent type='3'>2</indent>
			<name>Look for sqlproj files</name>
		</step>
		<step action='Set Macro'>
			<MacroName>BuildSqlProj</MacroName>
			<MacroValue>true</MacroValue>
			<condcompareto>DoNotIncludeNUnitSolution</condcompareto>
			<condexpr>%FastBuildSwitches%</condexpr>
			<indent type='3'>3</indent>
			<name>Set BuildSqlProj to true</name>
		</step>
		<step action='Make VS.NET'>
			<AssemblyVer type='11'>-1</AssemblyVer>
			<Config>Release|Any CPU</Config>
			<FileVer type='11'>-1</FileVer>
			<Filename>%WORKING_DIRECTORY%\Databases.sln</Filename>
			<Location>%PROGFILES%\Microsoft Visual Studio\2017\Enterprise\MSBuild\15.0\Bin\msbuild.exe</Location>
			<LogLevel type='3'>2</LogLevel>
			<Options>/flp:logfile=%LOGFILE%;Append;Summary;Verbosity=minimal; /maxcpucount:%NUMBER_OF_PROCESSORS% /nr:false   /nologo /consoleloggerparameters:ErrorsOnly;Summary;</Options>
			<ParseOutput type='11'>-1</ParseOutput>
			<ProdVer type='11'>-1</ProdVer>
			<Property1>%COMPANY_NAME%</Property1>
			<Property3>%COPYRIGHT%</Property3>
			<Property5>%PRODUCT_NAME%</Property5>
			<PropertyOn1 type='11'>-1</PropertyOn1>
			<PropertyOn3 type='11'>-1</PropertyOn3>
			<PropertyOn5 type='11'>-1</PropertyOn5>
			<ShowCmd type='11'>-1</ShowCmd>
			<Version>%RELEASE_VERSION%.%BUILD_VERSION%</Version>
			<VersionSel type='3'>2</VersionSel>
			<indent type='3'>2</indent>
			<name>Make VS: Databases (Release)</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>7</condcomparison>
			<condexpr>%BuildSqlProj%</condexpr>
			<indent type='3'>2</indent>
			<name>Deploy to generate script for dbproj</name>
		</step>
		<step action='Run Program'>
			<command>C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\msbuild.exe %WORKING_DIRECTORY%\Core\Database\DashboardDb\Dashboarddb.dbproj /t:dspdeploy /nr:false /p:Configuration=Release "/p:Platform=Any CPU"</command>
			<indent type='3'>3</indent>
			<name>Use MSBuild to deploy Dashboard DB (generate script)</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\msbuild.exe %WORKING_DIRECTORY%\Core\Database\DatacastleDb\Datacastledb.dbproj /t:dspdeploy /nr:false /p:Configuration=Release "/p:Platform=Any CPU"</command>
			<indent type='3'>3</indent>
			<name>Use MSBuild to deploy Datacastle DB (generate script)</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Make VS.NET'>
			<AssemblyVer type='11'>-1</AssemblyVer>
			<Config>Debug|Any CPU</Config>
			<FileVer type='11'>-1</FileVer>
			<Filename>%WORKING_DIRECTORY%\NUnitTestFx.sln</Filename>
			<Location>%PROGFILES%\Microsoft Visual Studio\2017\Enterprise\MSBuild\15.0\Bin\msbuild.exe</Location>
			<LogLevel type='3'>2</LogLevel>
			<Options>/flp:logfile=%LOGFILE%;Append;Summary;Verbosity=minimal; /maxcpucount:%NUMBER_OF_PROCESSORS% /nr:false   /nologo /consoleloggerparameters:ErrorsOnly;Summary;</Options>
			<ParseOutput type='11'>-1</ParseOutput>
			<ProdVer type='11'>-1</ProdVer>
			<Property1>%COMPANY_NAME%</Property1>
			<Property3>%COPYRIGHT%</Property3>
			<Property5>%PRODUCT_NAME%</Property5>
			<PropertyOn1 type='11'>-1</PropertyOn1>
			<PropertyOn3 type='11'>-1</PropertyOn3>
			<PropertyOn5 type='11'>-1</PropertyOn5>
			<ShowCmd type='11'>-1</ShowCmd>
			<Version>%RELEASE_VERSION%.%BUILD_VERSION%</Version>
			<VersionSel type='3'>2</VersionSel>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeNUnitSolution%</condexpr>
			<indent type='3'>2</indent>
			<name>Make VS: NUnit Testing Solution (Debug)</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>CompileSolutions-BeforeTesting</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Major Build Stage</SubName>
			<indent type='3'>2</indent>
			<name>Log Major Build Stage - CompileSolutions-BeforeTesting</name>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Build and Copy Dashboard</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DashboardBuildScript.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DashboardBuildScript.xml</FileOut>
			<Find>WORKING_DIR</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%WORKING_DIRECTORY%</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[replacing version in:  <?define BUILDNUM="1.0.0.0" ?>
]]></description>
			<indent type='3'>3</indent>
			<name>Replace Main branch with this build branch name</name>
		</step>
		<step action='MSBuild'>
			<Exe>%PROGFILES%\Microsoft Visual Studio\2017\Enterprise\MSBuild\15.0\Bin\msbuild.exe</Exe>
			<Options>/nologo</Options>
			<ProjectFile>%WORKING_DIRECTORY%\DashboardBuildScript.xml</ProjectFile>
			<ShowCmd type='11'>-1</ShowCmd>
			<Targets>PrecompiledWeb</Targets>
			<Verbosity>Normal</Verbosity>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>3</indent>
			<name>Build Dashboard precompiled web</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivatePDBBinariesDashboard-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.dll
*.exe
*.pdb
]]></Ext>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\PrecompiledWeb\bin</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>3</indent>
			<name>ZIP Dashboard PDBs/DLLs for Backup</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\PrecompiledWeb\bin</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext><![CDATA[*.pdb
]]></Ext>
			<Hidden type='11'>-1</Hidden>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Delete extra PDBs from PreCompiledWeb\bin folder</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeviceResetBuildScript.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeviceResetBuildScript.xml</FileOut>
			<Find>WORKING_DIR</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%WORKING_DIRECTORY%</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[replacing version in:  <?define BUILDNUM="1.0.0.0" ?>
]]></description>
			<indent type='3'>3</indent>
			<name>Replace Main branch with this build branch name</name>
		</step>
		<step action='MSBuild'>
			<Exe>%PROGFILES%\Microsoft Visual Studio\2017\Enterprise\MSBuild\15.0\Bin\msbuild.exe</Exe>
			<Options>/nologo</Options>
			<ProjectFile>%WORKING_DIRECTORY%\DeviceResetBuildScript.xml</ProjectFile>
			<ShowCmd type='11'>-1</ShowCmd>
			<Targets>PrecompiledWeb</Targets>
			<Verbosity>Normal</Verbosity>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>3</indent>
			<name>Build DeviceReset precompiled web</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivatePDBBinariesDeviceResetWeb-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.dll
*.exe
*.pdb
]]></Ext>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\DeviceResetPrecompiledWeb\bin</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>3</indent>
			<name>ZIP DeviceReset PDBs/DLLs for Backup</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeviceResetPrecompiledWeb\bin</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.pdb</Ext>
			<Hidden type='11'>-1</Hidden>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Delete extra PDBs from DeviceResetPreCompiledWeb/bin folder</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeviceResetPrecompiledWeb</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>web.config</Ext>
			<Hidden type='11'>-1</Hidden>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Delete extra web.config from DeviceResetPreCompiledWeb folder</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c move /Y "%WORKING_DIRECTORY%\DeviceResetPrecompiledWeb\web-release.config" "%WORKING_DIRECTORY%\DeviceResetPrecompiledWeb\web.config"</command>
			<indent type='3'>3</indent>
			<name>Move DeviceResetPrecompileWebApp\...\web-release.config to web.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BuildSqlProj%</condexpr>
			<indent type='3'>3</indent>
			<name>If building sqlproj</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DashboardDb_create.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DeployDashboard.sql</FileOut>
			<Find>/*/*/*/*/* START EXCLUDE /*/*/*/*/*.+?/*/*/*/*/* END EXCLUDE /*/*/*/*/*</Find>
			<Replace>-- SQL automatically excluded by build system</Replace>
			<description>This prevents unwanted items (such as population of test data) from appearing in our release SQL file</description>
			<indent type='3'>4</indent>
			<name>Remove excluded sections - Dashboard</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DashboardDb_create.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DashboardExcludedSectionOnly.sql</FileOut>
			<Find>\A.+?/*/*/*/*/* START EXCLUDE /*/*/*/*/*</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Replace>---Start test data, section above here removed by build</Replace>
			<description>This is used for when creating test vaults</description>
			<indent type='3'>4</indent>
			<name>Create new file with only top excluded section - Dashboard</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>7</condcomparison>
			<condexpr>%BuildSqlProj%</condexpr>
			<indent type='3'>3</indent>
			<name>If not building sqlproj</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DashboardDb.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DeployDashboard.sql</FileOut>
			<Find>/*/*/*/*/* START EXCLUDE /*/*/*/*/*.+?/*/*/*/*/* END EXCLUDE /*/*/*/*/*</Find>
			<Replace>-- SQL automatically excluded by build system</Replace>
			<description>This prevents unwanted items (such as population of test data) from appearing in our release SQL file</description>
			<indent type='3'>4</indent>
			<name>Remove excluded sections - Dashboard</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DashboardDb.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DashboardExcludedSectionOnly.sql</FileOut>
			<Find>\A.+?/*/*/*/*/* START EXCLUDE /*/*/*/*/*</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Replace>---Start test data, section above here removed by build</Replace>
			<description>This is used for when creating test vaults</description>
			<indent type='3'>4</indent>
			<name>Create new file with only top excluded section - Dashboard</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DeployDashboard.sql</FileIn>
			<Find>:setvar databasename .+</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>:setvar databasename "@@DATABASENAME@@"</Replace>
			<description>Variable used by deployment scripts</description>
			<indent type='3'>3</indent>
			<name>Rename database to variable</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DeployDashboard.sql</FileIn>
			<Find>:setvar defaultdatapath .+</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>:setvar defaultdatapath "@@DATABASEPATH@@"</Replace>
			<description>Variable used by deployment scripts</description>
			<indent type='3'>3</indent>
			<name>Add variable for location</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DashboardExcludedSectionOnly.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DashboardExcludedSectionOnly.sql</FileOut>
			<Find>/*/*/*/*/* END EXCLUDE /*/*/*/*/*.+?\z</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Replace>---End test data, section below here removed by build</Replace>
			<description>This is used for when creating test vaults</description>
			<indent type='3'>3</indent>
			<name>Remove anything below bottom excluded section - Dashboard</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Core\Database\DashboardDb\Scripts\Post-Deployment\PopulateTestDataForTestVault.sql" "%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\PopulateDashboardTestDataForTestVault.sql"</command>
			<indent type='3'>3</indent>
			<name>Copy Test Vault DBScript</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludePrecompiledHelp%</condexpr>
			<indent type='3'>1</indent>
			<name>Copy PreCompiled Help</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c if exist "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\UIAssetsTemplate" rmdir /S /Q "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\UIAssetsTemplate"</command>
			<indent type='3'>2</indent>
			<name>Delete UIAssetsTemplate if it exists</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c mkdir "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\UIAssetsTemplate"</command>
			<indent type='3'>2</indent>
			<name>Create UIAssetsTemplate in client layout</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(en-en)-%FULL_BUILD_NUMBER%.zip</Dest>
			<HideOn type='11'>-1</HideOn>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\CompiledHelp\WebHelp(en-en)</Source>
			<SysOn type='11'>-1</SysOn>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>2</indent>
			<name>ZipAndCopy EN Web Help</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(de-de)-%FULL_BUILD_NUMBER%.zip</Dest>
			<HideOn type='11'>-1</HideOn>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\CompiledHelp\WebHelp(de-de)</Source>
			<SysOn type='11'>-1</SysOn>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>2</indent>
			<name>ZipAndCopy DE Web Help</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(es-es)-%FULL_BUILD_NUMBER%.zip</Dest>
			<HideOn type='11'>-1</HideOn>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\CompiledHelp\WebHelp(es-es)</Source>
			<SysOn type='11'>-1</SysOn>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>2</indent>
			<name>ZipAndCopy ES Web Help</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(ja-jp)-%FULL_BUILD_NUMBER%.zip</Dest>
			<HideOn type='11'>-1</HideOn>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\CompiledHelp\WebHelp(ja-jp)</Source>
			<SysOn type='11'>-1</SysOn>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>2</indent>
			<name>ZipAndCopy JP Web Help</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(fr-fr)-%FULL_BUILD_NUMBER%.zip</Dest>
			<HideOn type='11'>-1</HideOn>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\CompiledHelp\WebHelp(fr-fr)</Source>
			<SysOn type='11'>-1</SysOn>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>2</indent>
			<name>ZipAndCopy FR Web Help</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(it-it)-%FULL_BUILD_NUMBER%.zip</Dest>
			<HideOn type='11'>-1</HideOn>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\CompiledHelp\WebHelp(it-it)</Source>
			<SysOn type='11'>-1</SysOn>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>2</indent>
			<name>ZipAndCopy IT Web Help</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(ko-kr)-%FULL_BUILD_NUMBER%.zip</Dest>
			<HideOn type='11'>-1</HideOn>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\CompiledHelp\WebHelp(ko-kr)</Source>
			<SysOn type='11'>-1</SysOn>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>2</indent>
			<name>ZipAndCopy KO Web Help</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(pl-pl)-%FULL_BUILD_NUMBER%.zip</Dest>
			<HideOn type='11'>-1</HideOn>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\CompiledHelp\WebHelp(pl-pl)</Source>
			<SysOn type='11'>-1</SysOn>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>2</indent>
			<name>ZipAndCopy PL Web Help</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(pt-br)-%FULL_BUILD_NUMBER%.zip</Dest>
			<HideOn type='11'>-1</HideOn>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\CompiledHelp\WebHelp(pt-br)</Source>
			<SysOn type='11'>-1</SysOn>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>2</indent>
			<name>ZipAndCopy PT Web Help</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(tr-tr)-%FULL_BUILD_NUMBER%.zip</Dest>
			<HideOn type='11'>-1</HideOn>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\CompiledHelp\WebHelp(tr-tr)</Source>
			<SysOn type='11'>-1</SysOn>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>2</indent>
			<name>ZipAndCopy TR Web Help</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(zh-cn)-%FULL_BUILD_NUMBER%.zip</Dest>
			<HideOn type='11'>-1</HideOn>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Core\CompiledHelp\WebHelp(zh-cn)</Source>
			<SysOn type='11'>-1</SysOn>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>2</indent>
			<name>ZipAndCopy ZH Web Help</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeResetServer%</condexpr>
			<indent type='3'>1</indent>
			<name>Build ResetServer - can be turned off by fast track build</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>Reset Server</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Minor Build Stage</SubName>
			<indent type='3'>2</indent>
			<name>Log Minor Build Stage - Reset Server</name>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>2</indent>
			<name>Build Reset Web App installer</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotObfuscateResetServer%</condexpr>
			<indent type='3'>3</indent>
			<name>Obfuscate with Dotfuscator - can be turned off</name>
		</step>
		<step action='Delete Folder'>
			<Path>%WORKING_DIRECTORY%\DeploymentFiles\ResetServer\ObfuscationBuildWorkingFolder</Path>
			<Recurse type='11'>-1</Recurse>
			<ShowCmd type='11'>-1</ShowCmd>
			<indent type='3'>4</indent>
			<name>Delete ResetServerObfuscationBuildWorkingFolder</name>
		</step>
		<step action='Create Folder'>
			<Path>%WORKING_DIRECTORY%\DeploymentFiles\ResetServer\ObfuscationBuildWorkingFolder</Path>
			<indent type='3'>4</indent>
			<name>Create ResetServerObfuscationBuildWorkingFolder</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\ResetServer\ObfuscationBuildWorkingFolder\</DestDir>
			<Ext>datacastle_dashboard.snk</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Datacastle.Dashboard\</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>4</indent>
			<name>Copy Datacastle Dashboard SNK File</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\ResetServer\ObfuscationBuildWorkingFolder</DestDir>
			<Empty type='11'>-1</Empty>
			<ExclExt>*.pdb</ExclExt>
			<Ext>*.*</Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeviceResetPrecompiledWeb\Bin</SourceDir>
			<TBD type='11'>-1</TBD>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Copy precompiled web/bin to obfuscation working folder</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\ResetServerProductionTemplateConfig\DotfuscatorResetServer.xml" "%WORKING_DIRECTORY%\DeploymentFiles\ResetServer\ObfuscationBuildWorkingFolder\DotfuscatorResetServer.xml"</command>
			<indent type='3'>4</indent>
			<name>Copy Dotfuscator ResetServer project file to working copy</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"dotfuscator.exe" /q "DotfuscatorResetServer.xml" </command>
			<indent type='3'>4</indent>
			<name>Run Dotfuscator to obfuscate</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\DeploymentFiles\ResetServer\ObfuscationBuildWorkingFolder</startin>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\ResetServer\ObfuscationBuildWorkingFolder</DestDir>
			<Ext><![CDATA[*.*
]]></Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\ResetServer\ObfuscationBuildWorkingFolder\Obfuscated</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy obfuscated files back</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\ResetServerWixTemplate</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\ResetServer</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy/backup whole ResetServer installer solution folder to ResetServerWixTemplate so can replace per brand</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\ResetServerWixTemplate\Website</DestDir>
			<Empty type='11'>-1</Empty>
			<ExclExt>*.pdb</ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeviceResetPrecompiledWeb</SourceDir>
			<TBD type='11'>-1</TBD>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Copy precompiled web to where installer expects it</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\ResetServerWixTemplate\Website\Bin</DestDir>
			<Ext><![CDATA[*.*
]]></Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\ResetServer\ObfuscationBuildWorkingFolder</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotObfuscateResetServer%</condexpr>
			<indent type='3'>3</indent>
			<name>Copy obfuscated files over top of binary folder</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\ResetServerProductionTemplateConfig\End User License Agreement.rtf" "%WORKING_DIRECTORY%\Deployment\Server\ResetServerWixTemplate\Installer\UIAssets\End User License Agreement.rtf"</command>
			<indent type='3'>3</indent>
			<name>Copy default License agreement</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Set Macro'>
			<MacroName>ResetServer_BRAND_LOOP_UBOUND</MacroName>
			<MacroValue>1</MacroValue>
			<condcompareto>True</condcompareto>
			<description><![CDATA[Reads the Number of Brands to build from Brand.ini
Defaults to 1 if Brand.ini does not exist.]]></description>
			<indent type='3'>3</indent>
			<name>Set Number of Brand to 1 only </name>
		</step>
		<step action='Set Macro'>
			<MacroName>ResetServer_BRAND_LOOP_UBOUND</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandResetServerInstaller\Brand.ini,BrandSetup,Number,1)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<description><![CDATA[Reads the Number of Brands to build from Brand.ini
Defaults to 1 if Brand.ini does not exist.]]></description>
			<indent type='3'>3</indent>
			<name>Read Number of Brands (if NIGHTLY, otherwise leave as 1)</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ResetServer_BRAND_LOOP_COUNT</MacroName>
			<MacroValue>0</MacroValue>
			<description>Initialize a counter macro value</description>
			<indent type='3'>3</indent>
			<name>Initialize brand Counter</name>
		</step>
		<step action='Group'>
			<condcompareto>%ResetServer_BRAND_LOOP_UBOUND%</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%ResetServer_BRAND_LOOP_COUNT%</condexpr>
			<condrepeat type='11'>-1</condrepeat>
			<indent type='3'>3</indent>
			<name>Build Installer Loop</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ResetServer_BRAND_LOOP_COUNT</MacroName>
			<MacroValue>[%ResetServer_BRAND_LOOP_COUNT%+1]</MacroValue>
			<description>Initialize a counter macro value</description>
			<indent type='3'>4</indent>
			<name>Increment Brand Counter</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\ResetServer</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<Hidden type='11'>-1</Hidden>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Delete ResetServer so can be replaced by ResetServerWixTemplate</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\ResetServer</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\ResetServerWixTemplate</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy ResetServerWixTemplate to ResetServer</name>
		</step>
		<step action='Group'>
			<description><![CDATA[
]]></description>
			<indent type='3'>4</indent>
			<name>Read brand vars from ini</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ResetServer_BRAND_FOLDER</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandResetServerInstaller\Brand.ini,Brand%ResetServer_BRAND_LOOP_COUNT%,Folder,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read ResetServer_BRAND_FOLDER</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ResetServer_BRAND_BRANDCORPNAME</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandResetServerInstaller\Brand.ini,Brand%ResetServer_BRAND_LOOP_COUNT%,InstallerBRANDCORPNAME,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read ResetServer_BRAND_BRANDCORPNAME</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ResetServer_BRAND_BRANDINFOURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandResetServerInstaller\Brand.ini,Brand%ResetServer_BRAND_LOOP_COUNT%,InstallerBRANDINFOURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read ResetServer_BRAND_BRANDINFOURL</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ResetServer_BRAND_BRANDNAME</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandResetServerInstaller\Brand.ini,Brand%ResetServer_BRAND_LOOP_COUNT%,InstallerBRANDNAME,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read ResetServer_BRAND_BRANDNAME</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ResetServer_BRAND_BRANDNAMEFILENAMEFRIENDLY</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandResetServerInstaller\Brand.ini,Brand%ResetServer_BRAND_LOOP_COUNT%,InstallerBRANDNAMEFILENAMEFRIENDLY,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read ResetServer_BRAND_BRANDNAMEFILENAMEFRIENDLY</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ResetServer_BRAND_BRANDSUPPORTURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandResetServerInstaller\Brand.ini,Brand%ResetServer_BRAND_LOOP_COUNT%,InstallerBRANDSUPPORTURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read ResetServer_BRAND_BRANDSUPPORTURL</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ResetServer_BRAND_BRANDUPDATEURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandResetServerInstaller\Brand.ini,Brand%ResetServer_BRAND_LOOP_COUNT%,InstallerBRANDUPDATEURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read ResetServer_BRAND_BRANDUPDATEURL</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ResetServer_BRAND_BRANDPROGFILESFOLDER</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandResetServerInstaller\Brand.ini,Brand%ResetServer_BRAND_LOOP_COUNT%,InstallerBRANDPROGFILESFOLDER,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read ResetServer_BRAND_BRANDPROGFILESFOLDER</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ResetServer_BRAND_TOSURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandResetServerInstaller\Brand.ini,Brand%ResetServer_BRAND_LOOP_COUNT%,TOSURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read ResetServer_BRAND_TOSURL</name>
		</step>
		<step action='Group'>
			<indent type='3'>4</indent>
			<name>Build MSI</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\ResetServer</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\BrandResetServerInstaller\%ResetServer_BRAND_FOLDER%\LayoutOverlay</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>5</indent>
			<name>Copy/overwrite Brand specific files to Build</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileOut>
			<Find>define\sBUILDNUM\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BUILDNUM=\"%RELEASE_VERSION%.%BUILD_VERSION%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[replacing version in:  <?define BUILDNUM="1.0.0.0" ?>
]]></description>
			<indent type='3'>5</indent>
			<name>Stamp Build number into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileOut>
			<Find>define\sBRANDBUILDFOLDERNAME\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDBUILDFOLDERNAME=\"%ResetServer_BRAND_FOLDER%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDBUILDFOLDERNAME into Buildvars.wxi (not currently used by installer but added for future usage)</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileOut>
			<Find>define\sBRANDCORPNAME\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDCORPNAME=\"%ResetServer_BRAND_BRANDCORPNAME%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDCORPNAME into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileOut>
			<Find>define\sBRANDINFOURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDINFOURL=\"%ResetServer_BRAND_BRANDINFOURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDINFOURL into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileOut>
			<Find>define\sBRANDNAME\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDNAME=\"%ResetServer_BRAND_BRANDNAME%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDNAME into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileOut>
			<Find>define\sBRANDNAMEFILENAMEFRIENDLY\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDNAMEFILENAMEFRIENDLY=\"%ResetServer_BRAND_BRANDNAMEFILENAMEFRIENDLY%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDNAMEFILENAMEFRIENDLY into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileOut>
			<Find>define\sBRANDSUPPORTURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDSUPPORTURL=\"%ResetServer_BRAND_BRANDSUPPORTURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDSUPPORTURL into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileOut>
			<Find>define\sBRANDUPDATEURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDUPDATEURL=\"%ResetServer_BRAND_BRANDUPDATEURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDUPDATEURL into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileOut>
			<Find>define\sBRANDPROGFILESFOLDER\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDPROGFILESFOLDER=\"%ResetServer_BRAND_BRANDPROGFILESFOLDER%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDPROGFILESFOLDER into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\Installer\BuildVars.wxi</FileOut>
			<Find>define\sBRANDTOSURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDTOSURL=\"%ResetServer_BRAND_TOSURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDTOSURL into Buildvars.wxi</name>
		</step>
		<step action='Make VS.NET'>
			<AssemblyVer type='11'>-1</AssemblyVer>
			<Config>Release|x86</Config>
			<FileVer type='11'>-1</FileVer>
			<Filename>%WORKING_DIRECTORY%\Deployment\Server\ResetServer\installer\ResetServer.sln</Filename>
			<Force type='3'>1</Force>
			<Location>%PROGFILES%\Microsoft Visual Studio\2017\Enterprise\MSBuild\15.0\Bin\msbuild.exe</Location>
			<LogLevel type='3'>2</LogLevel>
			<Options>/flp:logfile=%LOGFILE%;Append;Summary;Verbosity=minimal; /maxcpucount:%NUMBER_OF_PROCESSORS% /nr:false   /nologo /consoleloggerparameters:ErrorsOnly;Summary;</Options>
			<ParseOutput type='11'>-1</ParseOutput>
			<ProdVer type='11'>-1</ProdVer>
			<Property1>%COMPANY_NAME%</Property1>
			<Property3>%COPYRIGHT%</Property3>
			<Property5>%PRODUCT_NAME%</Property5>
			<PropertyOn1 type='11'>-1</PropertyOn1>
			<PropertyOn3 type='11'>-1</PropertyOn3>
			<PropertyOn5 type='11'>-1</PropertyOn5>
			<ShowCmd type='11'>-1</ShowCmd>
			<Version>%RELEASE_VERSION%.%BUILD_VERSION%</Version>
			<VersionSel type='3'>2</VersionSel>
			<indent type='3'>5</indent>
			<name>Make VS.NET: Wix ResetWebApp Setup </name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"%SIGN_DIR%\CodeSigningToolSHA256\SignSha256Only.cmd" "%WORKING_DIRECTORY%\Deployment\Server\ResetServer\installer\bin\Release\en-us\ResetServer.msi" "Carbonite Setup"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<description><![CDATA[
]]></description>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>5</indent>
			<name>Sign ResetServer Installer MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Server\ResetServer\installer\bin\Release\en-us\ResetServer.msi" "%WORKING_DIRECTORY%\DeploymentFiles\ResetServer--%FULL_BUILD_NUMBER%-%ResetServer_BRAND_FOLDER%.msi"</command>
			<indent type='3'>5</indent>
			<name>Copy/Rename MSI to Output DeploymentFiles folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condexpr>%DoNotBuildClients%</condexpr>
			<indent type='3'>1</indent>
			<name>Build clients</name>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>2</indent>
			<name>Obfuscate, sign and Build Installers</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>BuildInstallers-vNextInstallers</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Major Build Stage</SubName>
			<indent type='3'>3</indent>
			<name>Log Major Build Stage - CompileSolutions-vNextInstallers</name>
		</step>
		<step action='Group'>
			<indent type='3'>3</indent>
			<name>Create a Template folders to be used to initialize every loop (BuildTemplate and UIAssetsTemplate)</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\WorkingDirectory</DestDir>
			<Empty type='11'>-1</Empty>
			<ExclExt>*.pdb</ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Client\ProtectionService\WorkingDirectory.Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Copy in the vNextClient files - WorkingDirectory</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common</DestDir>
			<Empty type='11'>-1</Empty>
			<ExclExt><![CDATA[*.pdb
*.config
*.xml]]></ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Client\DCNotifier\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Copy in the vNextClient files - DCNotifier</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common</DestDir>
			<Empty type='11'>-1</Empty>
			<ExclExt><![CDATA[*.pdb
*.config
*installlog
*.installstate]]></ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Client\ProtectionStatusService\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Copy in the vNextClient files - DCProtectStatusService</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common</DestDir>
			<Empty type='11'>-1</Empty>
			<ExclExt>*.pdb</ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Client\ProtectionService\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Copy in the vNextClient files - DCProtectService</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common</DestDir>
			<Empty type='11'>-1</Empty>
			<ExclExt><![CDATA[*.pdb
*.config
*.xml]]></ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Client\win\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Copy in the vNextClient files - win</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c 7z a "%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common\uidist.zip" -r "%WORKING_DIRECTORY%\Core\Client\ui\dist\*"</command>
			<indent type='3'>4</indent>
			<name>Zip up client ui.</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common</DestDir>
			<Empty type='11'>-1</Empty>
			<ExclExt>*.pdb</ExclExt>
			<Ext>*.exe</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Tools\DashboardManager\bin\Release\</SourceDir>
			<TBD type='11'>-1</TBD>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Copy in the vNextClient files - DashboardManager</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Core\Client\ProtectionService\app.release.config" "%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common\DCProtectService.exe.config"</command>
			<indent type='3'>4</indent>
			<name>Copy production DCProtectService.exe.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Core\Client\ProtectionStatusService\app.release.config" "%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common\DCProtectServiceStatus.exe.config"</command>
			<indent type='3'>4</indent>
			<name>Copy production  DCProtectStatusService.exe.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Core\Client\DCProtect\app.release.config" "%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common\DCProtect.exe.config"</command>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Copy production DCProtect.exe.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Core\Client\DCNotifier\app.release.config" "%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common\DCNotifier.exe.config"</command>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Copy production DCNotifier.exe.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Core\Client\win\app.release.config" "%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common\DCProtect.exe.config"</command>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Copy production DCProtect.exe.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Client\build</SourceDir>
			<TBD type='11'>-1</TBD>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Copy files from build- these will overwrite anything from above</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\UIAssetsTemplate</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\UIAssets</SourceDir>
			<TBD type='11'>-1</TBD>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Copy UIAssets to UIAssetsTemplate</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>6</Compression>
			<Delete type='11'>-1</Delete>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateClientIntermediateArtifacts-%FULL_BUILD_NUMBER%.zip</Dest>
			<ExclExt><![CDATA[*.pdb
Deployment\Client\Branding]]></ExclExt>
			<Ext><![CDATA[Core\Client\ui\dist\**\*.*
Deployment\Client\**\*.dll
Deployment\Client\**\*.exe
Deployment\Client\**\*.zip]]></Ext>
			<HideOn type='11'>-1</HideOn>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\</Source>
			<SysOn type='11'>-1</SysOn>
			<Unicode type='11'>-1</Unicode>
			<buildfailsteps type='11'>0</buildfailsteps>
			<description>Assemble intermediate artifacts in the original folder structure, to be used by the client branding build.  The goal is to unzip into the workspace to make it look liike everything has been compiled</description>
			<indent type='3'>4</indent>
			<name>Zip Client Intermediate build artifacts</name>
		</step>
		<step action='Group'>
			<condexpr>%SkipClientObfuscation%</condexpr>
			<indent type='3'>3</indent>
			<name>Obfuscate and Sign Build</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%SkipClientObfuscation%</condexpr>
			<indent type='3'>4</indent>
			<name>Obfuscate windows client</name>
		</step>
		<step action='Delete Folder'>
			<Path>%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate-DotfuscatorOutput</Path>
			<Recurse type='11'>-1</Recurse>
			<indent type='3'>5</indent>
			<name>Clean any previous Dotfuscator output</name>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>cmd /c mkdir %WORKING_DIRECTORY%\Deployment\Client\BuildTemplate-DotfuscatorOutput</command>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Create Dofuscator Output directory</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common</DestDir>
			<Ext>datacastle_dashboard.snk</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Common\Datacastle.Common.Installation\</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>5</indent>
			<name>Copy Datacastle Installation SNK File</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"dotfuscator.exe" /p=configdir=%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common "%WORKING_DIRECTORY%\build\DotfuscateClient.xml"</command>
			<description>Switched to 6.1.505 - older versions of 2008 were not loading the 2007 project successfully</description>
			<indent type='3'>5</indent>
			<name>Run Dotfuscator</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate-DotfuscatorOutput\ClientMap.xml" "%WORKING_DIRECTORY%\DeploymentFiles\%RELEASE_VERSION%.%BUILD_VERSION%.%BUILD_DATE%-ClientMap.xml"</command>
			<indent type='3'>5</indent>
			<name>Copy Dotfuscator BuildMap</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common</DestDir>
			<Empty type='11'>-1</Empty>
			<ExclExt>DashboardManager.exe</ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate-DotfuscatorOutput\Common</SourceDir>
			<TBD type='11'>-1</TBD>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Copy BuildTemplate-Dotfuscator to BuildTemplate\Common</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\PSVault\bin\Dashboard\Tools\DashboardManager</DestDir>
			<Ext>DashboardManager.EXE</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate-DotfuscatorOutput\Common</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>5</indent>
			<name>Copy DashboardManager </name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%SkipClientObfuscation%</condexpr>
			<indent type='3'>4</indent>
			<name>Don't Dotfuscate build</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\PSVault\bin\Dashboard\Tools\DashboardManager</DestDir>
			<Ext>DashboardManager.EXE</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>5</indent>
			<name>Copy DashboardManager </name>
		</step>
		<step action='Group'>
			<indent type='3'>3</indent>
			<name>Sign Assemblies and PS scripts</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<description>Unless SkipCodeSigning is set, sign the code</description>
			<indent type='3'>4</indent>
			<name>Code Sign</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"%SIGN_DIR%\CodeSigningToolSHA256\SignSha256AndSha1.cmd" "%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common\DCProtect.exe" "DCProtect" </command>
			<condcompareto>True</condcompareto>
			<condexpr>%BRAND_SIGNED_FLAG%</condexpr>
			<description><![CDATA[
]]></description>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>5</indent>
			<name>Sign DCProtect EXE</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"%SIGN_DIR%\CodeSigningToolSHA256\SignSha256AndSha1.cmd" "%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common\DCProtectService.exe" "DCProtect"</command>
			<condcompareto>True</condcompareto>
			<condexpr>%BRAND_SIGNED_FLAG%</condexpr>
			<description><![CDATA[
]]></description>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>5</indent>
			<name>Sign DCProtectService EXE</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"%SIGN_DIR%\CodeSigningToolSHA256\SignSha256AndSha1.cmd" "%WORKING_DIRECTORY%\Deployment\Client\BuildTemplate\Common\DCNotifier.exe" "DCNotifier" </command>
			<condcompareto>True</condcompareto>
			<condexpr>%BRAND_SIGNED_FLAG%</condexpr>
			<description><![CDATA[
]]></description>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>5</indent>
			<name>Sign DCNotifier EXE</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"%SIGN_DIR%\CodeSigningToolSHA256\SignSha256AndSha1.cmd" "%WORKING_DIRECTORY%\DeploymentFiles\PSVault\bin\Dashboard\Tools\DashboardManager\DashboardManager.exe" "Carbonite Dashboard Manager"</command>
			<condcompareto>True</condcompareto>
			<condexpr>%BRAND_SIGNED_FLAG%</condexpr>
			<description><![CDATA[
]]></description>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>5</indent>
			<name>Sign DashboardManager</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<checked type='11'>0</checked>
			<command>"%SIGN_DIR%\CodeSigningToolSHA256\SignSha256AndSha1.cmd" "%WORKING_DIRECTORY%\Core\Tools\SeedingTool\bin\Release\SeedingTool.exe" "Seeding Tool"</command>
			<condcompareto>True</condcompareto>
			<condexpr>%BRAND_SIGNED_FLAG%</condexpr>
			<description><![CDATA[
]]></description>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>5</indent>
			<name>Sign Seedingtool EXE</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<checked type='11'>0</checked>
			<command>"%SIGN_DIR%\signtool.exe" sign /f "%SIGN_DIR%\datacastle.pfx" /d "Carbonite Powershell Scripts" /t "http://timestamp.verisign.com/scripts/timstamp.dll" /v "%WORKING_DIRECTORY%\Deployment\Server\DefaultServerLayout\*.ps1" "%WORKING_DIRECTORY%\Deployment\Server\DefaultServerLayout\Library\*.ps1" "%WORKING_DIRECTORY%\Deployment\Server\DefaultServerLayout\Library\Classes\*.ps1" "%WORKING_DIRECTORY%\Deployment\Server\DefaultServerLayout\Library\Common\*.ps1" "%WORKING_DIRECTORY%\Deployment\Server\DefaultServerLayout\Library\DashboardDBRole\*.ps1" "%WORKING_DIRECTORY%\Deployment\Server\DefaultServerLayout\Library\DashboardRole\*.ps1" "%WORKING_DIRECTORY%\Deployment\Server\DefaultServerLayout\Library\DashboardWebRole\*.ps1" "%WORKING_DIRECTORY%\Deployment\Server\DefaultServerLayout\Library\DatabaseRole\*.ps1" "%WORKING_DIRECTORY%\Deployment\Server\DefaultServerLayout\Library\JobProcessorRole\*.ps1" "%WORKING_DIRECTORY%\Deployment\Server\DefaultServerLayout\Library\Utility\*.ps1" "%WORKING_DIRECTORY%\Deployment\Server\DefaultServerLayout\Library\JobProcessorRole\*.ps1" "%WORKING_DIRECTORY%\Deployment\Server\DefaultServerLayout\Tools\*.ps1" "%WORKING_DIRECTORY%\Deployment\Server\PrivatePowershellScripts\*.ps1"</command>
			<condcompareto>True</condcompareto>
			<condexpr>%BRAND_SIGNED_FLAG%</condexpr>
			<description><![CDATA[
]]></description>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>5</indent>
			<name>Sign Powershell Scripts</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='VisBuildPro Project'>
			<Capture type='11'>-1</Capture>
			<OpenFailGUI type='11'>-1</OpenFailGUI>
			<ParamValues array='0'>%RELEASE_VERSION%</ParamValues>
			<ParamValues>%BUILD_VERSION%</ParamValues>
			<ParamValues>%FULL_BUILD_NUMBER%</ParamValues>
			<ParamValues>%BUILD_DATE%</ParamValues>
			<ParamValues>%ClientSxSOverrideLoopCount%</ParamValues>
			<ParamValues>%TIMER_MAJOR%</ParamValues>
			<ParamValues>%TIMER_MAJOR_STAGE%</ParamValues>
			<Parameters array='0'>RELEASE_VERSION</Parameters>
			<Parameters>BUILD_VERSION</Parameters>
			<Parameters>FULL_BUILD_NUMBER</Parameters>
			<Parameters>BUILD_DATE</Parameters>
			<Parameters>ClientSxSOverrideLoopCount</Parameters>
			<Parameters>TIMER_MAJOR</Parameters>
			<Parameters>TIMER_MAJOR_STAGE</Parameters>
			<PassThru type='11'>-1</PassThru>
			<ProjectName>Datacastle-Assemble-Clients.bld</ProjectName>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotBuildClients%</condexpr>
			<description>Assemble Client Installers</description>
			<indent type='3'>2</indent>
			<name>VisBuildPro Project -- Datacastle-Assemble-Clients.bld</name>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>1</indent>
			<name>SQL files</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BuildSqlProj%</condexpr>
			<indent type='3'>2</indent>
			<name>If building sqlproj</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DatacastleDb_create.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DeployDatabase.sql</FileOut>
			<Find>/*/*/*/*/* START EXCLUDE /*/*/*/*/*.+?/*/*/*/*/* END EXCLUDE /*/*/*/*/*</Find>
			<Replace>-- SQL automatically excluded by build system</Replace>
			<description>This prevents unwanted items (such as population of test data) from appearing in our release SQL file</description>
			<indent type='3'>3</indent>
			<name>Remove excluded sections - Datacastle</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DatacastleDb_create.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DatacastleExcludedSectionOnly.sql</FileOut>
			<Find>\A.+?/*/*/*/*/* START EXCLUDE /*/*/*/*/*</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Replace>---Start test data, section above here removed by build</Replace>
			<description>This is used for when creating test vaults</description>
			<indent type='3'>3</indent>
			<name>Create new file with only top excluded section - Datacastle</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DeployDatabase.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DeployDatabase.sql</FileOut>
			<Find>\A.+?Vault MSI Installer start token]</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Replace>--[[Vault MSI Installer start token]]</Replace>
			<indent type='3'>3</indent>
			<name>Remove header section creating DBs etc, needed so same script for Azure - Datacastle</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DeployDashboard.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DeployDashboard.sql</FileOut>
			<Find>\A.+?Vault MSI Installer start token]</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Replace>--[[Vault MSI Installer start token]]</Replace>
			<indent type='3'>3</indent>
			<name>Remove header section creating DBs etc, needed so same script for Azure - Dashboard</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>7</condcomparison>
			<condexpr>%BuildSqlProj%</condexpr>
			<indent type='3'>2</indent>
			<name>If not building sqlproj</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DatacastleDb.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DeployDatabase.sql</FileOut>
			<Find>/*/*/*/*/* START EXCLUDE /*/*/*/*/*.+?/*/*/*/*/* END EXCLUDE /*/*/*/*/*</Find>
			<Replace>-- SQL automatically excluded by build system</Replace>
			<description>This prevents unwanted items (such as population of test data) from appearing in our release SQL file</description>
			<indent type='3'>3</indent>
			<name>Remove excluded sections - Datacastle</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\Datacastle_Script.PostDeployment.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DatacastleExcludedSectionOnly.sql</FileOut>
			<Find>\A.+?/*/*/*/*/* START EXCLUDE /*/*/*/*/*</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Replace>---Start test data, section above here removed by build</Replace>
			<description>This is used for when creating test vaults</description>
			<indent type='3'>3</indent>
			<name>Create new file with only top excluded section - Datacastle</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DeployDatabase.sql</FileIn>
			<Find>:setvar blocksroot .+</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>:setvar blocksroot "@@BLOCKSROOT@@"</Replace>
			<indent type='3'>2</indent>
			<name>Fixup Default BlocksRoot path in DeployDatabase.sql</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DeployDatabase.sql</FileIn>
			<Find>:setvar databasename .+</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>:setvar databasename "@@DATABASENAME@@"</Replace>
			<description>Variable used by deployment scripts</description>
			<indent type='3'>2</indent>
			<name>Rename database to variable</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DeployDatabase.sql</FileIn>
			<Find>:setvar defaultdatapath .+</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>:setvar defaultdatapath "@@DATABASEPATH@@"</Replace>
			<description>Variable used by deployment scripts</description>
			<indent type='3'>2</indent>
			<name>Add variable for location</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DeployDatabase.sql</FileIn>
			<Find>:setvar dashboarddb .+</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>:setvar dashboarddb "@@DASHBOARDDBNAME@@"</Replace>
			<description>Variable used by deployment scripts</description>
			<indent type='3'>2</indent>
			<name>Add variable for dashboard database</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DatacastleExcludedSectionOnly.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DatacastleExcludedSectionOnly.sql</FileOut>
			<Find>/*/*/*/*/* END EXCLUDE /*/*/*/*/*.+?\z</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Replace>---End test data, section below here removed by build</Replace>
			<description>This is used for when creating test vaults</description>
			<indent type='3'>2</indent>
			<name>Remove anything below bottom excluded section - Datacastle</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Core\Database\DatacastleDb\Scripts\Post-Deployment\PopulateTestDataForTestVault.sql" "%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\PopulateDatacastleTestDataForTestVault.sql"</command>
			<indent type='3'>2</indent>
			<name>Copy Test Vault DBScript</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<checked type='11'>0</checked>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>1</indent>
			<name>Compile and Save AutoIt tests</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>Compile and Save AutoIt tests</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Major Build Stage</SubName>
			<checked type='11'>0</checked>
			<indent type='3'>2</indent>
			<name>Log Major Build Stage - Compile and Save AutoIt tests</name>
		</step>
		<step action='Process Files'>
			<FileExtensions>*.au3</FileExtensions>
			<FilePath>%WORKING_DIRECTORY%\Testing\AutoIT MBT\Completed Scripts</FilePath>
			<Log type='11'>-1</Log>
			<checked type='11'>0</checked>
			<indent type='3'>2</indent>
			<name>Loop au3 Files in AutoIt MBT/Completed Scripts</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<checked type='11'>0</checked>
			<command>"%PROGFILES%\AutoIt3\Aut2Exe\Aut2EXE.exe" /in "%PROCFILES_ROOT_DIR%\%PROCFILES_FILENAME%"</command>
			<indent type='3'>3</indent>
			<name>Compile using AutoIt</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%PROCFILES_ROOT_DIR%</startin>
			<successcodes>0</successcodes>
			<terminate>480</terminate>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\AutoIt</DestDir>
			<Ext>*.ini</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Testing\AutoIT MBT\Completed Scripts</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>2</indent>
			<name>Copy AutoIt ini files to Deployment layout</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\AutoIt</DestDir>
			<Ext>*.exe</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%PROCFILES_ROOT_DIR%</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>2</indent>
			<name>Copy AutoIt output files to Deployment layout</name>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>1</indent>
			<name>Create Deployment Files</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>Create Deployment Files</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Major Build Stage</SubName>
			<indent type='3'>2</indent>
			<name>Log Major Build Stage - Create Deployment Files</name>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Create Deployment Zip</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PSPrivate-%FULL_BUILD_NUMBER%.zip</Dest>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Deployment\Server\PrivatePowershellScripts\</Source>
			<indent type='3'>3</indent>
			<name>ZIP Private PowerShell scripts</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\SQLTestDataPrivate-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[DatacastleExcludedSectionOnly.sql
PopulateDatacastleTestDataForTestVault.sql]]></Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Source>%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\</Source>
			<indent type='3'>3</indent>
			<name>ZIP Private SQL scripts - Datacastle</name>
		</step>
		<step action='Enhanced Zip Files'>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\SQLTestDataPrivate-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[DashboardExcludedSectionOnly.sql
PopulateDashboardTestDataForTestVault.sql]]></Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Source>%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\</Source>
			<indent type='3'>3</indent>
			<name>ZIP Private SQL scripts - Dashboard</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\CarboniteSeedingTool-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.exe
*.dll
*.config
*.manifest
*.xml]]></Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Source>%WORKING_DIRECTORY%\Core\Tools\SeedingTool\bin\Release</Source>
			<checked type='11'>0</checked>
			<indent type='3'>3</indent>
			<name>ZIP Seeding tool (no obsolete)</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Delete type='11'>-1</Delete>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\NUnitTestFx-%FULL_BUILD_NUMBER%.zip</Dest>
			<ExclExt>*.pdb</ExclExt>
			<Ext>*.*</Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Source>%WORKING_DIRECTORY%\Testing\DCTestRunnerConsole\bin\Debug</Source>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeNUnitSolution%</condexpr>
			<indent type='3'>3</indent>
			<name>ZIP DCTestRunnerConsole binaries</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\NUnitTestFx-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext>*.*</Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Source>%WORKING_DIRECTORY%\Testing\NUnitTestFx\Datacastle.Testing.Smoke\bin\Debug</Source>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeNUnitSolution%</condexpr>
			<indent type='3'>3</indent>
			<name>ZIP NUnit binaries</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>"%SIGN_DIR%\signtool.exe" sign /f "%SIGN_DIR%\datacastle.pfx" /d "Carbonite InfoUpdate" /t "http://timestamp.verisign.com/scripts/timstamp.dll" /v ""%WORKING_DIRECTORY%\Core\Tools\InfoUpdateGetConfigFile\Bin\Release\*.dll""</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[
]]></description>
			<indent type='3'>3</indent>
			<name>Sign InfoUpdateGetConfigFile</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\InfoUpdates-%FULL_BUILD_NUMBER%.zip</Dest>
			<ExclExt>*.pdb</ExclExt>
			<Ext>*.dll</Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Source>%WORKING_DIRECTORY%\Core\Tools\InfoUpdateGetConfigFile\Bin\Release</Source>
			<indent type='3'>3</indent>
			<name>ZIP InfoUpdate - InfoUpdateGetConfigFile</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>"%SIGN_DIR%\signtool.exe" sign /f "%SIGN_DIR%\datacastle.pfx" /d "Carbonite InfoUpdate" /t "http://timestamp.verisign.com/scripts/timstamp.dll" /v ""%WORKING_DIRECTORY%\Core\Tools\InfoUpdatePing\Bin\Release\*.dll""</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[
]]></description>
			<indent type='3'>3</indent>
			<name>Sign InfoUpdatePing</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\InfoUpdates-%FULL_BUILD_NUMBER%.zip</Dest>
			<ExclExt>*.pdb</ExclExt>
			<Ext>*.dll</Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Source>%WORKING_DIRECTORY%\Core\Tools\InfoUpdatePing\Bin\Release</Source>
			<indent type='3'>3</indent>
			<name>ZIP InfoUpdate - InfoUpdatePing</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\CarbonitePrivateTools\SqliteInspector</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext><![CDATA[*.exe
*.dll
*.config
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Tools\SqliteInspector\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>3</indent>
			<name>Copy SqliteInspector to private tools</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\CarbonitePrivateTools\ProtectionManager</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext><![CDATA[*.exe
*.dll
*.config
*.xml]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\MiscInternalTools\ProtectionManager\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy ProtectionManager to private tools</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\CarbonitePrivateTools\MSIEdit</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext><![CDATA[*.exe
*.dll
*.config
*.xml]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\MiscInternalTools\MSIEdit\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy MSIEdit to private tools</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\CarbonitePrivateTools\ProtectionStatusService</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext><![CDATA[*.exe
*.dll
*.config
*.xml
*.pdb]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Client\ProtectionStatusService\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy ProtectStatusService to private tools</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\CarbonitePrivateTools\PolicyValidator</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext><![CDATA[*.exe
*.dll
*.config
*.xml]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\MiscInternalTools\PolicyValidator\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy PolicyValidator to private tools</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\CarbonitePrivateTools-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext>*.*</Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\DeploymentFiles\CarbonitePrivateTools</Source>
			<indent type='3'>3</indent>
			<name>ZIP Private Tools</name>
		</step>
		<step action='Delete Folder'>
			<Path>%WORKING_DIRECTORY%\DeploymentFiles\PSVault\</Path>
			<Recurse type='11'>-1</Recurse>
			<ShowCmd type='11'>-1</ShowCmd>
			<description>Delete the PSVault folder so it doesn't get copied to build output</description>
			<indent type='3'>3</indent>
			<name>Delete PSVault folder</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeQuickCache%</condexpr>
			<indent type='3'>1</indent>
			<name>Build QuickCache - can be turned off by fast track build</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>QuickCache</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Minor Build Stage</SubName>
			<indent type='3'>2</indent>
			<name>Log Minor Stage - QuickCache</name>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>2</indent>
			<name>QuickCache installer</name>
		</step>
		<step action='Group'>
			<indent type='3'>3</indent>
			<name>Prepare folder layout in DeploymentFiles/QuickCacheMSI</name>
		</step>
		<step action='Group'>
			<indent type='3'>4</indent>
			<name>Create Folder Structure</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\QuickCacheMSI</command>
			<indent type='3'>5</indent>
			<name>Base QuickCacheMSI folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\QuickCacheMSI\HtmlContent"</command>
			<indent type='3'>5</indent>
			<name>HtmlContent</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<indent type='3'>4</indent>
			<name>Copy files in</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\QuickCacheMSI</DestDir>
			<Ext><![CDATA[*.dll
*.exe]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Datacastle.RDN\Datatcastle.RDNService\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>5</indent>
			<name>Copy Service files</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<checked type='11'>0</checked>
			<command>cmd /c ren "%WORKING_DIRECTORY%\DeploymentFiles\QuickCacheMSI\Carbonite.RDNService.exe" QuickCacheService.exe</command>
			<indent type='3'>5</indent>
			<name>rename service EXE to QuickCacheService</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\QuickCacheMSI\HtmlContent</DestDir>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Datacastle.RDN\Datatcastle.RDNService\HtmlContent</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>5</indent>
			<name>Copy HtmlContent files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\QuickCacheMSI</DestDir>
			<ExclExt>DNGuard*.*</ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\QuickCacheProductionTemplateConfig</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>5</indent>
			<name>Copy Template Config files</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\QuickCacheProductionTemplateConfig\End User License Agreement.rtf" "%WORKING_DIRECTORY%\DeploymentFiles\QuickCacheMSI\End User License Agreement.rtf"</command>
			<indent type='3'>5</indent>
			<name>Copy License agreement</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotObfuscateQuickCache%</condexpr>
			<indent type='3'>3</indent>
			<name>Obfuscate with Dotfuscator</name>
		</step>
		<step action='Delete Folder'>
			<Path>%WORKING_DIRECTORY%\Deployment\Server\QuickCacheObfuscationBuildWorkingFolder</Path>
			<Recurse type='11'>-1</Recurse>
			<ShowCmd type='11'>-1</ShowCmd>
			<indent type='3'>4</indent>
			<name>Delete QuickCacheObfuscationBuildWorkingFolder</name>
		</step>
		<step action='Create Folder'>
			<Path>%WORKING_DIRECTORY%\Deployment\Server\QuickCacheObfuscationBuildWorkingFolder</Path>
			<indent type='3'>4</indent>
			<name>Create QuickCacheObfuscationBuildWorkingFolder</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\QuickCacheObfuscationBuildWorkingFolder\</DestDir>
			<Ext>datacastle_dashboard.snk</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Datacastle.Dashboard\</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>4</indent>
			<name>Copy Datacastle Dashboard SNK File</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\QuickCacheProductionTemplateConfig\DotfuscatorQuickCache.xml" "%WORKING_DIRECTORY%\Deployment\Server\QuickCacheObfuscationBuildWorkingFolder\DotfuscatorQuickCache.xml"</command>
			<indent type='3'>4</indent>
			<name>Copy template QuickCache Dotfuscator project file to working copy</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\QuickCacheObfuscationBuildWorkingFolder</DestDir>
			<Ext><![CDATA[*.*
]]></Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\QuickCacheMSI</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy files to working folder</name>
		</step>
		<step action='Run Program'>
			<command>"dotfuscator.exe" /q "DotfuscatorQuickCache.xml" </command>
			<indent type='3'>4</indent>
			<name>Run Dotfuscator to obfuscate</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Server\QuickCacheObfuscationBuildWorkingFolder</startin>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\QuickCacheMSI</DestDir>
			<Ext><![CDATA[*.*
]]></Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\QuickCacheObfuscationBuildWorkingFolder\Obfuscated\QuickCacheObfuscationBuildWorkingFolder</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy obfuscated files back</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\CarbonitePrivateQuickCacheMSI-%FULL_BUILD_NUMBER%.zip</Dest>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\DeploymentFiles\QuickCacheMSI</Source>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>ZIP QuickCacheMSI</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\Build</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\QuickCacheMSI</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy build layout to where installer expects it</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\QuickCacheWixTemplate</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\QuickCache</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy/backup whole QuickCache installer solution folder to QuickCacheWixTemplate so can replace per brand</name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_LOOP_UBOUND</MacroName>
			<MacroValue>1</MacroValue>
			<condcompareto>True</condcompareto>
			<description><![CDATA[Reads the Number of Brands to build from Brand.ini
Defaults to 1 if Brand.ini does not exist.]]></description>
			<indent type='3'>3</indent>
			<name>Set Number of Brand to 1 only </name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_LOOP_UBOUND</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandQuickCacheInstaller\Brand.ini,BrandSetup,Number,1)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<description><![CDATA[Reads the Number of Brands to build from Brand.ini
Defaults to 1 if Brand.ini does not exist.]]></description>
			<indent type='3'>3</indent>
			<name>Read Number of Brands (if Nightly, otherwise leave as 1)</name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_LOOP_COUNT</MacroName>
			<MacroValue>0</MacroValue>
			<description>Initialize a counter macro value</description>
			<indent type='3'>3</indent>
			<name>Initialize brand Counter</name>
		</step>
		<step action='Group'>
			<condcompareto>%QuickCache_BRAND_LOOP_UBOUND%</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%QuickCache_BRAND_LOOP_COUNT%</condexpr>
			<condrepeat type='11'>-1</condrepeat>
			<indent type='3'>3</indent>
			<name>Build Installer Loop</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\QuickCache</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<Hidden type='11'>-1</Hidden>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Delete QuickCache so can be replaced by QuickCacheWixTemplate</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\QuickCache</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\QuickCacheWixTemplate</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy QuickCacheWixTemplate to QuickCache</name>
		</step>
		<step action='Group'>
			<description><![CDATA[
]]></description>
			<indent type='3'>4</indent>
			<name>Read QC brand vars from ini</name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_FOLDER</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandQuickCacheInstaller\Brand.ini,Brand%QuickCache_BRAND_LOOP_COUNT%,Folder,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read QuickCache_BRAND_FOLDER</name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_BootstrapperEXECompany</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandQuickCacheInstaller\Brand.ini,Brand%QuickCache_BRAND_LOOP_COUNT%,BootstrapperEXECompany,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read QuickCache_BRAND_BootstrapperEXECompany</name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_BootstrapperEXEProductName</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandQuickCacheInstaller\Brand.ini,Brand%QuickCache_BRAND_LOOP_COUNT%,BootstrapperEXEProductName,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read QuickCache_BRAND_BootstrapperEXEProductName</name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_BootstrapperEXEFileDescription</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandQuickCacheInstaller\Brand.ini,Brand%QuickCache_BRAND_LOOP_COUNT%,BootstrapperEXEFileDescription,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read QuickCache_BRAND_BootstrapperEXEFileDescription</name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_BRANDCORPNAME</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandQuickCacheInstaller\Brand.ini,Brand%QuickCache_BRAND_LOOP_COUNT%,InstallerBRANDCORPNAME,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read QuickCache_BRAND_BRANDCORPNAME</name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_BRANDINFOURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandQuickCacheInstaller\Brand.ini,Brand%QuickCache_BRAND_LOOP_COUNT%,InstallerBRANDINFOURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read QuickCache_BRAND_BRANDINFOURL</name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_BRANDNAME</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandQuickCacheInstaller\Brand.ini,Brand%QuickCache_BRAND_LOOP_COUNT%,InstallerBRANDNAME,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read QuickCache_BRAND_BRANDNAME</name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_BRANDNAMEFILENAMEFRIENDLY</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandQuickCacheInstaller\Brand.ini,Brand%QuickCache_BRAND_LOOP_COUNT%,InstallerBRANDNAMEFILENAMEFRIENDLY,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read QuickCache_BRAND_BRANDNAMEFILENAMEFRIENDLY</name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_BRANDSUPPORTURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandQuickCacheInstaller\Brand.ini,Brand%QuickCache_BRAND_LOOP_COUNT%,InstallerBRANDSUPPORTURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read QuickCache_BRAND_BRANDSUPPORTURL</name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_BRANDUPDATEURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandQuickCacheInstaller\Brand.ini,Brand%QuickCache_BRAND_LOOP_COUNT%,InstallerBRANDUPDATEURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read QuickCache_BRAND_BRANDUPDATEURL</name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_BRANDPROGFILESFOLDER</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandQuickCacheInstaller\Brand.ini,Brand%QuickCache_BRAND_LOOP_COUNT%,InstallerBRANDPROGFILESFOLDER,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read QuickCache_BRAND_BRANDPROGFILESFOLDER</name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_BRANDPROGFILESFOLDERLEVEL2</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandQuickCacheInstaller\Brand.ini,Brand%QuickCache_BRAND_LOOP_COUNT%,InstallerBRANDPROGFILESFOLDERLEVEL2,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read QuickCache_BRAND_BRANDPROGFILESFOLDERLEVEL2</name>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_TOSURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandQuickCacheInstaller\Brand.ini,Brand%QuickCache_BRAND_LOOP_COUNT%,TOSURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read QuickCache_BRAND_TOSURL</name>
		</step>
		<step action='Group'>
			<indent type='3'>4</indent>
			<name>Build QC MSI</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\QuickCache</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\BrandQuickCacheInstaller\%QuickCache_BRAND_FOLDER%\LayoutOverlay</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>5</indent>
			<name>Copy/overwrite Brand specific files to Build</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileOut>
			<Find>define\sBUILDNUM\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BUILDNUM=\"%RELEASE_VERSION%.%BUILD_VERSION%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[replacing version in:  <?define BUILDNUM="1.0.0.0" ?>
]]></description>
			<indent type='3'>5</indent>
			<name>Stamp Build number into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileOut>
			<Find>define\sBRANDBUILDFOLDERNAME\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDBUILDFOLDERNAME=\"%QuickCache_BRAND_FOLDER%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDBUILDFOLDERNAME into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileOut>
			<Find>define\sBRANDCORPNAME\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDCORPNAME=\"%QuickCache_BRAND_BRANDCORPNAME%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDCORPNAME into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileOut>
			<Find>define\sBRANDINFOURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDINFOURL=\"%QuickCache_BRAND_BRANDINFOURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDINFOURL into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileOut>
			<Find>define\sBRANDNAME\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDNAME=\"%QuickCache_BRAND_BRANDNAME%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDNAME into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileOut>
			<Find>define\sBRANDNAMEFILENAMEFRIENDLY\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDNAMEFILENAMEFRIENDLY=\"%QuickCache_BRAND_BRANDNAMEFILENAMEFRIENDLY%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDNAMEFILENAMEFRIENDLY into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileOut>
			<Find>define\sBRANDSUPPORTURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDSUPPORTURL=\"%QuickCache_BRAND_BRANDSUPPORTURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDSUPPORTURL into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileOut>
			<Find>define\sBRANDUPDATEURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDUPDATEURL=\"%QuickCache_BRAND_BRANDUPDATEURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDUPDATEURL into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileOut>
			<Find>define\sBRANDPROGFILESFOLDER\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDPROGFILESFOLDER=\"%QuickCache_BRAND_BRANDPROGFILESFOLDER%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDPROGFILESFOLDER into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileOut>
			<Find>define\sBRANDPROGFILESFOLDERLEVEL2\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDPROGFILESFOLDERLEVEL2=\"%QuickCache_BRAND_BRANDPROGFILESFOLDERLEVEL2%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDPROGFILESFOLDERLEVEL2 into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\BuildVars.wxi</FileOut>
			<Find>define\sBRANDTOSURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDTOSURL=\"%QuickCache_BRAND_TOSURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDTOSURL into Buildvars.wxi</name>
		</step>
		<step action='Make VS.NET'>
			<AssemblyVer type='11'>-1</AssemblyVer>
			<Config>Release|Mixed Platforms</Config>
			<FileVer type='11'>-1</FileVer>
			<Filename>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache.sln</Filename>
			<Force type='3'>1</Force>
			<Location>%PROGFILES%\Microsoft Visual Studio\2017\Enterprise\MSBuild\15.0\Bin\msbuild.exe</Location>
			<LogLevel type='3'>2</LogLevel>
			<Options>/flp:logfile=%LOGFILE%;Append;Summary;Verbosity=minimal; /maxcpucount:1 /nr:false   /nologo /consoleloggerparameters:ErrorsOnly;Summary;</Options>
			<ParseOutput type='11'>-1</ParseOutput>
			<ProdVer type='11'>-1</ProdVer>
			<Property1>%COMPANY_NAME%</Property1>
			<Property3>%COPYRIGHT%</Property3>
			<Property5>%PRODUCT_NAME%</Property5>
			<PropertyOn1 type='11'>-1</PropertyOn1>
			<PropertyOn3 type='11'>-1</PropertyOn3>
			<PropertyOn5 type='11'>-1</PropertyOn5>
			<ShowCmd type='11'>-1</ShowCmd>
			<Version>%RELEASE_VERSION%.%BUILD_VERSION%</Version>
			<VersionSel type='3'>2</VersionSel>
			<indent type='3'>5</indent>
			<name>Make VS.NET: Wix QuickCache MSI Setup </name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\bin\Release\en-US\QuickCache.msi" "%WORKING_DIRECTORY%\DeploymentFiles\QuickCacheInstaller-%FULL_BUILD_NUMBER%-%QuickCache_BRAND_FOLDER%.msi"</command>
			<indent type='3'>5</indent>
			<name>Copy MSI to DeploymentFiles folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"%SIGN_DIR%\CodeSigningToolSHA256\SignSha256Only.cmd" "%WORKING_DIRECTORY%\DeploymentFiles\QuickCacheInstaller*.msi" "Carbonite Setup"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<description><![CDATA[
]]></description>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>5</indent>
			<name>Sign QuickCache install MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<indent type='3'>4</indent>
			<name>QC Bootstrapper</name>
		</step>
		<step action='Delete Folder'>
			<Path>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild</Path>
			<Recurse type='11'>-1</Recurse>
			<ShowCmd type='11'>-1</ShowCmd>
			<indent type='3'>5</indent>
			<name>Delete Bootstrapper build location</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapper</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Copy bootstrapper files to location to build from</name>
		</step>
		<step action='Write XML'>
			<Filename>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild\bootstrap_config.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%FULL_BUILD_NUMBER%</Text>
			<XPath>/IRBootstrapper/VersionResources/@FileVersion</XPath>
			<indent type='3'>5</indent>
			<name>Update FileVersion in bootstrap XML</name>
		</step>
		<step action='Write XML'>
			<Filename>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild\bootstrap_config.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%FULL_BUILD_NUMBER%</Text>
			<XPath>/IRBootstrapper/VersionResources/@ProductVersion</XPath>
			<indent type='3'>5</indent>
			<name>Update ProductVersion in bootstrap XML</name>
		</step>
		<step action='Write XML'>
			<Filename>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild\bootstrap_config.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\UIAssets\Application.ico</Text>
			<XPath>/IRBootstrapper/CustomIcon/@IconFile</XPath>
			<indent type='3'>5</indent>
			<name>Update App Icon in bootstrap XML</name>
		</step>
		<step action='Write XML'>
			<Filename>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild\bootstrap_config.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%QuickCache_BRAND_BootstrapperEXECompany%</Text>
			<XPath>/IRBootstrapper/VersionResources/@Company</XPath>
			<indent type='3'>5</indent>
			<name>Update BootstrapperEXECompany in bootstrap XML</name>
		</step>
		<step action='Write XML'>
			<Filename>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild\bootstrap_config.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%QuickCache_BRAND_BootstrapperEXEProductName%</Text>
			<XPath>/IRBootstrapper/VersionResources/@ProductName</XPath>
			<indent type='3'>5</indent>
			<name>Update BootstrapperEXEProductName in bootstrap XML</name>
		</step>
		<step action='Write XML'>
			<Filename>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild\bootstrap_config.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%QuickCache_BRAND_BootstrapperEXEFileDescription%</Text>
			<XPath>/IRBootstrapper/VersionResources/@FileDescription</XPath>
			<indent type='3'>5</indent>
			<name>Update BootstrapperEXEFileDescription in bootstrap XML</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[strDir = "%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild"
strDir = Replace(strDir, "\", "\\")
vbld_TempMacros.Add "QMSIFactoryBootstrapperBuildPath", strDir
]]></Script>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Set QMSIFactoryBootstrapperBuildPath - make it have double "\"</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild\bootstrap_config.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild\bootstrap_config.xml</FileOut>
			<Find>.BOOTSTRAPPERPATH\]</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>%QMSIFactoryBootstrapperBuildPath%</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condexpr>%BRAND_MSIPASSPHRASE%</condexpr>
			<indent type='3'>5</indent>
			<name>Update Bootstrapper path into bootstrap_config.xml</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild\bootstrap_config.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild\bootstrap_config.xml</FileOut>
			<Find>C:\Users\garysu.DATACASTLE\Desktop</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>5</indent>
			<name>Stamp location of bootstrapper lua file</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\bin\Release\en-US\QuickCache.msi" "%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild"</command>
			<indent type='3'>5</indent>
			<name>Copy WixInstaller to location for bootstrapper to pickup</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"%PROGFILES%\MSI Factory\Bootstrap\IRMakeBootstrap.exe" "%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild\bootstrap_config.xml" "%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild\QuickCacheSetup.exe"  -var:ProductName="%QuickCache_BRAND_BootstrapperEXEProductName%" -var:ProductVersion="%FULL_BUILD_NUMBER%"</command>
			<indent type='3'>5</indent>
			<name>build bootstrapper</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Server\QuickCache\QuickCache\MSIFactoryBootstrapperBuild\QuickCacheSetup.exe"  "%WORKING_DIRECTORY%\DeploymentFiles\QuickCacheInstaller-%FULL_BUILD_NUMBER%-%QuickCache_BRAND_FOLDER%.EXE"</command>
			<indent type='3'>5</indent>
			<name>Copy bootstrapper to Output DeploymentFiles folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"%SIGN_DIR%\CodeSigningToolSHA256\SignSha256AndSha1.cmd"  "%WORKING_DIRECTORY%\DeploymentFiles\QuickCacheInstaller*.EXE" "Carbonite Setup"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<description><![CDATA[
]]></description>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>5</indent>
			<name>Sign QuickCache install EXE</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Set Macro'>
			<MacroName>QuickCache_BRAND_LOOP_COUNT</MacroName>
			<MacroValue>[%QuickCache_BRAND_LOOP_COUNT%+1]</MacroValue>
			<description>Initialize a counter macro value</description>
			<indent type='3'>4</indent>
			<name>Increment Brand Counter</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeLDAPSync%</condexpr>
			<indent type='3'>1</indent>
			<name>LDAP Sync MSI Installer</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>LdapSyncService</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Minor Build Stage</SubName>
			<indent type='3'>2</indent>
			<name>Log Minor Stage - LdapSyncService</name>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>2</indent>
			<name>LdapSyncService installer</name>
		</step>
		<step action='Group'>
			<indent type='3'>3</indent>
			<name>Prepare folder layout in DeploymentFiles/LdapSyncServiceMSI</name>
		</step>
		<step action='Group'>
			<indent type='3'>4</indent>
			<name>Create Folder Structure</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\LdapSyncServiceMSI</command>
			<indent type='3'>5</indent>
			<name>Base LDAPSyncMSI folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\LdapSyncServiceMSI\HtmlContent"</command>
			<indent type='3'>5</indent>
			<name>HtmlContent</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<indent type='3'>4</indent>
			<name>Copy files in</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\LdapSyncServiceMSI</DestDir>
			<Ext><![CDATA[*.dll
*.exe
*.config]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Tools\LdapSynchronizationService\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>5</indent>
			<name>Copy Service files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\LdapSyncServiceMSI\HtmlContent</DestDir>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Tools\LdapSynchronizationService\HtmlContent</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>5</indent>
			<name>Copy HtmlContent files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\LdapSyncServiceMSI</DestDir>
			<Ext>*.release.config.xml</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Tools\LdapSynchronizationService\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>5</indent>
			<name>Copy Template Config files</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c ren "%WORKING_DIRECTORY%\DeploymentFiles\LdapSyncServiceMSI\logging.release.config.xml" logging.config.xml</command>
			<indent type='3'>5</indent>
			<name>rename logging.release.config.xml</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c ren "%WORKING_DIRECTORY%\DeploymentFiles\LdapSyncServiceMSI\LdapSynchronization.release.config.xml" LdapSynchronization.config.xml</command>
			<indent type='3'>5</indent>
			<name>rename LdapSynchronization.release.config.xml</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncServiceTemplateConfig\End User License Agreement.rtf" "%WORKING_DIRECTORY%\DeploymentFiles\LdapSyncServiceMSI\End User License Agreement.rtf"</command>
			<indent type='3'>5</indent>
			<name>Copy License agreement</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotObfuscateTools%</condexpr>
			<indent type='3'>3</indent>
			<name>Obfuscate with Dotfuscator</name>
		</step>
		<step action='Delete Folder'>
			<Path>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncServiceObfuscationBuildWorkingFolder</Path>
			<Recurse type='11'>-1</Recurse>
			<ShowCmd type='11'>-1</ShowCmd>
			<indent type='3'>4</indent>
			<name>Delete LdapSyncServiceObfuscationBuildWorkingFolder</name>
		</step>
		<step action='Create Folder'>
			<Path>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncServiceObfuscationBuildWorkingFolder</Path>
			<indent type='3'>4</indent>
			<name>Create LdapSyncServiceObfuscationBuildWorkingFolder</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncServiceObfuscationBuildWorkingFolder\</DestDir>
			<Ext>datacastle_dashboard.snk</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Datacastle.Dashboard\</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>4</indent>
			<name>Copy Datacastle Dashboard SNK File</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncServiceTemplateConfig\DotfuscatorLDAPSyncService.xml" "%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncServiceObfuscationBuildWorkingFolder\DotfuscatorLDAPSyncService.xml"</command>
			<indent type='3'>4</indent>
			<name>Copy template LdapSyncService Dotfuscator project file to working copy</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncServiceObfuscationBuildWorkingFolder</DestDir>
			<Ext><![CDATA[*.*
]]></Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\LdapSyncServiceMSI</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy files to working folder</name>
		</step>
		<step action='Run Program'>
			<command>"dotfuscator.exe" /q "DotfuscatorLdapSyncService.xml" </command>
			<indent type='3'>4</indent>
			<name>Run Dotfuscator to obfuscate</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncServiceObfuscationBuildWorkingFolder</startin>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\LdapSyncServiceMSI</DestDir>
			<Ext><![CDATA[*.*
]]></Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncServiceObfuscationBuildWorkingFolder\Obfuscated\LdapSyncServiceObfuscationBuildWorkingFolder</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy obfuscated files back</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\Build</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\LdapSyncServiceMSI</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy build layout to where installer expects it</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncServiceWixTemplate</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy/backup whole LdapSyncService installer solution folder to LdapSyncServiceWixTemplate so can replace per brand</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_LOOP_UBOUND</MacroName>
			<MacroValue>1</MacroValue>
			<condcompareto>True</condcompareto>
			<description><![CDATA[Reads the Number of Brands to build from Brand.ini
Defaults to 1 if Brand.ini does not exist.]]></description>
			<indent type='3'>3</indent>
			<name>Set Number of Brand to 1 only </name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_LOOP_UBOUND</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Tools\BrandLdapSyncServiceInstaller\Brand.ini,BrandSetup,Number,1)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<description><![CDATA[Reads the Number of Brands to build from Brand.ini
Defaults to 1 if Brand.ini does not exist.]]></description>
			<indent type='3'>3</indent>
			<name>Read Number of Brands (if Nightly, otherwise leave as 1)</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_LOOP_COUNT</MacroName>
			<MacroValue>0</MacroValue>
			<description>Initialize a counter macro value</description>
			<indent type='3'>3</indent>
			<name>Initialize brand Counter</name>
		</step>
		<step action='Group'>
			<condcompareto>%LdapSyncService_BRAND_LOOP_UBOUND%</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%LdapSyncService_BRAND_LOOP_COUNT%</condexpr>
			<condrepeat type='11'>-1</condrepeat>
			<indent type='3'>3</indent>
			<name>Build Installer Loop</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<Hidden type='11'>-1</Hidden>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Delete LdapSyncService so can be replaced by LdapSyncServiceWixTemplate</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncServiceWixTemplate</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy LdapSyncServiceWixTemplate to LdapSyncService</name>
		</step>
		<step action='Group'>
			<description><![CDATA[
]]></description>
			<indent type='3'>4</indent>
			<name>Read LdapSyncService brand vars from ini</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_FOLDER</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Tools\BrandLdapSyncServiceInstaller\Brand.ini,Brand%LdapSyncService_BRAND_LOOP_COUNT%,Folder,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read LdapSyncService_BRAND_FOLDER</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_BootstrapperEXECompany</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Tools\BrandLdapSyncServiceInstaller\Brand.ini,Brand%LdapSyncService_BRAND_LOOP_COUNT%,BootstrapperEXECompany,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read LdapSyncService_BRAND_BootstrapperEXECompany</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_BootstrapperEXEProductName</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Tools\BrandLdapSyncServiceInstaller\Brand.ini,Brand%LdapSyncService_BRAND_LOOP_COUNT%,BootstrapperEXEProductName,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read LdapSyncService_BRAND_BootstrapperEXEProductName</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_BootstrapperEXEFileDescription</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Tools\BrandLdapSyncServiceInstaller\Brand.ini,Brand%LdapSyncService_BRAND_LOOP_COUNT%,BootstrapperEXEFileDescription,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read LdapSyncService_BRAND_BootstrapperEXEFileDescription</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_BRANDCORPNAME</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Tools\BrandLdapSyncServiceInstaller\Brand.ini,Brand%LdapSyncService_BRAND_LOOP_COUNT%,InstallerBRANDCORPNAME,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read LdapSyncService_BRAND_BRANDCORPNAME</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_BRANDINFOURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Tools\BrandLdapSyncServiceInstaller\Brand.ini,Brand%LdapSyncService_BRAND_LOOP_COUNT%,InstallerBRANDINFOURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read LdapSyncService_BRAND_BRANDINFOURL</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_BRANDNAME</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Tools\BrandLdapSyncServiceInstaller\Brand.ini,Brand%LdapSyncService_BRAND_LOOP_COUNT%,InstallerBRANDNAME,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read LdapSyncService_BRAND_BRANDNAME</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_BRANDNAMEFILENAMEFRIENDLY</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Tools\BrandLdapSyncServiceInstaller\Brand.ini,Brand%LdapSyncService_BRAND_LOOP_COUNT%,InstallerBRANDNAMEFILENAMEFRIENDLY,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read LdapSyncService_BRAND_BRANDNAMEFILENAMEFRIENDLY</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_BRANDSUPPORTURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Tools\BrandLdapSyncServiceInstaller\Brand.ini,Brand%LdapSyncService_BRAND_LOOP_COUNT%,InstallerBRANDSUPPORTURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read LdapSyncService_BRAND_BRANDSUPPORTURL</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_BRANDUPDATEURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Tools\BrandLdapSyncServiceInstaller\Brand.ini,Brand%LdapSyncService_BRAND_LOOP_COUNT%,InstallerBRANDUPDATEURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read LdapSyncService_BRAND_BRANDUPDATEURL</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_BRANDPROGFILESFOLDER</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Tools\BrandLdapSyncServiceInstaller\Brand.ini,Brand%LdapSyncService_BRAND_LOOP_COUNT%,InstallerBRANDPROGFILESFOLDER,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read LdapSyncService_BRAND_BRANDPROGFILESFOLDER</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_BRANDPROGFILESFOLDERLEVEL2</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Tools\BrandLdapSyncServiceInstaller\Brand.ini,Brand%LdapSyncService_BRAND_LOOP_COUNT%,InstallerBRANDPROGFILESFOLDERLEVEL2,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read LdapSyncService_BRAND_BRANDPROGFILESFOLDERLEVEL2</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_TOSURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Tools\BrandLdapSyncServiceInstaller\Brand.ini,Brand%LdapSyncService_BRAND_LOOP_COUNT%,TOSURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read LdapSyncService_BRAND_TOSURL</name>
		</step>
		<step action='Group'>
			<indent type='3'>4</indent>
			<name>Build LdapSyncService MSI</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Tools\BrandLdapSyncServiceInstaller\%LdapSyncService_BRAND_FOLDER%\LayoutOverlay</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>5</indent>
			<name>Copy/overwrite Brand specific files to Build</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileOut>
			<Find>define\sBUILDNUM\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BUILDNUM=\"%RELEASE_VERSION%.%BUILD_VERSION%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[replacing version in:  <?define BUILDNUM="1.0.0.0" ?>
]]></description>
			<indent type='3'>5</indent>
			<name>Stamp Build number into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileOut>
			<Find>define\sBRANDBUILDFOLDERNAME\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDBUILDFOLDERNAME=\"%LdapSyncService_BRAND_FOLDER%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDBUILDFOLDERNAME into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileOut>
			<Find>define\sBRANDCORPNAME\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDCORPNAME=\"%LdapSyncService_BRAND_BRANDCORPNAME%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDCORPNAME into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileOut>
			<Find>define\sBRANDINFOURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDINFOURL=\"%LdapSyncService_BRAND_BRANDINFOURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDINFOURL into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileOut>
			<Find>define\sBRANDNAME\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDNAME=\"%LdapSyncService_BRAND_BRANDNAME%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDNAME into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileOut>
			<Find>define\sBRANDNAMEFILENAMEFRIENDLY\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDNAMEFILENAMEFRIENDLY=\"%LdapSyncService_BRAND_BRANDNAMEFILENAMEFRIENDLY%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDNAMEFILENAMEFRIENDLY into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileOut>
			<Find>define\sBRANDSUPPORTURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDSUPPORTURL=\"%LdapSyncService_BRAND_BRANDSUPPORTURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDSUPPORTURL into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileOut>
			<Find>define\sBRANDUPDATEURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDUPDATEURL=\"%LdapSyncService_BRAND_BRANDUPDATEURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDUPDATEURL into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileOut>
			<Find>define\sBRANDPROGFILESFOLDER\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDPROGFILESFOLDER=\"%LdapSyncService_BRAND_BRANDPROGFILESFOLDER%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDPROGFILESFOLDER into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileOut>
			<Find>define\sBRANDPROGFILESFOLDERLEVEL2\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDPROGFILESFOLDERLEVEL2=\"%LdapSyncService_BRAND_BRANDPROGFILESFOLDERLEVEL2%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDPROGFILESFOLDERLEVEL2 into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\BuildVars.wxi</FileOut>
			<Find>define\sBRANDTOSURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDTOSURL=\"%LdapSyncService_BRAND_TOSURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>5</indent>
			<name>Stamp BRANDTOSURL into Buildvars.wxi</name>
		</step>
		<step action='Run Program'>
			<command>nuget restore %WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService.sln</command>
			<description>Restore packages using nuget</description>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>5</indent>
			<name>Restore LdapSyncService installer Nuget </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Make VS.NET'>
			<AssemblyVer type='11'>-1</AssemblyVer>
			<Config>Release|x86</Config>
			<FileVer type='11'>-1</FileVer>
			<Filename>%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService.sln</Filename>
			<Force type='3'>1</Force>
			<Location>%PROGFILES%\Microsoft Visual Studio\2017\Enterprise\MSBuild\15.0\Bin\msbuild.exe</Location>
			<LogLevel type='3'>2</LogLevel>
			<Options>/flp:logfile=%LOGFILE%;Append;Summary;Verbosity=minimal; /maxcpucount:1 /nologo /consoleloggerparameters:ErrorsOnly;Summary;</Options>
			<ParseOutput type='11'>-1</ParseOutput>
			<ProdVer type='11'>-1</ProdVer>
			<Property1>%COMPANY_NAME%</Property1>
			<Property3>%COPYRIGHT%</Property3>
			<Property5>%PRODUCT_NAME%</Property5>
			<PropertyOn1 type='11'>-1</PropertyOn1>
			<PropertyOn3 type='11'>-1</PropertyOn3>
			<PropertyOn5 type='11'>-1</PropertyOn5>
			<ShowCmd type='11'>-1</ShowCmd>
			<Version>%RELEASE_VERSION%.%BUILD_VERSION%</Version>
			<VersionSel type='3'>2</VersionSel>
			<indent type='3'>5</indent>
			<name>Make VS.NET: Wix LdapSyncService MSI Setup </name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Tools\LdapSyncService\LdapSyncService\bin\Release\en-US\LdapSyncService.msi" "%WORKING_DIRECTORY%\DeploymentFiles\LdapSyncServiceInstaller-%FULL_BUILD_NUMBER%-%LdapSyncService_BRAND_FOLDER%.msi"</command>
			<indent type='3'>5</indent>
			<name>Copy MSI to DeploymentFiles folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"%SIGN_DIR%\CodeSigningToolSHA256\SignSha256Only.cmd" "%WORKING_DIRECTORY%\DeploymentFiles\LdapSyncServiceInstaller*.msi" "Carbonite Setup"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<description><![CDATA[
]]></description>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>5</indent>
			<name>Sign LdapSyncService install MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Set Macro'>
			<MacroName>LdapSyncService_BRAND_LOOP_COUNT</MacroName>
			<MacroValue>[%LdapSyncService_BRAND_LOOP_COUNT%+1]</MacroValue>
			<description>Initialize a counter macro value</description>
			<indent type='3'>4</indent>
			<name>Increment Brand Counter</name>
		</step>
		<step action='Group'>
			<indent type='3'>1</indent>
			<name>Vault MSI Installer</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>Vault</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Minor Build Stage</SubName>
			<indent type='3'>2</indent>
			<name>Log Minor Stage - Vault Installer</name>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>2</indent>
			<name>VaultMSI build layout (non vault brand)</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_LOOP_COUNT</MacroName>
			<MacroValue>0</MacroValue>
			<description>Initialize a counter macro value</description>
			<indent type='3'>3</indent>
			<name>Initialize brand Counter (only 0 brand for Carbonite)</name>
		</step>
		<step action='Group'>
			<indent type='3'>3</indent>
			<name>Create Folder Structure</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\DatabaseScripts"</command>
			<indent type='3'>4</indent>
			<name>DatabaseScripts</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Access"</command>
			<indent type='3'>4</indent>
			<name>Web/Access</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Dashboard"</command>
			<indent type='3'>4</indent>
			<name>Web/Dashboard</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\ResetServer"</command>
			<indent type='3'>4</indent>
			<name>Web/ResetServer</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\VaultServices"</command>
			<indent type='3'>4</indent>
			<name>Web/VaultServices</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Help"</command>
			<indent type='3'>4</indent>
			<name>Web/Help</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Download"</command>
			<indent type='3'>4</indent>
			<name>Web/Download</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Service"</command>
			<indent type='3'>4</indent>
			<name>Service</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<checked type='11'>0</checked>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Tools\PartitionManager"</command>
			<indent type='3'>4</indent>
			<name>Tools/PartitionManager</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Tools\LogViewer"</command>
			<indent type='3'>4</indent>
			<name>Tools/LogViewer</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Tools\DeploymentManager"</command>
			<indent type='3'>4</indent>
			<name>Tools/DeploymentManager</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Logging"</command>
			<indent type='3'>4</indent>
			<name>Logging</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DeployDatabase.sql" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\DatabaseScripts\DeployDatacastleDatabase.sql"</command>
			<indent type='3'>3</indent>
			<name>Copy DCVault SQL File - Deployment </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DeployDashboard.sql" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\DatabaseScripts\DeployDashboardDatabase.sql"</command>
			<indent type='3'>3</indent>
			<name>Copy Dashboard SQL File - Deployment </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>[vbld_FSO.FileExists("%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\DCUpgradeCollateSQLScripts.cmd")]</condexpr>
			<indent type='3'>3</indent>
			<name>collate sql upgrade scripts</name>
		</step>
		<step action='Batch File'>
			<CmdStr>%WORKING_DIRECTORY%\DeploymentFiles\BuildTools\StoredProcGeneratorCmd.exe ""%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\DatabaseScripts\DeployDatacastleDatabase.sql"" "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\DCVaultStoredProcs.sql"</CmdStr>
			<CmdType type='3'>1</CmdType>
			<ShowCmd type='11'>-1</ShowCmd>
			<indent type='3'>4</indent>
			<name>Extract stored procs for use in upgrade script (vault)</name>
			<startin>%WORKING_DIRECTORY%\DeploymentFiles\BuildTools</startin>
		</step>
		<step action='Batch File'>
			<CmdStr>%WORKING_DIRECTORY%\DeploymentFiles\BuildTools\StoredProcGeneratorCmd.exe ""%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\DatabaseScripts\DeployDashboardDatabase.sql"" "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\DCDashboardStoredProcs.sql"</CmdStr>
			<CmdType type='3'>1</CmdType>
			<ShowCmd type='11'>-1</ShowCmd>
			<indent type='3'>4</indent>
			<name>Extract stored procs for use in upgrade script (dashboard)</name>
			<startin>%WORKING_DIRECTORY%\DeploymentFiles\BuildTools</startin>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\CEPUpgradeCollateSQLScripts.cmd</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\CEPUpgradeCollateSQLScripts.cmd</FileOut>
			<Find>BRANCHFOLDER</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%WORKING_DIRECTORY%</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>4</indent>
			<name>Search and Replace BRANCHFOLDER in sql upgrade collate file</name>
		</step>
		<step action='Batch File'>
			<CmdFile>%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\CEPUpgradeCollateSQLScripts.cmd</CmdFile>
			<ShowCmd type='11'>-1</ShowCmd>
			<indent type='3'>4</indent>
			<name>Run Upgrade script preprocessing command file</name>
			<startin>%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig</startin>
		</step>
		<step action='Replace in File'>
			<Binary type='11'>-1</Binary>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\CEPVaultUpgrade.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\CEPVaultUpgrade.sql</FileOut>
			<Find>ï»¿</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace> </Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<description>Replaces the BOM characters throughout the file that cause upgrade issues in the Azure vaults</description>
			<indent type='3'>4</indent>
			<name>Replace Special Characters in CEPUpgrade File</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\CEPVaultUpgrade.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\CEPVaultUpgrade.sql</FileOut>
			<Find>﻿</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace><![CDATA[
]]></Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<description>this replaces a special character wtih space + carrage return</description>
			<indent type='3'>4</indent>
			<name>strip out endoffile dashboard - this looks like a nothing replace but it is not</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\DCDashboardUpgrade.sql" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\DatabaseScripts\UpdateDashboard.sql"</command>
			<indent type='3'>3</indent>
			<name>Copy Dashboard Update SQL File - Deployment </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\DCVaultUpgrade.sql" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\DatabaseScripts\UpdateVault.sql"</command>
			<indent type='3'>3</indent>
			<name>Copy Vault Update SQL File - Deployment </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\CEPVaultUpgrade.sql" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\DatabaseScripts\CEPUpdateVault.sql"</command>
			<indent type='3'>3</indent>
			<name>Copy CEP Vault Update SQL File - Deployment </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\DatabaseScripts</DestDir>
			<ExclExt><![CDATA[DCDashboardUpgrade.sql
DCVaultUpgrade.sql]]></ExclExt>
			<Ext>*.sql</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy other SQL files for vault installer</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\DatabaseScripts\DeployDashboardDatabase.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\DatabaseScripts\DeployDashboardDatabase.sql</FileOut>
			<Find>\sCREATE\sSCHEMA.*Operations.*\r\n.*AUTH.*;</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace><![CDATA[
if NOT EXISTS \(select 1 from sys.schemas where name = N'Operations'\)
	EXECUTE sp_executesql N'CREATE SCHEMA [[Operations]] AUTHORIZATION [[dbo]];'
]]></Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>3</indent>
			<name>poke DB script to fix CREATE SCHEMA issue in Dashboard</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\DatabaseScripts\DeployDatacastleDatabase.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\DatabaseScripts\DeployDatacastleDatabase.sql</FileOut>
			<Find>\sCREATE\sSCHEMA.*Operations.*\r\n.*AUTH.*;</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace><![CDATA[
if NOT EXISTS \(select 1 from sys.schemas where name = N'Operations'\)
	EXECUTE sp_executesql N'CREATE SCHEMA [[Operations]] AUTHORIZATION [[dbo]];'
]]></Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>3</indent>
			<name>poke DB script to fix CREATE SCHEMA issue in Datacastle</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\CarboniteAzureSQL-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[UpdateDashboard.sql
UpdateVault.sql
CEPUpdateVault.sql
DeployDashboardDatabase.sql
DeployDatacastleDatabase.sql
]]></Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Source>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\DatabaseScripts</Source>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>ZIP DB files for Azure</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\Logging.config.xml" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Logging\Logging.config.xml"</command>
			<indent type='3'>3</indent>
			<name>Copy Logging Deployment Config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\End User License Agreement.rtf" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\End User License Agreement.rtf"</command>
			<indent type='3'>3</indent>
			<name>Copy License agreement</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\GettingStarted.rtf" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\GettingStarted.rtf"</command>
			<indent type='3'>3</indent>
			<name>Copy GettingStarted doc</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotBuildClients%</condexpr>
			<indent type='3'>3</indent>
			<name>Include clients (real clients if not fast track build) </name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\DeploymentFiles\DCProtect-%FULL_BUILD_NUMBER%-Carbonite.EXE" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Download\DCProtectInstall.EXE"</command>
			<indent type='3'>4</indent>
			<name>Copy default installer (Windows)</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoNotBuildClients%</condexpr>
			<indent type='3'>3</indent>
			<name>Include clients (fake clients for fast track build) </name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\build\FastBuildSwitchesFile\DummyEXEThatShowsNotARealApp.exe" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Download\DCProtectInstall.EXE"</command>
			<indent type='3'>4</indent>
			<name>Copy default installer (Windows)</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeMacClient%</condexpr>
			<indent type='3'>3</indent>
			<name>Include Mac clients (real clients if not fast track build)</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\DeploymentFiles\DCProtect-%FULL_BUILD_NUMBER%-Carbonite.pkg" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Download\DCProtectInstall.pkg"</command>
			<indent type='3'>4</indent>
			<name>Copy default installer (Mac)</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoNotIncludeMacClient%</condexpr>
			<indent type='3'>3</indent>
			<name>Include Mac clients (fake clients for fast track build)</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\build\FastBuildSwitchesFile\DummyEXEThatShowsNotARealApp.exe" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Download\DCProtectInstall.pkg"</command>
			<indent type='3'>4</indent>
			<name>Copy default installer (Mac)</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeLDAPSync%</condexpr>
			<indent type='3'>3</indent>
			<name>Include Ldap installer (real installer if not fast track build)</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\DeploymentFiles\LdapSyncServiceInstaller-%FULL_BUILD_NUMBER%-Carbonite.msi" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Download\LdapSyncServiceInstall.msi"</command>
			<indent type='3'>4</indent>
			<name>Copy default LDAP installer</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoNotIncludeLDAPSync%</condexpr>
			<indent type='3'>3</indent>
			<name>Include Ldap installer (fake installer for fast track build) </name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\build\FastBuildSwitchesFile\DummyEXEThatShowsNotARealApp.exe" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Download\LdapSyncServiceInstall.msi"</command>
			<indent type='3'>4</indent>
			<name>Copy default LDAP installer</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\AccessVDirHTTPRedirectWeb.config" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Access\web.config""</command>
			<indent type='3'>3</indent>
			<name>Copy Access vdir web.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<indent type='3'>3</indent>
			<name>Block Management Service</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Service</DestDir>
			<Ext><![CDATA[*.dll
*.exe]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Datacastle.Server.BlockManagementService\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy BlockManagementService Files</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\BlockManagementService.exe.config" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Service\VaultManagementService.exe.config"</command>
			<indent type='3'>4</indent>
			<name>Copy VaultManagementService config file</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c ren "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Service\Datacastle.Server.BlockManagementService.exe" VaultManagementService.exe</command>
			<indent type='3'>4</indent>
			<name>rename service EXE to VaultManagementService</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<indent type='3'>3</indent>
			<name>Dashboard Web</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Dashboard</DestDir>
			<Empty type='11'>-1</Empty>
			<ExclExt><![CDATA[Dashboard\*
DashboardServices\*
DCCustomer\*
DCDeviceReset\*
DCDeviceReset\Scripts\*
DCDiscovery\*
DCPartner\*
DCProvision\*
ProductionFiles\*
SensitiveConfiguration\*
UpdateServer\*
UpdateServer\Datacastle\*
bin\*.pdb
bin\7z.*
bin\antlr.runtime.dll
bin\BouncyCastle.Crypto.dll
bin\Common.logging.dll
bin\Datacastle.Client.Common.dll
bin\Datacastle.Client.FileStore.dll
bin\Datacastle.Client.ServiceSchemas.dll
bin\Datacastle.Common.Bits.dll
bin\Datacastle.Common.Common.dll
bin\Datacastle.Common.Configuration.dll
bin\Datacastle.Common.DTOSchemas.dll
bin\Datacastle.Common.Security.dll
bin\Datacastle.Server.BlockManagement.dll
bin\Datacastle.Server.BlockManagementService.exe
bin\Carbonite.Server.Common.dll
bin\Datacastle.Server.CustomerService.dll
bin\Datacastle.Server.DiscoveryService.dll
bin\Datacastle.Server.PartnerService.dll
bin\Datacastle.Server.ProvisionService.dll
bin\Carbonite.Server.VaultLicensing.dll
bin\DCClient.Infrastructure.dll
bin\ICSharpCode.SharpZipLib.dll
bin\Interop.IWshRuntimeLibrary.dll
bin\Interop.VssWs03.dll
bin\Interop.VssXP.dll
bin\log4net.dll
bin\logging.config.xml
bin\Microsoft.ApplicationBlocks.Updater.dll
bin\Microsoft.Practices.EnterpriseLibrary.Common.dll
bin\Microsoft.Practices.EnterpriseLibrary.Data.dll
bin\Microsoft.Practices.ObjectBuilder.dll
bin\Microsoft.WindowsAzure.Diagnostics.xml
bin\Microsoft.WindowsAzure.StorageClient.xml
bin\Mono.Data.Sqlite.dll
bin\Spring.Core.dll
bin\Spring.Data.dll
bin\Spring.Services.dll
bin\StartupCommon.ps1
bin\StartupCustom.ps1
bin\StartupCustom.zip
bin\Xenocode.Client.dll
]]></ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\PrecompiledWeb</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy website DLLs</name>
		</step>
		<step action='Delete Files'>
			<Ext><![CDATA[web*.config
]]></Ext>
			<LogDel type='11'>-1</LogDel>
			<Path>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Dashboard</Path>
			<indent type='3'>4</indent>
			<name>Delete extra files from directly in Dashboard folder</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\Dashboard-web.config" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Dashboard\web.config""</command>
			<indent type='3'>4</indent>
			<name>Copy website web.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Dashboard\SensitiveConfiguration"</command>
			<indent type='3'>4</indent>
			<name>Web/Dashboard/SensitiveConfiguration</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\SensitiveConfiguration.config" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Dashboard\SensitiveConfiguration\SensitiveConfiguration.config"</command>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Copy website SensitiveConfiguration.config (HACK, allow it to fail as Gary has shelf without it and we won't need it anymore once he checks in)</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<indent type='3'>3</indent>
			<name>Vault Services</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\VaultServices\bin</DestDir>
			<Ext><![CDATA[*.dll
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Datacastle.Vault.Service\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy VaultServices DLLs</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c del "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\VaultServices\*.config"</command>
			<indent type='3'>4</indent>
			<name>Delete all bogus web.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\VaultServices-web.config" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\VaultServices\web.config""</command>
			<indent type='3'>4</indent>
			<name>Copy website web.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\VaultDashboardService.v1.0.svc" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\VaultServices\VaultDashboardService.v1.0.svc"</command>
			<indent type='3'>4</indent>
			<name>Copy vault dashboard services svc</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\VaultServices-Global.asax" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\VaultServices\Global.asax"</command>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Copy vault dashboard services global.asax</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\VaultDeviceService.v1.0.svc" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\VaultServices\VaultDeviceService.v1.0.svc"</command>
			<indent type='3'>4</indent>
			<name>Copy vault device services svc</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<indent type='3'>3</indent>
			<name>Reset Server Web</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\ResetServer</DestDir>
			<Empty type='11'>-1</Empty>
			<ExclExt>*.pdb</ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeviceResetPrecompiledWeb</SourceDir>
			<TBD type='11'>-1</TBD>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>4</indent>
			<name>Copy precompiled web to where its installer expects it</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c del "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\ResetServer\*.config"</command>
			<indent type='3'>4</indent>
			<name>Delete all bogus web.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\ResetServer-web.config" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\ResetServer\web.config"</command>
			<indent type='3'>4</indent>
			<name>Copy website web.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludePrecompiledHelp%</condexpr>
			<indent type='3'>3</indent>
			<name>WebHelp</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(en-en)-%FULL_BUILD_NUMBER%.zip" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Help\WebHelp-EN-EN.zip"</command>
			<indent type='3'>4</indent>
			<name>Copy EN-EN Webhelp</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(de-de)-%FULL_BUILD_NUMBER%.zip" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Help\WebHelp-DE-DE.zip"</command>
			<indent type='3'>4</indent>
			<name>Copy DE-DE Webhelp</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(es-es)-%FULL_BUILD_NUMBER%.zip" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Help\WebHelp-ES-ES.zip"</command>
			<indent type='3'>4</indent>
			<name>Copy ES-ES Webhelp</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(fr-fr)-%FULL_BUILD_NUMBER%.zip" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Help\WebHelp-FR-FR.zip"</command>
			<indent type='3'>4</indent>
			<name>Copy FR-FR Webhelp</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(it-it)-%FULL_BUILD_NUMBER%.zip" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Help\WebHelp-it-it.zip"</command>
			<indent type='3'>4</indent>
			<name>Copy IT-IT Webhelp</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(pl-pl)-%FULL_BUILD_NUMBER%.zip" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Help\WebHelp-PL-PL.zip"</command>
			<indent type='3'>4</indent>
			<name>Copy PL-PL Webhelp</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(ja-jp)-%FULL_BUILD_NUMBER%.zip" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Help\WebHelp-JA-JP.zip"</command>
			<condexpr>%changeset%</condexpr>
			<indent type='3'>4</indent>
			<name>Copy JA-JP Webhelp</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(ko-kr)-%FULL_BUILD_NUMBER%.zip" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Help\WebHelp-KO-KR.zip"</command>
			<condexpr>%changeset%</condexpr>
			<indent type='3'>4</indent>
			<name>Copy KO-KR Webhelp</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(pt-br)-%FULL_BUILD_NUMBER%.zip" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Help\WebHelp-PT-BR.zip"</command>
			<condexpr>%changeset%</condexpr>
			<indent type='3'>4</indent>
			<name>Copy PT-BR Webhelp</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(zh-cn)-%FULL_BUILD_NUMBER%.zip" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Help\WebHelp-ZH-CN.zip"</command>
			<condexpr>%changeset%</condexpr>
			<indent type='3'>4</indent>
			<name>Copy ZH-CN Webhelp</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\DeploymentFiles\WebHelp(tr-tr)-%FULL_BUILD_NUMBER%.zip" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Help\WebHelp-TR-TR.zip"</command>
			<condexpr>%changeset%</condexpr>
			<indent type='3'>4</indent>
			<name>Copy TR-TR Webhelp</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<indent type='3'>3</indent>
			<name>Tools</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Web\Download</DestDir>
			<Ext><![CDATA[DashboardManager*.EXE
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Tools\DashboardManager\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy DashboardManager to Download</name>
		</step>
		<step action='Copy Files'>
			<Converted type='11'>-1</Converted>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Tools\ProtectionServiceRESTWrapper</DestDir>
			<ExclExt>*.pdb</ExclExt>
			<Ext><![CDATA[*.dll
*.exe
*.config
]]></Ext>
			<HideOn type='11'>-1</HideOn>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Tools\ProtectionServiceRESTWrapper\bin\Release</SourceDir>
			<SysOn type='11'>-1</SysOn>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy ProtectionServiceRESTWrapper to DeploymentFiles</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Tools\ProtectionServiceRESTWrapper</DestDir>
			<Ext>ProtectionServiceRESTWrapper</Ext>
			<HideOn type='11'>-1</HideOn>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>\\%MACBUILD%\BuildMachineUsageOnly\setup\MultiPlatform\minimum\Core\Tools\ProtectionServiceRESTWrapper\bin\Release</SourceDir>
			<SysOn type='11'>-1</SysOn>
			<TBD type='11'>-1</TBD>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeMacClient%</condexpr>
			<indent type='3'>4</indent>
			<name>Copy MAC built ProtectionServiceRESTWrapper to DeploymentFiles</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\ProtectionServiceRESTWrapper-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.config
*.dll
*.exe
ProtectionServiceRESTWrapper]]></Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\DeploymentFiles\Tools\ProtectionServiceRESTWrapper</Source>
			<indent type='3'>4</indent>
			<name>ZIP ProtectionServiceRESTWrapper Tools</name>
		</step>
		<step action='Delete Folder'>
			<Path>%WORKING_DIRECTORY%\DeploymentFiles\Tools\ProtectionServiceRESTWrapper</Path>
			<Recurse type='11'>-1</Recurse>
			<ShowCmd type='11'>-1</ShowCmd>
			<indent type='3'>4</indent>
			<name>Delete ProtectionServiceRESTWrapper Folder</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Tools\PartitionManager</DestDir>
			<Ext><![CDATA[*.EXE
*.DLL
*.xml]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\PartitionManager\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>4</indent>
			<name>Copy Partition Manager</name>
		</step>
		<step action='Run Program'>
			<checked type='11'>0</checked>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\PartitionManager.exe.config" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Tools\PartitionManager\PartitionManager.exe.config"</command>
			<indent type='3'>4</indent>
			<name>Copy Partition Manager release app.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Tools\DeploymentManager</DestDir>
			<Ext><![CDATA[*.EXE
*.DLL
BrandingImages\*.*
EmailTemplates\*.*]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\DeploymentManager\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy DeploymentManager </name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Tools\DeploymentManager\BrandingImages</DestDir>
			<Ext><![CDATA[*.*
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\DeploymentManager\bin\Release\BrandingImages</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy DeploymentManager BrandingImages</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Tools\DeploymentManager\EmailTemplates</DestDir>
			<Ext><![CDATA[*.*
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\DeploymentManager\bin\Release\EmailTemplates</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy DeploymentManager EmailTemplates</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Tools\LogViewer</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext><![CDATA[*.exe
*.dll
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\MiscInternalTools\LogViewer\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy LogViewer to deployment layout</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\LogViewer.EXE.config" "%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\Tools\LogViewer\LogViewer.exe.config"</command>
			<indent type='3'>4</indent>
			<name>Copy LogViewer release app.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condexpr>DoNotObfuscateQuickCache</condexpr>
			<indent type='3'>3</indent>
			<name>Obfuscate Vault with Dotfuscator</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VaultObfuscateFolderNumber</MacroName>
			<MacroValue>1</MacroValue>
			<condcompareto>True</condcompareto>
			<indent type='3'>4</indent>
			<name>Set VaultObfuscateFolderNumber to 1</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VaultObfuscateFolderCurrent</MacroName>
			<MacroValue>%READ_INI(%DOTFUSCATOR_VAULT_OBFUSCATE_INI%,General,Folder%VaultObfuscateFolderNumber%,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>4</indent>
			<name>Read VaultObfuscateFolderCurrent from ini</name>
		</step>
		<step action='Group'>
			<condcompareto>NOTSET</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%VaultObfuscateFolderCurrent%</condexpr>
			<condrepeat type='11'>-1</condrepeat>
			<indent type='3'>4</indent>
			<name>Obfuscate folder loop</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotObfusateVault%</condexpr>
			<indent type='3'>5</indent>
			<name>If we are obfuscating - not a fast build</name>
		</step>
		<step action='Delete Folder'>
			<Path>%WORKING_DIRECTORY%\Deployment\Server\VaultObfuscationBuildWorkingFolder</Path>
			<Recurse type='11'>-1</Recurse>
			<ShowCmd type='11'>-1</ShowCmd>
			<indent type='3'>6</indent>
			<name>Delete VaultObfuscationBuildWorkingFolder</name>
		</step>
		<step action='Create Folder'>
			<Path>%WORKING_DIRECTORY%\Deployment\Server\VaultObfuscationBuildWorkingFolder</Path>
			<indent type='3'>6</indent>
			<name>Create VaultObfuscationBuildWorkingFolder</name>
		</step>
		<step action='Create Folder'>
			<Path>%WORKING_DIRECTORY%\Deployment\Server\VaultObfuscationBuildWorkingFolder\Obfuscated</Path>
			<indent type='3'>6</indent>
			<name>Create VaultObfuscationBuildWorkingFolder\Obfuscated</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\DotfuscatorTemplate.xml" "%WORKING_DIRECTORY%\Deployment\Server\VaultObfuscationBuildWorkingFolder\DotfuscatorVaultDashboard.xml"</command>
			<indent type='3'>6</indent>
			<name>Copy template Dotfuscator project file to working copy</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\VaultObfuscationBuildWorkingFolder\</DestDir>
			<Ext>datacastle_dashboard.snk</Ext>
			<HideOn type='11'>-1</HideOn>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Datacastle.Dashboard\</SourceDir>
			<SysOn type='11'>-1</SysOn>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>6</indent>
			<name>Copy Datacastle Dashboard SNK File</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\VaultObfuscationBuildWorkingFolder</DestDir>
			<Ext><![CDATA[*.*
]]></Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\%VaultObfuscateFolderCurrent%</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>6</indent>
			<name>Copy files to working folder</name>
		</step>
		<step action='Run Program'>
			<command>"dotfuscator.exe" /q "DotfuscatorVaultDashboard.xml" </command>
			<indent type='3'>6</indent>
			<name>Run Dotfuscator To Obfuscate</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Server\VaultObfuscationBuildWorkingFolder</startin>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI\%VaultObfuscateFolderCurrent%</DestDir>
			<ExclExt>*.snk</ExclExt>
			<Ext><![CDATA[*.dll
*.exe]]></Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\VaultObfuscationBuildWorkingFolder\Obfuscated\VaultObfuscationBuildWorkingFolder</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>6</indent>
			<name>Copy obfuscated files back</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VaultObfuscateFolderNumber</MacroName>
			<MacroValue>[%VaultObfuscateFolderNumber%+1]</MacroValue>
			<indent type='3'>5</indent>
			<name>Increment VaultObfuscateFolderNumber Counter</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VaultObfuscateFolderCurrent</MacroName>
			<MacroValue>%READ_INI(%DOTFUSCATOR_VAULT_OBFUSCATE_INI%,General,Folder%VaultObfuscateFolderNumber%,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Read VaultObfuscateFolderCurrent</name>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>2</indent>
			<name>VaultMSI build layout (vault brand)</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%BRAND_VAULT_BASEVAULTZIP%" "%WORKING_DIRECTORY%\Deployment\Server\BaseVaultForBranding.zip"</command>
			<indent type='3'>3</indent>
			<name>Copy MSI to DeploymentFiles folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Enhanced Unzip Files'>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI</Dest>
			<Ext>*.*</Ext>
			<LogDetail type='11'>-1</LogDetail>
			<PathInfo type='11'>-1</PathInfo>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\Deployment\Server\BaseVaultForBranding.zip</Source>
			<indent type='3'>3</indent>
			<name>UNZIP Base vault zip for DeploymentFiles</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>VaultBrands*.ini</Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%PROJDIR%\BuildTweaks</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy BuildTweaks\VaultBrands.ini to build output for reference</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_LOOP_COUNT</MacroName>
			<MacroValue>1</MacroValue>
			<description>Initialize a counter macro value</description>
			<indent type='3'>3</indent>
			<name>Initialize Brand Counter (only 1 brand supported at this time)</name>
		</step>
		<step action='Group'>
			<description><![CDATA[
]]></description>
			<indent type='3'>2</indent>
			<name>Read vault brand vars from ini</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_FOLDER</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandVaultInstaller\Brand.ini,Brand%VAULT_BRAND_LOOP_COUNT%,Folder,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Read VAULT_BRAND_FOLDER</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_BootstrapperEXECompany</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandVaultInstaller\Brand.ini,Brand%VAULT_BRAND_LOOP_COUNT%,BootstrapperEXECompany,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Read VAULT_BRAND_BootstrapperEXECompany</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_BootstrapperEXEProductName</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandVaultInstaller\Brand.ini,Brand%VAULT_BRAND_LOOP_COUNT%,BootstrapperEXEProductName,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Read VAULT_BRAND_BootstrapperEXEProductName</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_BootstrapperEXEFileDescription</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandVaultInstaller\Brand.ini,Brand%VAULT_BRAND_LOOP_COUNT%,BootstrapperEXEFileDescription,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Read VAULT_BRAND_BootstrapperEXEFileDescription</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_BRANDCORPNAME</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandVaultInstaller\Brand.ini,Brand%VAULT_BRAND_LOOP_COUNT%,InstallerBRANDCORPNAME,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Read VAULT_BRAND_BRANDCORPNAME</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_BRANDINFOURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandVaultInstaller\Brand.ini,Brand%VAULT_BRAND_LOOP_COUNT%,InstallerBRANDINFOURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Read VAULT_BRAND_BRANDINFOURL</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_BRANDNAME</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandVaultInstaller\Brand.ini,Brand%VAULT_BRAND_LOOP_COUNT%,InstallerBRANDNAME,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Read VAULT_BRAND_BRANDNAME</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_BRANDNAMEFILENAMEFRIENDLY</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandVaultInstaller\Brand.ini,Brand%VAULT_BRAND_LOOP_COUNT%,InstallerBRANDNAMEFILENAMEFRIENDLY,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Read VAULT_BRAND_BRANDNAMEFILENAMEFRIENDLY</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_BRANDSUPPORTURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandVaultInstaller\Brand.ini,Brand%VAULT_BRAND_LOOP_COUNT%,InstallerBRANDSUPPORTURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Read VAULT_BRAND_BRANDSUPPORTURL</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_BRANDUPDATEURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandVaultInstaller\Brand.ini,Brand%VAULT_BRAND_LOOP_COUNT%,InstallerBRANDUPDATEURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Read VAULT_BRAND_BRANDUPDATEURL</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_BRANDPROGFILESFOLDER</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandVaultInstaller\Brand.ini,Brand%VAULT_BRAND_LOOP_COUNT%,InstallerBRANDPROGFILESFOLDER,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Read VAULT_BRAND_BRANDPROGFILESFOLDER</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_BRANDPROGFILESFOLDERLEVEL2</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandVaultInstaller\Brand.ini,Brand%VAULT_BRAND_LOOP_COUNT%,InstallerBRANDPROGFILESFOLDERLEVEL2,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Read VAULT_BRAND_BRANDPROGFILESFOLDERLEVEL2</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_BRANDEMAILSUBJECTLINE</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandVaultInstaller\Brand.ini,Brand%VAULT_BRAND_LOOP_COUNT%,InstallerBRANDEMAILSUBJECTLINE,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Read VAULT_BRAND_BRANDEMAILSUBJECTLINE</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_TOSURL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Deployment\Server\BrandVaultInstaller\Brand.ini,Brand%VAULT_BRAND_LOOP_COUNT%,TOSURL,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Read VAULT_BRAND_TOSURL</name>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Build Vault MSI (brand and non-branded)</name>
		</step>
		<step action='Delete Folder'>
			<Path>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\Build</Path>
			<Recurse type='11'>-1</Recurse>
			<ShowCmd type='11'>-1</ShowCmd>
			<indent type='3'>3</indent>
			<name>Delete Build folder which is where WiX pulls DLLs from</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\Build</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext><![CDATA[*.*
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy new copy of Build folder to deployment layout</name>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Prepare branding files for VaultMSI</name>
		</step>
		<step action='Delete Files'>
			<Ext>DCProtectInstall.*</Ext>
			<LogDel type='11'>-1</LogDel>
			<Path>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\Build\Web\Download</Path>
			<ReadOnly type='11'>-1</ReadOnly>
			<indent type='3'>4</indent>
			<name>Delete client installers so don't accidentially use unbranded ones</name>
		</step>
		<step action='Delete LDAP Files'>
			<Ext>LdapSyncServiceInstaller.*</Ext>
			<LogDel type='11'>-1</LogDel>
			<Path>%WORKING_DIRECTORY%\Deployment\Server\VaultInstall\Build\Web\Download</Path>
			<ReadOnly type='11'>-1</ReadOnly>
			<indent type='3'>4</indent>
			<name>Delete LDAP installers so don't accidentally use unbranded ones</name>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_WINDOWSINSTALLER</MacroName>
			<MacroValue>%READ_INI(%PROJDIR%\BuildTweaks\VaultBrands.ini,Brand%VAULT_BRAND_LOOP_COUNT%,WindowsInstaller,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>4</indent>
			<name>Read VAULT_BRAND_WINDOWSINSTALLER</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%VAULT_BRAND_WINDOWSINSTALLER%" "%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\Build\Web\Download\DCProtectInstall.EXE"</command>
			<indent type='3'>4</indent>
			<name>Copy Windows client installer</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Set Macro'>
			<MacroName>VAULT_BRAND_MACINSTALLER</MacroName>
			<MacroValue>%READ_INI(%PROJDIR%\BuildTweaks\VaultBrands.ini,Brand%VAULT_BRAND_LOOP_COUNT%,MacInstaller,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>4</indent>
			<name>Read VAULT_BRAND_MACINSTALLER</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%VAULT_BRAND_MACINSTALLER%" "%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\Build\Web\Download\DCProtectInstall.pkg"</command>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeMacClient%</condexpr>
			<indent type='3'>4</indent>
			<name>Copy Mac client installer</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\DeploymentFiles\LdapSyncServiceInstaller-%FULL_BUILD_NUMBER%-Carbonite.msi" "%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\Build\Web\Download\LdapSyncServiceInstall.msi"</command>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeLDAPSync%</condexpr>
			<indent type='3'>4</indent>
			<name>Copy (Default) LDAP Installer</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<FailNone type='11'>-1</FailNone>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\BrandVaultInstaller\%VAULT_BRAND_FOLDER%\LayoutOverlay</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>4</indent>
			<name>Copy/overwrite Brand specific files to Build</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileOut>
			<Find>define\sBUILDNUM\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BUILDNUM=\"%RELEASE_VERSION%.%BUILD_VERSION%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[replacing version in:  <?define BUILDNUM="1.0.0.0" ?>
]]></description>
			<indent type='3'>3</indent>
			<name>Stamp Build number into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileOut>
			<Find>define\sBRANDBUILDFOLDERNAME\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDBUILDFOLDERNAME=\"%VAULT_BRAND_FOLDER%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Stamp BRANDBUILDFOLDERNAME into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileOut>
			<Find>define\sBRANDCORPNAME\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDCORPNAME=\"%VAULT_BRAND_BRANDCORPNAME%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Stamp BRANDCORPNAME into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileOut>
			<Find>define\sBRANDINFOURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDINFOURL=\"%VAULT_BRAND_BRANDINFOURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Stamp BRANDINFOURL into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileOut>
			<Find>define\sBRANDNAME\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDNAME=\"%VAULT_BRAND_BRANDNAME%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Stamp BRANDNAME into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileOut>
			<Find>define\sBRANDNAMEFILENAMEFRIENDLY\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDNAMEFILENAMEFRIENDLY=\"%VAULT_BRAND_BRANDNAMEFILENAMEFRIENDLY%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Stamp BRANDNAMEFILENAMEFRIENDLY into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileOut>
			<Find>define\sBRANDSUPPORTURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDSUPPORTURL=\"%VAULT_BRAND_BRANDSUPPORTURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Stamp BRANDSUPPORTURL into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileOut>
			<Find>define\sBRANDUPDATEURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDUPDATEURL=\"%VAULT_BRAND_BRANDUPDATEURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Stamp BRANDUPDATEURL into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileOut>
			<Find>define\sBRANDPROGFILESFOLDER\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDPROGFILESFOLDER=\"%VAULT_BRAND_BRANDPROGFILESFOLDER%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Stamp BRANDPROGFILESFOLDER into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileOut>
			<Find>define\sBRANDPROGFILESFOLDERLEVEL2\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDPROGFILESFOLDERLEVEL2=\"%VAULT_BRAND_BRANDPROGFILESFOLDERLEVEL2%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Stamp BRANDPROGFILESFOLDERLEVEL2 into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileOut>
			<Find>define\sDEFAULTSUBJECTLINETAG\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define DEFAULTSUBJECTLINETAG=\"%VAULT_BRAND_BRANDEMAILSUBJECTLINE%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Stamp BRANDEMAILSUBJECTLINE into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\BuildVars.wxi</FileOut>
			<Find>define\sBRANDTOSURL\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>define BRANDTOSURL=\"%VAULT_BRAND_TOSURL%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Stamp BRANDTOSURL into Buildvars.wxi</name>
		</step>
		<step action='Replace in File'>
			<Append>BUILD ERROR REPLACING BrandProductName </Append>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\BootstrapUi\Program.cs</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\BootstrapUi\Program.cs</FileOut>
			<Find>static\s*string\s*BrandProductName\s*=\s*\".+\"</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<NoModS type='11'>-1</NoModS>
			<Replace>static string BrandProductName = \"%VAULT_BRAND_BootstrapperEXEProductName%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Stamp BootstrapperEXEProductName ointo BootstrapUi/Program.cs</name>
		</step>
		<step action='Make VS.NET'>
			<AssemblyVer type='11'>-1</AssemblyVer>
			<Config>Release|Mixed Platforms</Config>
			<FileVer type='11'>-1</FileVer>
			<Filename>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultInstaller.sln</Filename>
			<Force type='3'>1</Force>
			<Location>%PROGFILES%\Microsoft Visual Studio\2017\Enterprise\MSBuild\15.0\Bin\msbuild.exe</Location>
			<LogLevel type='3'>2</LogLevel>
			<Options>/flp:logfile=%LOGFILE%;Append;Summary;Verbosity=minimal; /maxcpucount:1 /nr:false /nologo /consoleloggerparameters:ErrorsOnly;Summary;</Options>
			<ParseOutput type='11'>-1</ParseOutput>
			<ProdVer type='11'>-1</ProdVer>
			<Property1>%COMPANY_NAME%</Property1>
			<Property3>%COPYRIGHT%</Property3>
			<Property5>%PRODUCT_NAME%</Property5>
			<PropertyOn1 type='11'>-1</PropertyOn1>
			<PropertyOn3 type='11'>-1</PropertyOn3>
			<PropertyOn5 type='11'>-1</PropertyOn5>
			<ShowCmd type='11'>-1</ShowCmd>
			<Version>%RELEASE_VERSION%.%BUILD_VERSION%</Version>
			<VersionSel type='3'>2</VersionSel>
			<indent type='3'>3</indent>
			<name>Make VS.NET: Wix Vault MSI Setup </name>
		</step>
		<step action='Run Program'>
			<checked type='11'>0</checked>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\bin\Release\en-US\VaultInstaller.msi" "%WORKING_DIRECTORY%\DeploymentFiles\CarbonitePrivateVaultMSI-%FULL_BUILD_NUMBER%.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy MSI to DeploymentFiles folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<checked type='11'>0</checked>
			<command>"%SIGN_DIR%\CodeSigningToolSHA256\SignSha256Only.cmd" "%WORKING_DIRECTORY%\DeploymentFiles\CarbonitePrivateVault*.msi" "Carbonite Setup"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<description><![CDATA[
]]></description>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>3</indent>
			<name>Sign Vault MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Vault Vault Bootstrapper (branded and non-branded)</name>
		</step>
		<step action='Delete Folder'>
			<Path>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild</Path>
			<Recurse type='11'>-1</Recurse>
			<ShowCmd type='11'>-1</ShowCmd>
			<indent type='3'>3</indent>
			<name>Delete Bootstrapper build location</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapper</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Copy bootstrapper files to location to build from</name>
		</step>
		<step action='Write XML'>
			<Filename>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild\bootstrap_config.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%FULL_BUILD_NUMBER%</Text>
			<XPath>/IRBootstrapper/VersionResources/@FileVersion</XPath>
			<indent type='3'>3</indent>
			<name>Update FileVersion in bootstrap XML</name>
		</step>
		<step action='Write XML'>
			<Filename>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild\bootstrap_config.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%FULL_BUILD_NUMBER%</Text>
			<XPath>/IRBootstrapper/VersionResources/@ProductVersion</XPath>
			<indent type='3'>3</indent>
			<name>Update ProductVersion in bootstrap XML</name>
		</step>
		<step action='Write XML'>
			<Filename>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild\bootstrap_config.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\UIAssets\Application.ico</Text>
			<XPath>/IRBootstrapper/CustomIcon/@IconFile</XPath>
			<indent type='3'>3</indent>
			<name>Update App Icon in bootstrap XML</name>
		</step>
		<step action='Write XML'>
			<Filename>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild\bootstrap_config.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%VAULT_BRAND_BootstrapperEXECompany%</Text>
			<XPath>/IRBootstrapper/VersionResources/@Company</XPath>
			<indent type='3'>3</indent>
			<name>Update BootstrapperEXECompany in bootstrap XML</name>
		</step>
		<step action='Write XML'>
			<Filename>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild\bootstrap_config.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%VAULT_BRAND_BootstrapperEXEProductName%</Text>
			<XPath>/IRBootstrapper/VersionResources/@ProductName</XPath>
			<indent type='3'>3</indent>
			<name>Update BootstrapperEXEProductName in bootstrap XML</name>
		</step>
		<step action='Write XML'>
			<Filename>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild\bootstrap_config.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%VAULT_BRAND_BootstrapperEXEFileDescription%</Text>
			<XPath>/IRBootstrapper/VersionResources/@FileDescription</XPath>
			<indent type='3'>3</indent>
			<name>Update BootstrapperEXEFileDescription in bootstrap XML</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[strDir = "%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild"
strDir = Replace(strDir, "\", "\\")
vbld_TempMacros.Add "VMSIFactoryBootstrapperBuildPath", strDir
]]></Script>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Set VMSIFactoryBootstrapperBuildPath - make it have double "\"</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild\bootstrap_config.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild\bootstrap_config.xml</FileOut>
			<Find>.BOOTSTRAPPERPATH\]</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>%VMSIFactoryBootstrapperBuildPath%</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condexpr>%BRAND_MSIPASSPHRASE%</condexpr>
			<indent type='3'>3</indent>
			<name>Update Bootstrapper path into bootstrap_config.xml</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild\bootstrap_config.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild\bootstrap_config.xml</FileOut>
			<Find>C:\Users\garysu\Desktop</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Stamp location of bootstrapper lua file</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\bin\Release\en-US\VaultInstaller.msi" "%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild"</command>
			<indent type='3'>3</indent>
			<name>Copy WixInstaller to location for bootstrapper to pickup</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSQLExpress%</condexpr>
			<indent type='3'>3</indent>
			<name>Include copy SQL EXPRESS EXE needed in bootstrapper (real version) </name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild</DestDir>
			<Ext>SQLEXPR_x64_ENU.exe</Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%BUILD_DEPENDENCIES%\ForVaultBootstrapper</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcompareto>INTERNAL</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>4</indent>
			<name>copy SQL EXPRESS EXE needed in bootstrapper</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoNotIncludeSQLExpress%</condexpr>
			<indent type='3'>3</indent>
			<name>Inlude dummy SQL Express (fake version for fast track build) </name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\build\FastBuildSwitchesFile\DummyEXEThatShowsNotARealApp.exe" "%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild\SQLEXPR_x64_ENU.exe"</command>
			<indent type='3'>4</indent>
			<name>Copy dummy SQL Express</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild</DestDir>
			<Ext><![CDATA[*.exe
*.bmp]]></Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\BootstrapUi\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcompareto>INTERNAL</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>copy Bootstrapper UI helper</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"%PROGFILES%\MSI Factory\Bootstrap\IRMakeBootstrap.exe" "%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild\bootstrap_config.xml" "%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild\VaultSetup.exe"  -var:ProductName="%VAULT_BRAND_BootstrapperEXEProductName%" -var:ProductVersion="%FULL_BUILD_NUMBER%"</command>
			<indent type='3'>3</indent>
			<name>build bootstrapper</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI\MSIFactoryBootstrapperBuild\VaultSetup.exe"  "%WORKING_DIRECTORY%\DeploymentFiles\VaultInstaller-%FULL_BUILD_NUMBER%-%VAULT_BRAND_FOLDER%.EXE"</command>
			<indent type='3'>3</indent>
			<name>Copy bootstrapper to Output DeploymentFiles folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"%SIGN_DIR%\CodeSigningToolSHA256\SignSha256AndSha1.cmd" "%WORKING_DIRECTORY%\DeploymentFiles\VaultInstaller*.EXE" "Carbonite Setup"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<description><![CDATA[
]]></description>
			<failsubroutine>Exit</failsubroutine>
			<indent type='3'>3</indent>
			<name>Sign Vault install EXE</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeVaultMSIZip%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP VaultMSI layout - conditional so can be skipped for fast track build</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\CarbonitePrivateVaultMSI-%FULL_BUILD_NUMBER%.zip</Dest>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\DeploymentFiles\VaultMSI</Source>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>ZIP VaultMSI (temporary till have WiX source)</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsOutputZipFiles</MacroName>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>1</indent>
			<name>Set ToolsOutputZipFiles - need empty one for all build types</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeTools%</condexpr>
			<indent type='3'>1</indent>
			<name>Build and Obfuscate Tools - can be turned off by fast track build</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>Tools</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Minor Build Stage</SubName>
			<indent type='3'>2</indent>
			<name>Log Minor Stage - Tools</name>
		</step>
		<step action='Group'>
			<condcompareto>VAULTBRANDING</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>2</indent>
			<name>Do Tools</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsObfuscateBaseFolder</MacroName>
			<MacroValue>%WORKING_DIRECTORY%\DeploymentFiles\Tools</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>3</indent>
			<name>Set ToolsObfuscateBaseFolder</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<checked type='11'>0</checked>
			<command>cmd /c md "%ToolsObfuscateBaseFolder%"</command>
			<indent type='3'>3</indent>
			<name>Base DeploymentFiles\Tools folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<indent type='3'>3</indent>
			<name>Obfuscate with Dotfuscator</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LoopToolsObfuscateFolderNumber</MacroName>
			<MacroValue>0</MacroValue>
			<condcompareto>True</condcompareto>
			<indent type='3'>4</indent>
			<name>Set LoopToolsObfuscateFolderNumber to 0</name>
		</step>
		<step action='Set Macro'>
			<MacroName>MaxToolsObfuscateFolderNumber</MacroName>
			<MacroValue>%READ_INI(%DOTFUSCATOR_VAULT_OBFUSCATE_INI%,General,ToolFolderCount,0)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>4</indent>
			<name>Read MaxToolsObfuscateFolderNumber from ini</name>
		</step>
		<step action='Group'>
			<condcompareto>%LoopToolsObfuscateFolderNumber%</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%MaxToolsObfuscateFolderNumber%</condexpr>
			<condrepeat type='11'>-1</condrepeat>
			<indent type='3'>4</indent>
			<name>Obfuscate folder loop</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LoopToolsObfuscateFolderNumber</MacroName>
			<MacroValue>[%LoopToolsObfuscateFolderNumber%+1]</MacroValue>
			<indent type='3'>5</indent>
			<name>Increment LoopToolsObfuscateFolderNumber Counter</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsObfuscateIncludeInBuild</MacroName>
			<MacroValue>%READ_INI(%DOTFUSCATOR_VAULT_OBFUSCATE_INI%,Tool%LoopToolsObfuscateFolderNumber%,IncludeInBuild,0)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Set ToolsObfuscateIncludeInBuild</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsObfuscateIncludeInBuild</MacroName>
			<MacroValue>%READ_INI(%DOTFUSCATOR_VAULT_OBFUSCATE_INI%,Tool%LoopToolsObfuscateFolderNumber%,IncludeInCIBuild,0)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Override ToolsObfuscateIncludeInBuild if not NIGTHLY build</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsObfuscateFolder</MacroName>
			<MacroValue>%READ_INI(%DOTFUSCATOR_VAULT_OBFUSCATE_INI%,Tool%LoopToolsObfuscateFolderNumber%,Folder,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Set ToolsObfuscateFolder</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsObfuscateZipBaseName</MacroName>
			<MacroValue>%READ_INI(%DOTFUSCATOR_VAULT_OBFUSCATE_INI%,Tool%LoopToolsObfuscateFolderNumber%,ZipBaseName,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Set ToolsObfuscateZipBaseName</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsObfuscateWorkingFolder</MacroName>
			<MacroValue>%READ_INI(%DOTFUSCATOR_VAULT_OBFUSCATE_INI%,Tool%LoopToolsObfuscateFolderNumber%,WorkingFolder,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Set ToolsObfuscateWorkingFolder</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsObfuscatePrivate</MacroName>
			<MacroValue>%READ_INI(%DOTFUSCATOR_VAULT_OBFUSCATE_INI%,Tool%LoopToolsObfuscateFolderNumber%,Private,1)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Set ToolsObfuscatePrivate</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsObfuscatePackageOnlyAndDoNotObfuscate</MacroName>
			<MacroValue>%READ_INI(%DOTFUSCATOR_VAULT_OBFUSCATE_INI%,Tool%LoopToolsObfuscateFolderNumber%,PackageOnlyAndDoNotObfuscate,0)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Set ToolsObfuscatePackageOnlyAndDoNotObfuscate</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsObfuscateAppConfigSourceFilename</MacroName>
			<MacroValue>%READ_INI(%DOTFUSCATOR_VAULT_OBFUSCATE_INI%,Tool%LoopToolsObfuscateFolderNumber%,AppConfigSourceFilename,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Set ToolsObfuscateAppConfigSourceFilename</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsObfuscateAppConfigTargetFilename</MacroName>
			<MacroValue>%READ_INI(%DOTFUSCATOR_VAULT_OBFUSCATE_INI%,Tool%LoopToolsObfuscateFolderNumber%,AppConfigTargetFilename,NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>5</indent>
			<name>Set ToolsObfuscateAppConfigTargetFilename</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[strFiles = "%READ_INI(%DOTFUSCATOR_VAULT_OBFUSCATE_INI%,Tool%LoopToolsObfuscateFolderNumber%,ExtensionsToIncludeInZip,NOTSET)%"
strFiles = Replace(strFiles, "NOTSET", "")
strFiles = Replace(strFiles, ";", vbCrLf)
vbld_TempMacros.Add "ToolsObfuscateExtensionsToIncludeInZip", strFiles
]]></Script>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>5</indent>
			<name>Set ToolsObfuscateExtensionsToIncludeInZip from ini</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%ToolsObfuscateIncludeInBuild%</condexpr>
			<indent type='3'>5</indent>
			<name>If IncludeInBuild</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsObfuscateWorkingFolderCurrent</MacroName>
			<MacroValue>%ToolsObfuscateBaseFolder%\%ToolsObfuscateWorkingFolder%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>6</indent>
			<name>Set ToolsObfuscateWorkingFolderCurrent</name>
		</step>
		<step action='Delete Folder'>
			<Path>%ToolsObfuscateWorkingFolderCurrent%</Path>
			<Recurse type='11'>-1</Recurse>
			<ShowCmd type='11'>-1</ShowCmd>
			<indent type='3'>6</indent>
			<name>Delete ToolsObfuscateWorkingFolderCurrent</name>
		</step>
		<step action='Create Folder'>
			<Path>%ToolsObfuscateWorkingFolderCurrent%</Path>
			<indent type='3'>6</indent>
			<name>Create ToolsObfuscateWorkingFolderCurrent</name>
		</step>
		<step action='Create Folder'>
			<Path>%ToolsObfuscateWorkingFolderCurrent%\Obfuscated</Path>
			<indent type='3'>6</indent>
			<name>Create ToolsObfuscateWorkingFolderCurrent\Obfuscated</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%ToolsObfuscateWorkingFolderCurrent%</DestDir>
			<Ext><![CDATA[*.*
]]></Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\%ToolsObfuscateFolder%</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>6</indent>
			<name>Copy files to ToolsObfuscateWorkingFolderCurrent</name>
		</step>
		<step action='Group'>
			<indent type='3'>6</indent>
			<name>Copy any files specified via CopyFileN operations</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LoopToolsObfuscateCopyFileNumber</MacroName>
			<MacroValue>0</MacroValue>
			<condcompareto>True</condcompareto>
			<indent type='3'>7</indent>
			<name>Set LoopToolsObfuscateCopyFileNumber to 0</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsObfuscateCopySourceFile</MacroName>
			<MacroValue>SetToDummy</MacroValue>
			<condcompareto>True</condcompareto>
			<indent type='3'>7</indent>
			<name>Set ToolsObfuscateCopySourceFile to initial value</name>
		</step>
		<step action='Group'>
			<condcompareto>NOTSET</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%ToolsObfuscateCopySourceFile%</condexpr>
			<condrepeat type='11'>-1</condrepeat>
			<indent type='3'>7</indent>
			<name>Rename file loop</name>
		</step>
		<step action='Set Macro'>
			<MacroName>LoopToolsObfuscateCopyFileNumber</MacroName>
			<MacroValue>[%LoopToolsObfuscateCopyFileNumber%+1]</MacroValue>
			<indent type='3'>8</indent>
			<name>Increment LoopToolsObfuscateCopyFileNumber Counter</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[strCmd = "%READ_INI(%DOTFUSCATOR_VAULT_OBFUSCATE_INI%,Tool%LoopToolsObfuscateFolderNumber%,CopySourceFile%LoopToolsObfuscateCopyFileNumber%,NOTSET)%"
vbld_TempMacros.Add "ToolsObfuscateCopySourceFile", strCmd
strCmd = "%READ_INI(%DOTFUSCATOR_VAULT_OBFUSCATE_INI%,Tool%LoopToolsObfuscateFolderNumber%,CopyTargetFile%LoopToolsObfuscateCopyFileNumber%,NOTSET)%"
vbld_TempMacros.Add "ToolsObfuscateCopyTargetFile", strCmd
]]></Script>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>8</indent>
			<name>Set ToolsObfuscateCopySourceFile and ToolsObfuscateCopyTargetFile from ini</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy /Y "%ToolsObfuscateCopySourceFile%" "%ToolsObfuscateCopyTargetFile%"</command>
			<condcompareto>NOTSET</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%ToolsObfuscateCopySourceFile%</condexpr>
			<indent type='3'>8</indent>
			<name>Overwrite files if set</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%ToolsObfuscateWorkingFolderCurrent%</startin>
		</step>
		<step action='Group'>
			<condcompareto>1</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotObfuscateTools%</condexpr>
			<indent type='3'>6</indent>
			<name>Do the obfuscation - global build setting</name>
		</step>
		<step action='Group'>
			<condcompareto>1</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%ToolsObfuscatePackageOnlyAndDoNotObfuscate%</condexpr>
			<indent type='3'>7</indent>
			<name>Do the obfuscation - local setting per tool</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\DotfuscatorTemplate.xml" "%ToolsObfuscateWorkingFolderCurrent%\DotfuscatorTools.xml"</command>
			<indent type='3'>8</indent>
			<name>Copy template Dotfuscator project file to obfuscation working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%ToolsObfuscateWorkingFolderCurrent%</DestDir>
			<Ext>datacastle_dashboard.snk</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Datacastle.Dashboard\</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>8</indent>
			<name>Copy Datacastle Dashboard SNK File</name>
		</step>
		<step action='Run Program'>
			<command>"dotfuscator.exe" /q "DotfuscatorTools.xml" </command>
			<indent type='3'>8</indent>
			<name>Run Dotfuscator to obfuscate</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%ToolsObfuscateWorkingFolderCurrent%</startin>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%ToolsObfuscateWorkingFolderCurrent%</DestDir>
			<ExclExt>*.snk</ExclExt>
			<Ext><![CDATA[*.*
]]></Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%ToolsObfuscateWorkingFolderCurrent%\Obfuscated\%ToolsObfuscateWorkingFolder%</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>8</indent>
			<name>Copy obfuscated tools files back</name>
		</step>
		<step action='Delete Folder'>
			<Path>%ToolsObfuscateWorkingFolderCurrent%\Obfuscated</Path>
			<Recurse type='11'>-1</Recurse>
			<ShowCmd type='11'>-1</ShowCmd>
			<indent type='3'>6</indent>
			<name>Delete ToolsObfuscateWorkingFolderCurrent\Obfuscated</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsObfuscateZipBaseNameCalc</MacroName>
			<MacroValue>%ToolsObfuscateZipBaseName%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>6</indent>
			<name>Set ToolsObfuscateZipBaseNameCalc</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsObfuscateZipBaseNameCalc</MacroName>
			<MacroValue>Private%ToolsObfuscateZipBaseNameCalc%</MacroValue>
			<condcompareto>1</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%ToolsObfuscatePrivate%</condexpr>
			<indent type='3'>6</indent>
			<name>Prepend Private to ToolsObfuscateZipBaseNameCalc if Private set </name>
		</step>
		<step action='Enhanced Zip Files'>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\%ToolsObfuscateZipBaseNameCalc%-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext>%ToolsObfuscateExtensionsToIncludeInZip%</Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%ToolsObfuscateWorkingFolderCurrent%</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>6</indent>
			<name>ZIP tool ready to copy to build output</name>
		</step>
		<step action='Set Macro'>
			<MacroName>ToolsOutputZipFiles</MacroName>
			<MacroValue><![CDATA[%ToolsOutputZipFiles%
%ToolsObfuscateZipBaseNameCalc%-%FULL_BUILD_NUMBER%.zip]]></MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>6</indent>
			<name>Add this zip to ToolsOutputZipFiles</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeAzure%</condexpr>
			<indent type='3'>1</indent>
			<name>Azure package</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>Azure Package</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Minor Build Stage</SubName>
			<indent type='3'>2</indent>
			<name>Log Minor Stage - Azure Package</name>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Only do Azure if non vault brand build</name>
		</step>
		<step action='Set Macro'>
			<MacroName>AZURE_LOOP_UBOUND_VNEXT</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Core\Server\CloudService\AzureBuild.ini, AzureBuild, Number, 0)%</MacroValue>
			<description><![CDATA[Reads the Number of Azure Packages to build from AzureBuild.ini
Defaults to 1 if AzureBuild.ini does not exist.]]></description>
			<indent type='3'>3</indent>
			<name>Read Number of Azure Packages</name>
		</step>
		<step action='Group'>
			<condcompareto>0</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>AZURE_LOOP_UBOUND_VNEXT</condexpr>
			<indent type='3'>3</indent>
			<name>If AzureBuild.ini doesn't exist</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Core\Server\CloudWebApp</DestDir>
			<Ext><![CDATA[DashboardManager*.EXE
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Tools\DashboardManager\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy DashboardManager to CloudWebApp</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Core\Server\CloudWebApp\WebCloudRelease.config" "%WORKING_DIRECTORY%\Core\Server\CloudWebApp\Web.config"</command>
			<indent type='3'>4</indent>
			<name>Copy CloudWebApp WebCloudRelease.config to Web.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command><![CDATA["C:\Program Files\Microsoft SDKs\Azure\.NET SDK\v2.9\bin\cspack.exe" "CloudService\ServiceDefinition-Release.csdef" "/out:CloudService\AzureReleasePackage-%FULL_BUILD_NUMBER%.cspkg"
]]></command>
			<condcompareto>True</condcompareto>
			<condexpr>%BRAND_SIGNED_FLAG%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[
]]></description>
			<indent type='3'>4</indent>
			<name>Build Azure package</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Core\Server</startin>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles</DestDir>
			<Ext>AzureReleasePackage*.cspkg</Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\CloudService</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy Azure package to output</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Core\Server\CloudService\ServiceConfiguration-Release.cscfg" "%WORKING_DIRECTORY%\DeploymentFiles\AzureReleaseConfigurationTemplate-%FULL_BUILD_NUMBER%.cscfg"</command>
			<indent type='3'>4</indent>
			<name>Copy Azure release config template to output</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\</DestDir>
			<Ext>ServiceDefinition-Release.csdef</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\CloudService\</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy ServiceDefinition-Release.csdef to deployment</name>
		</step>
		<step action='Group'>
			<condcompareto>0</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>AZURE_LOOP_UBOUND_VNEXT</condexpr>
			<indent type='3'>3</indent>
			<name>If AzureBuild.ini does exist</name>
		</step>
		<step action='Set Macro'>
			<MacroName>AZURE_LOOP_COUNT_VNEXT</MacroName>
			<MacroValue>0</MacroValue>
			<description>Initialize a counter macro value</description>
			<indent type='3'>4</indent>
			<name>Initialize Counter</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Core\Server\CloudService\Template</DestDir>
			<Ext>ServiceDefinition-Release.csdef</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\CloudService\</SourceDir>
			<TBD type='11'>-1</TBD>
			<description>copy over the original csdef so we always work with this one before messing around with it</description>
			<indent type='3'>4</indent>
			<name>Copy ServiceDefinition-Release.csdef to ServiceDefinition-ReleaseTemplate.csdef</name>
		</step>
		<step action='Group'>
			<condcompareto>%AZURE_LOOP_COUNT_VNEXT%</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%AZURE_LOOP_UBOUND_VNEXT%</condexpr>
			<condrepeat type='11'>-1</condrepeat>
			<indent type='3'>4</indent>
			<name>Build Installer Loop</name>
		</step>
		<step action='Group'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>5</indent>
			<name>Read Azure build vars from ini</name>
		</step>
		<step action='Set Macro'>
			<MacroName>AZURE_BUILD_VMSIZE</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\Core\Server\CloudService\AzureBuild.ini, Azure%AZURE_LOOP_COUNT_VNEXT%, vmsize, NOTSET)%</MacroValue>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>6</indent>
			<name>Read AZURE_BUILD_VMSIZE</name>
		</step>
		<step action='Delete Files'>
			<Ext>ServiceDefinition-Release*.csdef</Ext>
			<LogDel type='11'>-1</LogDel>
			<Path>%WORKING_DIRECTORY%\Core\Server\CloudService\</Path>
			<buildfailsteps type='11'>0</buildfailsteps>
			<description>delete the (potentially altered from previous loop) csdef</description>
			<indent type='3'>5</indent>
			<name>Delete ServiceDefinition-Release.csdef</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Core\Server\CloudService\</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>ServiceDefinition-Release.csdef</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\CloudService\Template</SourceDir>
			<TBD type='11'>-1</TBD>
			<description>copy the original csdef to alter</description>
			<indent type='3'>5</indent>
			<name>Copy ServiceDefinition-ReleaseTemplate.csdef to ServiceDefinition-Release.csdef</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Core\Server\CloudService\ServiceDefinition-Release.csdef</FileIn>
			<FileOut>%WORKING_DIRECTORY%\Core\Server\CloudService\ServiceDefinition-Release.csdef</FileOut>
			<Find>vmsize\s*=\s*\".+\"</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace>vmsize=\"%AZURE_BUILD_VMSIZE%\"</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<description><![CDATA[replacing vmsize in:  <WebRole name="CloudWebApp" vmsize="Small">
]]></description>
			<indent type='3'>5</indent>
			<name>Stamp VMSize into ServiceDefinition-Release.csdef</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Core\Server\CloudWebApp</DestDir>
			<Ext><![CDATA[DashboardManager*.EXE
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Tools\DashboardManager\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>5</indent>
			<name>Copy DashboardManager to CloudWebApp</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Core\Server\CloudWebApp\WebCloudRelease.config" "%WORKING_DIRECTORY%\Core\Server\CloudWebApp\Web.config"</command>
			<indent type='3'>5</indent>
			<name>Copy CloudWebApp WebCloudRelease.config to Web.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command><![CDATA["C:\Program Files\Microsoft SDKs\Azure\.NET SDK\v2.9\bin\cspack.exe" "CloudService\ServiceDefinition-Release.csdef" "/out:CloudService\AzureReleasePackage-%FULL_BUILD_NUMBER%-%AZURE_BUILD_VMSIZE%.cspkg"
]]></command>
			<condcompareto>True</condcompareto>
			<condexpr>%BRAND_SIGNED_FLAG%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[
]]></description>
			<indent type='3'>5</indent>
			<name>Build Azure package</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Core\Server</startin>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles</DestDir>
			<Ext>AzureReleasePackage*.cspkg</Ext>
			<FailNone type='11'>-1</FailNone>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\CloudService</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>5</indent>
			<name>Copy Azure package to output</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Core\Server\CloudService\ServiceConfiguration-Release.cscfg" "%WORKING_DIRECTORY%\DeploymentFiles\AzureReleaseConfigurationTemplate-%FULL_BUILD_NUMBER%.cscfg"</command>
			<indent type='3'>5</indent>
			<name>Copy Azure release config template to output</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Rename Files'>
			<Dir>%WORKING_DIRECTORY%\Core\Server\CloudService\</Dir>
			<Ext>ServiceDefinition-Release.csdef</Ext>
			<Find>ServiceDefinition-Release.csdef</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<LogRenamed type='11'>-1</LogRenamed>
			<Replace>ServiceDefinition-Release-%AZURE_BUILD_VMSIZE%.csdef</Replace>
			<indent type='3'>5</indent>
			<name>Rename ServiceDefinition-Release.csdef to ServiceDefiniton-Release-%VMSIZE%.csdef</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\</DestDir>
			<Ext>ServiceDefinition-Release-*.csdef</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\CloudService\</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>5</indent>
			<name>Copy VM Specific ServiceDefinition-Release.csdef to deployment</name>
		</step>
		<step action='Set Macro'>
			<MacroName>AZURE_LOOP_COUNT_VNEXT</MacroName>
			<MacroValue>[%AZURE_LOOP_COUNT_VNEXT%+1]</MacroValue>
			<description>Initialize a counter macro value</description>
			<indent type='3'>5</indent>
			<name>Increment Azure Counter</name>
		</step>
		<step action='Delete Files'>
			<Ext>ServiceDefinition-Release*.csdef</Ext>
			<LogDel type='11'>-1</LogDel>
			<Path>%WORKING_DIRECTORY%\Core\Server\CloudService\</Path>
			<buildfailsteps type='11'>0</buildfailsteps>
			<description>delete the (potentially altered from previous loop) csdef</description>
			<indent type='3'>4</indent>
			<name>Delete ServiceDefinition-Release.csdef</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Core\Server\CloudService\</DestDir>
			<Ext>ServiceDefinition-Release.csdef</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\CloudService\Template</SourceDir>
			<TBD type='11'>-1</TBD>
			<description>restore original ServiceDefinition-Release.csdef</description>
			<indent type='3'>4</indent>
			<name>Copy ServiceDefinition-ReleaseTemplate.csdef to ServiceDefinition-Release.csdef</name>
		</step>
		<step action='Delete Files'>
			<Ext>*.*</Ext>
			<LogDel type='11'>-1</LogDel>
			<Path>%WORKING_DIRECTORY%\Core\Server\CloudService\Template</Path>
			<buildfailsteps type='11'>0</buildfailsteps>
			<description>delete the (potentially altered from previous loop) csdef</description>
			<indent type='3'>4</indent>
			<name>Delete ServiceDefinition-ReleaseTemplate.csdef</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeAzure%</condexpr>
			<indent type='3'>1</indent>
			<name>AzureRM NuGet packages</name>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>AzureRM Vault package</name>
		</step>
		<step action='Group'>
			<indent type='3'>3</indent>
			<name>Setup AppService wwwroot</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\wwwroot</DestDir>
			<Empty type='11'>-1</Empty>
			<ExclExt><![CDATA[*.cs
*.config
7z.*
*csproj*
]]></ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\CloudWebApp</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy CloudWebApp</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\wwwroot</DestDir>
			<Ext><![CDATA[DashboardManager*.EXE
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Tools\DashboardManager\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy DashboardManager to CloudWebApp</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Core\Server\CloudWebApp\WebAzureRMRelease.config" "%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\wwwroot\web.config""</command>
			<indent type='3'>4</indent>
			<name>Copy WebAzureRMRelease.config to web.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Core\Server\CloudWebApp\Access\Web.config" "%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\wwwroot\Access\web.config""</command>
			<indent type='3'>4</indent>
			<name>Copy access/web.config to access/web.config</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<indent type='3'>3</indent>
			<name>Setup BlockManagementService</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\wwwroot\App_Data\jobs\continuous\VaultManagementService</DestDir>
			<Empty type='11'>-1</Empty>
			<ExclExt><![CDATA[startup.cmd
]]></ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Datacastle.Server.BlockManagementService\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy VaultManagementService (BlockManagementService) binaries</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\wwwroot\App_Data\jobs\continuous\VaultManagementService</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>LaunchVaultManagementService.bat</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Datacastle.Server.BlockManagementService</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy LaunchVaultManagementService.bat</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\wwwroot\App_Data\jobs\continuous\VaultManagementService</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>Datacastle.Server.BlockManagementService.exe.config</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\CloudWebApp</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>4</indent>
			<name>Copy correct BlockManagementService configuration file</name>
		</step>
		<step action='Group'>
			<indent type='3'>3</indent>
			<name>Setup db files</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c md "%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\db</command>
			<indent type='3'>4</indent>
			<name>Create db folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\DCDashboardUpgrade.sql" "%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\db\UpdateDashboard.sql"</command>
			<indent type='3'>4</indent>
			<name>Dashboard Update SQL File - Deployment </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\DCVaultUpgrade.sql" "%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\db\UpdateVault.sql"</command>
			<indent type='3'>4</indent>
			<name>Vault Update SQL File - Deployment </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\CEPVaultUpgrade.sql" "%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\db\CEPUpdateVault.sql"</command>
			<indent type='3'>4</indent>
			<name>Combined CEP Vault Update SQL File - Deployment </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\CEPUpdateVersionNumber.sql" "%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\db\CEPUpdateVersionNumber.sql"</command>
			<indent type='3'>4</indent>
			<name>Set DB Version Number Script</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Core\Database\DatacastleDb\sql\release\DeployDatabase.sql" "%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\db\DeployDatacastleDatabase.sql"</command>
			<indent type='3'>4</indent>
			<name>DCVault SQL File - Deployment </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Core\Database\DashboardDb\sql\release\DeployDashboard.sql" "%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\db\DeployDashboardDatabase.sql"</command>
			<indent type='3'>4</indent>
			<name>Dashboard SQL File - Deployment </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\db\DeployDashboardDatabase.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\db\DeployDashboardDatabase.sql</FileOut>
			<Find>\sCREATE\sSCHEMA.*Operations.*\r\n.*AUTH.*;</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace><![CDATA[
if NOT EXISTS \(select 1 from sys.schemas where name = N'Operations'\)
	EXECUTE sp_executesql N'CREATE SCHEMA [[Operations]] AUTHORIZATION [[dbo]];'
]]></Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>4</indent>
			<name>poke DB script to fix CREATE SCHEMA issue in Dashboard</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\db\DeployDatacastleDatabase.sql</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\db\DeployDatacastleDatabase.sql</FileOut>
			<Find>\sCREATE\sSCHEMA.*Operations.*\r\n.*AUTH.*;</Find>
			<NoModS type='11'>-1</NoModS>
			<Replace><![CDATA[
if NOT EXISTS \(select 1 from sys.schemas where name = N'Operations'\)
	EXECUTE sp_executesql N'CREATE SCHEMA [[Operations]] AUTHORIZATION [[dbo]];'
]]></Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<indent type='3'>4</indent>
			<name>poke DB script to fix CREATE SCHEMA issue in Datacastle</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\buildinfo</DestDir>
			<Ext><![CDATA[BuildVars.wxi
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\VaultInstaller\VaultMSI</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy BuildVars.wxi for DB version information</name>
		</step>
		<step action='Group'>
			<indent type='3'>3</indent>
			<name>Generate NuGet package</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\build\template.nuspec" "%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\Vault.nuspec"</command>
			<indent type='3'>4</indent>
			<name>Copy NuGet nuspec file </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\Vault.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\Vault.nuspec</FileOut>
			<Find>REPLACE_ID</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace>Vault</Replace>
			<indent type='3'>4</indent>
			<name>Set NuGet package Id</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\Vault.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\Vault.nuspec</FileOut>
			<Find>REPLACE_VERSION</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace>%FULL_BUILD_NUMBER%</Replace>
			<indent type='3'>4</indent>
			<name>Set NuGet package version</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\Vault.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\Vault.nuspec</FileOut>
			<Find>REPLACE_TITLE</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace>Carbonite Vault and Azure DevOps Tools Package</Replace>
			<indent type='3'>4</indent>
			<name>Set NuGet package title</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\Vault.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\Vault.nuspec</FileOut>
			<Find>REPLACE_DESCRIPTION</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace>Vault and Azure DevOps Tools NuGet Package %FULL_BUILD_NUMBER% created by build process on %BUILD_DATE%.</Replace>
			<indent type='3'>4</indent>
			<name>Set NuGet package description</name>
		</step>
		<step action='Run Program'>
			<command>nuget.exe pack %WORKING_DIRECTORY%\DeploymentFiles\NuGetVault\Vault.nuspec -OutputDirectory %WORKING_DIRECTORY%\DeploymentFiles</command>
			<description>Package up Nuget</description>
			<indent type='3'>4</indent>
			<name>NuGet pack vault - warnings are okay</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Azure DevOps pipeline package</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\AzureDevOpsTools\pipeline</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\AzureAppServiceDeployment\pipeline</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Setup Azure DevOps tools (pipeline)</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\AzureDevOpsTools\deploy</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\AzureAppServiceDeployment\deploy</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Setup Azure DevOps tools (vault)</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\AzureDevOpsTools\common-scripts</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\AzureAppServiceDeployment\common-scripts</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Setup Azure DevOps tools common scripts (for both pipeline and vault)</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\AzureDevOpsTools\pipeline\templates\VaultDeploymentPipeline.json</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\AzureDevOpsTools\pipeline\templates\VaultDeploymentPipeline.json</FileOut>
			<Find>@VAULTCODEVERSION@</Find>
			<Literal type='11'>-1</Literal>
			<Replace>%FULL_BUILD_NUMBER%</Replace>
			<indent type='3'>3</indent>
			<name>Replace @VAULTCODEVERSION@ with current version: VaultDeploymentPipeline.json</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\DeploymentHelper</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\MiscInternalTools\DeployAzureVault\DeploymentHelper\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Setup DeploymentHelper</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\build\template.nuspec" "%WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\Pipeline.nuspec"</command>
			<indent type='3'>3</indent>
			<name>Copy NuGet nuspec file </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\Pipeline.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\Pipeline.nuspec</FileOut>
			<Find>REPLACE_ID</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace>Pipeline</Replace>
			<indent type='3'>3</indent>
			<name>Set NuGet package Id</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\Pipeline.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\Pipeline.nuspec</FileOut>
			<Find>REPLACE_VERSION</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace>%FULL_BUILD_NUMBER%</Replace>
			<indent type='3'>3</indent>
			<name>Set NuGet package version</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\Pipeline.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\Pipeline.nuspec</FileOut>
			<Find>REPLACE_TITLE</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace>Carbonite Azure DevOps Pipeline Code and Templates Package</Replace>
			<indent type='3'>3</indent>
			<name>Set NuGet package title</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\Pipeline.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\Pipeline.nuspec</FileOut>
			<Find>REPLACE_DESCRIPTION</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace> Carbonite Azure DevOps Code and Templates packages processed on %BUILD_DATE%.</Replace>
			<indent type='3'>3</indent>
			<name>Set NuGet package description</name>
		</step>
		<step action='Run Program'>
			<command>nuget.exe pack %WORKING_DIRECTORY%\DeploymentFiles\NuGetPipeline\Pipeline.nuspec -OutputDirectory %WORKING_DIRECTORY%\DeploymentFiles</command>
			<description>Package up Nuget</description>
			<indent type='3'>3</indent>
			<name>NuGet pack pipeline - warnings are okay</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>AzureRM Promotion package</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPromotion\promotion</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>PromotePackages.ps1</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\AzureAppServiceDeployment\pipeline\scripts</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Get PromotePackages.ps1</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPromotion\promotion</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>PromotionPipelineTemplate.json</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\AzureAppServiceDeployment\pipeline\templates</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Get PromotionPipelineTemplate.json</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\build\template.nuspec" "%WORKING_DIRECTORY%\DeploymentFiles\NuGetPromotion\Promotion.nuspec"</command>
			<indent type='3'>3</indent>
			<name>Copy NuGet nuspec file </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPromotion\Promotion.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPromotion\Promotion.nuspec</FileOut>
			<Find>REPLACE_ID</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace>Promotion</Replace>
			<indent type='3'>3</indent>
			<name>Set NuGet package Id</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPromotion\Promotion.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPromotion\Promotion.nuspec</FileOut>
			<Find>REPLACE_VERSION</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace>%FULL_BUILD_NUMBER%</Replace>
			<indent type='3'>3</indent>
			<name>Set NuGet package version</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPromotion\Promotion.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPromotion\Promotion.nuspec</FileOut>
			<Find>REPLACE_TITLE</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace>Carbonite Azure DevOps Promotion Package</Replace>
			<indent type='3'>3</indent>
			<name>Set NuGet package title</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPromotion\Promotion.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetPromotion\Promotion.nuspec</FileOut>
			<Find>REPLACE_DESCRIPTION</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace> Carbonite Azure DevOps Promotion package processed on %BUILD_DATE%.</Replace>
			<indent type='3'>3</indent>
			<name>Set NuGet package description</name>
		</step>
		<step action='Run Program'>
			<command>nuget.exe pack %WORKING_DIRECTORY%\DeploymentFiles\NuGetPromotion\Promotion.nuspec -OutputDirectory %WORKING_DIRECTORY%\DeploymentFiles</command>
			<description>Package up Nuget</description>
			<indent type='3'>3</indent>
			<name>NuGet pack pipeline - warnings are okay</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Carbonite AzureRM DevOps Tools package</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\DeploymentManager</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext><![CDATA[Carbonite.Dashboard.dll
Carbonite.Dashboard.XmlSerializers.dll
Carbonite.Foundation.dll
Carbonite.Vault.Foundation.dll
DCCommon.Infrastructure.dll
DCCommon.Installation.dll
DCCommon.Messaging.dll
DeploymentManager.exe
Mono.Posix.dll
EmailTemplates\*.*
BrandingImages\*.*
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\DeploymentManager\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>DeploymentManager</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\Deployment\Server\DeploymentManager\DeploymentManager.azure.config" "%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\DeploymentManager\DeploymentManager.exe.config"</command>
			<indent type='3'>3</indent>
			<name>Copy DeploymentManager Azure configuration file</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\LogViewer</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext><![CDATA[DCCommon.Infrastructure.dll
DCCommon.Messaging.dll
LogViewer.exe
LogViewer.exe.config
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\MiscInternalTools\LogViewer\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>LogViewer</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\MiscInternalTools\LogViewer\LogViewer.azure.config" "%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\LogViewer\LogViewer.exe.config"</command>
			<indent type='3'>3</indent>
			<name>Copy LogViewer Azure configuration file</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\TopologyManager</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext><![CDATA[*.dll
Newtonsoft.Json.xml
TopologyManager.exe
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\MiscInternalTools\TopologyManager\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>TopologyManager</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\MiscInternalTools\TopologyManager\TopologyManager.azure.config" "%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\TopologyManager\TopologyManager.exe.config"</command>
			<indent type='3'>3</indent>
			<name>Copy TopologyManager Azure configuration file</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\scripts</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Deployment\Server\AzureAppServiceDeployment\operations</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Operations script files</name>
		</step>
		<step action='Run Program'>
			<command>cmd /c copy /Y "%WORKING_DIRECTORY%\build\template.nuspec" "%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\VaultDevOpsTools.nuspec"</command>
			<indent type='3'>3</indent>
			<name>Copy NuGet nuspec file </name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\VaultDevOpsTools.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\VaultDevOpsTools.nuspec</FileOut>
			<Find>REPLACE_ID</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace>Vault.DevOpsTools</Replace>
			<indent type='3'>3</indent>
			<name>Set NuGet package Id</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\VaultDevOpsTools.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\VaultDevOpsTools.nuspec</FileOut>
			<Find>REPLACE_VERSION</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace>%FULL_BUILD_NUMBER%</Replace>
			<indent type='3'>3</indent>
			<name>Set NuGet package version</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\VaultDevOpsTools.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\VaultDevOpsTools.nuspec</FileOut>
			<Find>REPLACE_TITLE</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace>Carbonite Vault DevOps Tools Package</Replace>
			<indent type='3'>3</indent>
			<name>Set NuGet package title</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\VaultDevOpsTools.nuspec</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\VaultDevOpsTools.nuspec</FileOut>
			<Find>REPLACE_DESCRIPTION</Find>
			<FirstOnly type='11'>-1</FirstOnly>
			<Literal type='11'>-1</Literal>
			<Replace>Carbonite Vault DevOps Tools package processed on %BUILD_DATE%.</Replace>
			<indent type='3'>3</indent>
			<name>Set NuGet package description</name>
		</step>
		<step action='Run Program'>
			<command>nuget.exe pack %WORKING_DIRECTORY%\DeploymentFiles\NuGetDevOpsTools\VaultDevOpsTools.nuspec -OutputDirectory %WORKING_DIRECTORY%\DeploymentFiles</command>
			<description>Package up Nuget</description>
			<indent type='3'>3</indent>
			<name>NuGet pack DevOpsTools - warnings are okay</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoIncludeDebugBinariesPDBs%</condexpr>
			<indent type='3'>1</indent>
			<name>Build Debug Binaries and PDBs</name>
		</step>
		<step action='Make VS.NET'>
			<AssemblyVer type='11'>-1</AssemblyVer>
			<Config>Debug|Any CPU</Config>
			<FileVer type='11'>-1</FileVer>
			<Filename>%WORKING_DIRECTORY%\Core.sln</Filename>
			<Location>%PROGFILES%\Microsoft Visual Studio\2017\Enterprise\MSBuild\15.0\Bin\msbuild.exe</Location>
			<LogLevel type='3'>2</LogLevel>
			<Options>/flp:logfile=%LOGFILE%;Append;Summary;Verbosity=minimal; /maxcpucount:%NUMBER_OF_PROCESSORS% /nr:false   /nologo /consoleloggerparameters:ErrorsOnly;Summary;</Options>
			<ParseOutput type='11'>-1</ParseOutput>
			<ProdVer type='11'>-1</ProdVer>
			<Property1>%COMPANY_NAME%</Property1>
			<Property3>%COPYRIGHT%</Property3>
			<Property5>%PRODUCT_NAME%</Property5>
			<PropertyOn1 type='11'>-1</PropertyOn1>
			<PropertyOn3 type='11'>-1</PropertyOn3>
			<PropertyOn5 type='11'>-1</PropertyOn5>
			<ShowCmd type='11'>-1</ShowCmd>
			<Version>%RELEASE_VERSION%.%BUILD_VERSION%</Version>
			<VersionSel type='3'>2</VersionSel>
			<indent type='3'>2</indent>
			<name>Make VS: Build Solution (Debug)</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivatePDBBinariesClient-Debug-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.dll
*.exe
*.pdb
]]></Ext>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%/Core/Client/ProtectionService/bin/Debug</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP Client ProtectionService PDBs/DLLs for Backup</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivatePDBBinariesClient-Debug-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.dll
*.exe
*.pdb
]]></Ext>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%/Core/Client/ProtectionStatusService/bin/Debug</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP Client ProtectionStatusService PDBs/DLLs for Backup</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivatePDBBinariesClient-Debug-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.dll
*.exe
*.pdb
]]></Ext>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%/Core/Client/DCProtect/bin/Debug</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP Client DCProtect PDBs/DLLs for Backup</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivatePDBBinariesClient-Debug-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.dll
*.exe
*.pdb
]]></Ext>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%/Core/Client/DCNotifier/bin/Debug</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%DoPDBs%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP Client Notifier PDBs/DLLs for Backup</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\PrivateSource\PrivatePDBBinariesQuickCache-Debug-%FULL_BUILD_NUMBER%.zip</Dest>
			<Ext><![CDATA[*.dll
*.exe
*.pdb
]]></Ext>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%/Core/Server/Datacastle.RDN/Datatcastle.RDNService/bin/Debug</Source>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeQuickCache%</condexpr>
			<indent type='3'>2</indent>
			<name>ZIP QuickCache PDBs/DLLs for Backup</name>
		</step>
		<step action='Group'>
			<description>Save the setup and msi files generated from this build</description>
			<indent type='3'>1</indent>
			<name>Save Builds and Deployment Files </name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>Save Build Output</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Major Build Stage</SubName>
			<indent type='3'>2</indent>
			<name>Log Major Build Stage - Save Build Output</name>
		</step>
		<step action='Delete Folder'>
			<Path>%BUILDOUTPUT_PRIVATE%</Path>
			<Recurse type='11'>-1</Recurse>
			<description>Clean up from any previous builds</description>
			<indent type='3'>2</indent>
			<name>Clean Build Output Private Folder</name>
		</step>
		<step action='Delete Folder'>
			<Path>%BUILDOUTPUT_PUBLIC%</Path>
			<Recurse type='11'>-1</Recurse>
			<description>Clean up from any previous builds</description>
			<indent type='3'>2</indent>
			<name>Clean Build Output Public Folder</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PRIVATE%\Client-Side-by-Side</DestDir>
			<Ext>DCProtect*.SS*-Carbonite*.msi</Ext>
			<Flat type='11'>-1</Flat>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Save Private Client Side-by-Side Installers</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PRIVATE%\Client-WithPassphrase</DestDir>
			<Ext>DCProtect*WithPassphrase.*</Ext>
			<Flat type='11'>-1</Flat>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Save Private Client Installers</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PRIVATE%\IntermediateArtifacts</DestDir>
			<Ext>PrivateClientIntermediateArtifacts*.zip</Ext>
			<FailNone type='11'>-1</FailNone>
			<FailProp type='11'>-1</FailProp>
			<FailPurge type='11'>-1</FailPurge>
			<HideOn type='11'>-1</HideOn>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<SysOn type='11'>-1</SysOn>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>DoNotBuildClients</condexpr>
			<description>Capture intermediate artifacts for building the branded clients</description>
			<indent type='3'>2</indent>
			<name>Save Private Client Intermediate Artifacts</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PRIVATE%\Automation</DestDir>
			<Ext><![CDATA[*RESTWrapper*.zip
VaultDBHelper*.zip]]></Ext>
			<Flat type='11'>-1</Flat>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<MoveDirs type='11'>-1</MoveDirs>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Save Private Automation</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PRIVATE%\PrivateTools</DestDir>
			<Ext><![CDATA[PrivateToolInstallation*.zip
PrivateToolRestore*.zip
]]></Ext>
			<Flat type='11'>-1</Flat>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<MoveDirs type='11'>-1</MoveDirs>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Save Private Operations Tools</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PUBLIC%\Azure</DestDir>
			<Ext><![CDATA[CarboniteAzure*.*
Azure*.*
PrivateToolDeploymentManager*.*
PrivateToolVaultActivationTool*.*]]></Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Save Azure Installers</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PUBLIC%\AzureRM</DestDir>
			<Ext><![CDATA[*.nupkg
]]></Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Save ARM Public NuGet packages</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PRIVATE%\PrivateTools</DestDir>
			<Ext><![CDATA[CarbonitePrivateTools*.zip
ToolFileSequencer*.zip
InfoUpdates*.ziip
PrivateTool*.zip

]]></Ext>
			<Flat type='11'>-1</Flat>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<MoveDirs type='11'>-1</MoveDirs>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Save Private Tools</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PRIVATE%\Source</DestDir>
			<Ext>PrivateSource*.zip</Ext>
			<Flat type='11'>-1</Flat>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<MoveDirs type='11'>-1</MoveDirs>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcompareto>NIGHTLY</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>2</indent>
			<name>Save Private Zipped Source if Nightly Build</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PRIVATE%\Source</DestDir>
			<Ext>MergeDBScripts*.zip</Ext>
			<Flat type='11'>-1</Flat>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<MoveDirs type='11'>-1</MoveDirs>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcompareto>NIGHTLY</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>2</indent>
			<name>Save Combine DB Scripts Source</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PRIVATE%\Source</DestDir>
			<Ext><![CDATA[*.xcmap
PrivatePDBBinaries*.zip
]]></Ext>
			<Flat type='11'>-1</Flat>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<MoveDirs type='11'>-1</MoveDirs>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Save Private Source</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PUBLIC%\Azure-WebHelp</DestDir>
			<Ext>WebHelp*.zip</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Save Azure WebHelp</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PUBLIC%\Client-NoPassphrase</DestDir>
			<ExclExt>DCProtect-*-WithPassphrase.*</ExclExt>
			<Ext><![CDATA[DCProtect-*.*
]]></Ext>
			<Flat type='11'>-1</Flat>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Save Client Installers</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PUBLIC%\QuickCache</DestDir>
			<Ext>QuickCacheInstaller*.*</Ext>
			<Flat type='11'>-1</Flat>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeQuickCache%</condexpr>
			<indent type='3'>2</indent>
			<name>Save QuickCache Installers</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PUBLIC%\ResetServer</DestDir>
			<Ext>ResetServer-*.*</Ext>
			<Flat type='11'>-1</Flat>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeResetServer%</condexpr>
			<indent type='3'>2</indent>
			<name>Save Reset Server Installers</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PUBLIC%\Tools</DestDir>
			<Ext>Tool*.zip</Ext>
			<Flat type='11'>-1</Flat>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Save Tools Installers</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PUBLIC%\Tools</DestDir>
			<Ext>LdapSyncServiceInstaller-*.*</Ext>
			<Flat type='11'>-1</Flat>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeLDAPSync%</condexpr>
			<indent type='3'>2</indent>
			<name>Save Ldap Sync Service Installer</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PUBLIC%\Vault</DestDir>
			<ExclExt>VaultRESTWrapper*.*</ExclExt>
			<Ext>VaultInstaller*.*</Ext>
			<Flat type='11'>-1</Flat>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Save Vault Installers</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%BUILDOUTPUT_PRIVATE%\Build</DestDir>
			<Ext><![CDATA[%PROJFILE%
build.ini
version.ini]]></Ext>
			<Flat type='11'>-1</Flat>
			<LogCopied type='11'>-1</LogCopied>
			<Move type='11'>-1</Move>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\build</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Save Private Build Config</name>
		</step>
		<step action='Group'>
			<indent type='3'>1</indent>
			<name>Completion Phase</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>StartCompletion</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Major Build Stage</SubName>
			<indent type='3'>2</indent>
			<name>Log Major Build Stage - StartCompletion</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>C:\testing</DestDir>
			<Empty type='11'>-1</Empty>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<description>Used by units tests</description>
			<indent type='3'>2</indent>
			<name>Clean C:\testing Directory</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>C:\Deploy-Master</DestDir>
			<Empty type='11'>-1</Empty>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<description>Used by Deploy for units tests</description>
			<indent type='3'>2</indent>
			<name>Clean C:\Deploy-Master Directory</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>D:\DC</DestDir>
			<Empty type='11'>-1</Empty>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<continueonfail type='3'>1</continueonfail>
			<description>Used by Unit Tests but not needed after run</description>
			<indent type='3'>2</indent>
			<name>Clean D:\DC</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>EndCompletion</ParamValues>
			<Parameters array='0'>BUILD_STAGE</Parameters>
			<SubName>Log Major Build Stage</SubName>
			<indent type='3'>2</indent>
			<name>Log Major Build Stage - EndCompletion</name>
		</step></steps>
	<steps type='1'>
		<step action='Group'>
			<name>Deploy Vault Components</name>
		</step>
		<step action='Set Macro'>
			<DeleteMacro type='11'>-1</DeleteMacro>
			<MacroName>%DEPLOY_CONFIG_FILE%-DONE</MacroName>
			<MacroValue>0</MacroValue>
			<indent type='3'>1</indent>
			<name>Set Success Macro = 0</name>
		</step>
		<step action='Subroutine Call'>
			<Expand type='11'>-1</Expand>
			<ParamValues array='0'>%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%</ParamValues>
			<Parameters array='0'>FILE_EXISTS_NAME</Parameters>
			<SubName>File Exists</SubName>
			<description>This helps cater for the optional side-by-side release for AD</description>
			<indent type='3'>1</indent>
			<name>Does Deploy Config File Exists?</name>
		</step>
		<step action='Group'>
			<condcompareto>1</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%FILE_EXISTS%</condexpr>
			<indent type='3'>1</indent>
			<name>Deploy N/A</name>
		</step>
		<step action='Log Message'>
			<Message>DEPLOY -- %WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE% not available for Deploy</Message>
			<indent type='3'>2</indent>
			<name>Log Message for Deploy Config Not Available</name>
		</step>
		<step action='Group'>
			<condcompareto>1</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%FILE_EXISTS%</condexpr>
			<indent type='3'>1</indent>
			<name>Deploy</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DEPLOY_DB_SERVER</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%,Common,DBServer, 0000)%</MacroValue>
			<indent type='3'>2</indent>
			<name>Read DB Server from Deploy Config</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DEPLOY_WEB_SERVICES_SERVER</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%,Deployment,WebServer, 0000)%</MacroValue>
			<indent type='3'>2</indent>
			<name>Read Web Server from Deploy Config</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DEPLOY_JOB_PROCESSOR_SERVER</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%,Deployment,JPServer, 0000)%</MacroValue>
			<indent type='3'>2</indent>
			<name>Read JP Server from Deploy Config</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DEPLOY_UPDATESERVER_URL</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%,Deployment,UpdateServerUrl, 0000)%</MacroValue>
			<indent type='3'>2</indent>
			<name>Read Update Server URL from Deploy Config</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DEPLOY_UPDATESERVER_FILELOC</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%,Deployment,UpdateServerFileLocation, 0000)%</MacroValue>
			<indent type='3'>2</indent>
			<name>Read Update Server File Location from Deploy Config</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DEPLOY_BLOCK_DATA_DIR</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%,Deployment,BlocksStorageRootFolderUNC,)%</MacroValue>
			<indent type='3'>2</indent>
			<name>Read BlockData from deploy config</name>
		</step>
		<step action='Set Macro'>
			<MacroName>DEPLOY_JP_SERVICE_NAME</MacroName>
			<MacroValue>%READ_INI(%WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%,JobProcessor,ServiceName,)%</MacroValue>
			<indent type='3'>2</indent>
			<name>Read JP Service Name from deploy config</name>
		</step>
		<step action='Log Message'>
			<Message><![CDATA[DEPLOY -- %WORKING_DIRECTORY%\DeploymentFiles\Vault\DeploymentConfigs\%DEPLOY_CONFIG_FILE%
DEPLOY -- Database server = %DEPLOY_DB_SERVER%
DEPLOY -- WebService server = %DEPLOY_WEB_SERVICES_SERVER%
DEPLOY -- Job Processor server = %DEPLOY_JOB_PROCESSOR_SERVER%
DEPLOY -- UpdateServer url = %DEPLOY_UPDATESERVER_URL%
DEPLOY -- UpdateServer directory = %DEPLOY_UPDATESERVER_FILELOC%
DEPLOY -- Block Data dir = %DEPLOY_BLOCK_DATA_DIR%
DEPLOY -- Job Processor Name = %DEPLOY_JP_SERVICE_NAME%

]]></Message>
			<indent type='3'>2</indent>
			<name>Log Deploy Values</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script>CreateProcess "net stop %DEPLOY_JP_SERVICE_NAME%", "%DEPLOY_JOB_PROCESSOR_SERVER%", true</Script>
			<indent type='3'>2</indent>
			<name>Stop Old Job Processor</name>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Backend</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%DEPLOY_DB_SERVER%\c$\Deploy-%TF_BRANCH%</DestDir>
			<Ext><![CDATA[\Database\*.*
\DeploymentConfigs\*.*
*.vbs
]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy Deployment Files to Database</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script>CreateProcess "cscript c:\Deploy-%TF_BRANCH%\Database.vbs /install:c:\Deploy-%TF_BRANCH%\DeploymentConfigs\%DEPLOY_CONFIG_FILE% ", "%DEPLOY_DB_SERVER%", true</Script>
			<indent type='3'>3</indent>
			<name>Deploy Database</name>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Frontend</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%DEPLOY_BLOCK_DATA_DIR%</DestDir>
			<Empty type='11'>-1</Empty>
			<Hidden type='11'>-1</Hidden>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Delete BlockData from filesystem</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%DEPLOY_JOB_PROCESSOR_SERVER%\c$\Deploy-%TF_BRANCH%\</DestDir>
			<ExclExt>/FilesDebug</ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy Deployment Files to Job Processor</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%DEPLOY_WEB_SERVICES_SERVER%\c$\Deploy-%TF_BRANCH%\</DestDir>
			<ExclExt>/FilesDebug</ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Purge type='11'>-1</Purge>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcompareto>%DEPLOY_WEB_SERVICES_SERVER%</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%DEPLOY_JOB_PROCESSOR_SERVER%</condexpr>
			<indent type='3'>3</indent>
			<name>Copy Deployment Files for Web Services</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA['Set objNetwork = CreateObject("Wscript.Network")
'strComputer = objNetwork.ComputerName

'Set colAccounts = GetObject("WinNT://" & strComputer & "")
Set colAccounts = GetObject("WinNT://%DEPLOY_WEB_SERVICES_SERVER%")

colAccounts.Filter = Array("user")
For Each objUser In colAccounts

    'If it's a device then delete it
    if StrComp("DC Device: ",Left(objuser.FullName, Len("DC Device: "))) = 0 Then
		WScript.Echo "Deleting device: " & objUser.Name
		colAccounts.delete "user", objUser.Name
    else
		WScript.Echo "Not deleting user account: " & objUser.Name
    End If
Next
]]></Script>
			<checked type='11'>0</checked>
			<indent type='3'>3</indent>
			<name>Delete all devices from deployment web server</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script>CreateProcess "cscript c:\Deploy-%TF_BRANCH%\webServices.vbs /install:c:\Deploy-%TF_BRANCH%\DeploymentConfigs\%DEPLOY_CONFIG_FILE%", "%DEPLOY_WEB_SERVICES_SERVER%", true</Script>
			<indent type='3'>3</indent>
			<name>Deploy Webservices</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script>CreateProcess "cscript c:\Deploy-%TF_BRANCH%\jobProcessor.vbs /install:c:\Deploy-%TF_BRANCH%\DeploymentConfigs\%DEPLOY_CONFIG_FILE%", "%DEPLOY_JOB_PROCESSOR_SERVER%", true</Script>
			<indent type='3'>3</indent>
			<name>Deploy Job Processor</name>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Deploy Datacastle Update Pack for BVT</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\Datacastle\%RELEASE_VERSION%.%BUILD_VERSION%\manifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\Datacastle\%RELEASE_VERSION%.%BUILD_VERSION%\manifest.xml</FileOut>
			<Find><![CDATA[(^\s+<files base=")[[a-zA-Z0-9\/\:\.\_]]+(".+)]]></Find>
			<Replace>($1)%DEPLOY_UPDATESERVER_URL%/%RELEASE_VERSION%.%BUILD_VERSION%($2)</Replace>
			<description>Change Localhost to web</description>
			<indent type='3'>3</indent>
			<name>Update manifest.xml - files base</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\Datacastle\%RELEASE_VERSION%.%BUILD_VERSION%\manifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\Datacastle\%RELEASE_VERSION%.%BUILD_VERSION%\manifest.xml</FileOut>
			<Find><![CDATA[(^.+DeployGroup=)([[A-Za-z0-9\.\-\ \_\\]]+)(</description>$)]]></Find>
			<Replace>$1BVT$3</Replace>
			<description>Change Deploy Group to BVT</description>
			<indent type='3'>3</indent>
			<name>Update manifest.xml - Deploy Group</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%DEPLOY_UPDATESERVER_FILELOC%</DestDir>
			<Ext>*.*</Ext>
			<Hidden type='11'>-1</Hidden>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<LogUpToDate type='11'>-1</LogUpToDate>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\Datacastle</SourceDir>
			<TBD type='11'>-1</TBD>
			<description><![CDATA[Will copy version directory & Zip
Replace MasterManifest.xml]]></description>
			<indent type='3'>3</indent>
			<name>Copy Files - Update Pack to Web</name>
		</step>
		<step action='Set Macro'>
			<MacroName>%DEPLOY_CONFIG_FILE%-DONE</MacroName>
			<MacroValue>1</MacroValue>
			<indent type='3'>3</indent>
			<name>Set Deployment Completed Macro = 1</name>
		</step>
		<step action='Group'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcompareto>Master</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%TF_BRANCH%</condexpr>
			<continueonfail type='11'>-1</continueonfail>
			<description><![CDATA[Eventually this will deploy the tests on developer machines at the moment it is just deploying them on BOB
The TestRunner will pick them up and run them as needed.]]></description>
			<name>Run Distributed Automated Tests on Master</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%MACHINE_NAME_WITH_DOMAIN%\%SHARE_PATH%\</DestDir>
			<Ext>*.*</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\DeploymentFiles\ATFFiles\</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy in the Test Files - ATF Tests to AutomatedTestFolder</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%MACHINE_NAME_WITH_DOMAIN%\%SHARE_PATH%\PartnerTool\</DestDir>
			<Ext>*.*</Ext>
			<Flat type='11'>-1</Flat>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\..\AutomatedTestFiles\PartnerTool</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy in the ParterTool to AutomatedTestFolder on each Machine</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%MACHINE_NAME_WITH_DOMAIN%\%SHARE_PATH%\Vault</DestDir>
			<Ext>*.*</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\..\AutomatedTestFiles\Vault</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy in the Vault Files for Vault tests - ATF Tests to AutomatedTestFolder\Vault</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%MACHINE_NAME_WITH_DOMAIN%\%SHARE_PATH%\Installers</DestDir>
			<Ext>DC-%FULL_BUILD_NUMBER%.exe</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\..\AutomatedTestFiles\</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy the Installer to the AutomatedTestFolder on each Machine</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>\\%MACHINE_NAME_WITH_DOMAIN%\%SHARE_PATH%\</DestDir>
			<Ext>PublishSettings.xml</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\..\AutomatedTestFiles\</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy the PublishSettings to the AutomatedTestFolder on each Machine</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Testing\ATF\%MACHINE_NAME%WebAtfSettings.xml</FileIn>
			<FileOut>\\%MACHINE_NAME_WITH_DOMAIN%\%SHARE_PATH%\%MACHINE_NAME%WebAtfSettings.xml</FileOut>
			<Find>1.0.0.0</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%FULL_BUILD_NUMBER%</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Replace 1.0.0.0 in ATFSettings for NT</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Testing\ATF\%MACHINE_NAME%BOB2AtfSettings.xml</FileIn>
			<FileOut>\\%MACHINE_NAME_WITH_DOMAIN%\%SHARE_PATH%\%MACHINE_NAME%BOB2AtfSettings.xml</FileOut>
			<Find>1.0.0.0</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%FULL_BUILD_NUMBER%</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<checked type='11'>0</checked>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Replace 1.0.0.0 in ATFSettings for BOB2</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Testing\ATF\%MACHINE_NAME%VaultAtfSettings.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\..\AutomatedTestFiles\TestMachineSettingsFiles\%MACHINE_NAME%VaultAtfSettings.xml</FileOut>
			<Find>1.0.0.0</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%FULL_BUILD_NUMBER%</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<checked type='11'>0</checked>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Replace 1.0.0.0 in ATFSettings for Vault</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\Testing\ATF\%MACHINE_NAME%RackspaceAtfSettings.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\..\AutomatedTestFiles\TestMachineSettingsFiles\%MACHINE_NAME%RackspaceAtfSettings.xml</FileOut>
			<Find>1.0.0.0</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%FULL_BUILD_NUMBER%</Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<checked type='11'>0</checked>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Replace 1.0.0.0 in ATFSettings for Rackspace</name>
		</step>
		<step action='Group'>
			<name>CopyVaultFiles</name>
		</step>
		<step action='Group'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<checked type='11'>0</checked>
			<condcompareto>TRUE</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%DEBUG%</condexpr>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Debug</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\JobProcessor</DestDir>
			<ExclExt><![CDATA[*.exclude
*.cs]]></ExclExt>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\JobProcessorService\bin\Debug</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>2</indent>
			<name>Copy Debug-Vault JobProcessor Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\BlockManagementService</DestDir>
			<ExclExt><![CDATA[\Configuration\*
*.exclude
*.pdb
*.cs
*.config
*.xml]]></ExclExt>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\Datacastle.Server.BlockManagementService\bin\Debug</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>2</indent>
			<name>Copy Debug-BlockManagementService Files</name>
		</step>
		<step action='Group'>
			<checked type='11'>0</checked>
			<condcompareto>V1</condcompareto>
			<condcomparison type='3'>5</condcomparison>
			<condexpr>%TF_BRANCH%</condexpr>
			<description>Works for all post V1 builds</description>
			<indent type='3'>2</indent>
			<name>Copy Debug Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\PartnerService</DestDir>
			<ExclExt><![CDATA[\*in\Configuration\*.*
\Obj\*\*
\Configuration\*.*
*.exclude
*.pdb
]]></ExclExt>
			<Ext><![CDATA[\bin\*.*
*.aspx
*.asmx
*.asax
*.config
*.cs]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\Datacastle.Server.PartnerService</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<condcompareto>Master</condcompareto>
			<condexpr>%TF_BRANCH%</condexpr>
			<indent type='3'>3</indent>
			<name>Copy Debug-Vault PartnerService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\CustomerService</DestDir>
			<ExclExt><![CDATA[\*in\Configuration\*
\Obj\*\*
\Configuration\*
*.exclude
*.pdb]]></ExclExt>
			<Ext><![CDATA[bin\*.*
*.aspx
*.asmx
*.asax
*.config
*.cs]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\Datacastle.Server.CustomerService</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>3</indent>
			<name>Copy Debug-Valut CustomerService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\DiscoveryService</DestDir>
			<ExclExt><![CDATA[\*in\Configuration\*
*.exclude
\Configuration\*.*
\obj\*\*
overrides.config
]]></ExclExt>
			<Ext><![CDATA[\bin\*.*
*.asax
*.Config]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\Datacastle.Server.DiscoveryService</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<checked type='11'>0</checked>
			<condcompareto>Master</condcompareto>
			<condexpr>%TF_BRANCH%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Copy Debug-Vault DiscoveryService Files Bin folder</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\ProvisionService</DestDir>
			<ExclExt><![CDATA[\*in\Configuration\*
\Obj\*\*
\Configuration\*
*.exclude
*.pdb
overrides.config]]></ExclExt>
			<Ext><![CDATA[bin\*.*
*.aspx
*.asmx
*.asax
*.config
*.cs]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\Datacastle.Server.ProvisionService</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>3</indent>
			<name>Copy Debug-Vault ProvisionService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\PartnerReportingService</DestDir>
			<ExclExt><![CDATA[\*in\Configuration\*
\Obj\*\*
\Configuration\*
*.exclude
*.pdb
overrides.config]]></ExclExt>
			<Ext><![CDATA[bin\*.*
*.aspx
*.asmx
*.asax
*.config
*.cs]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\Datacastle.Server.PartnerReportingService</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>3</indent>
			<name>Copy Debug-Vault PartnerReportingService Files</name>
		</step>
		<step action='Group'>
			<checked type='11'>0</checked>
			<condcompareto>Master-V1.2</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%TF_BRANCH%</condexpr>
			<description>Added due to WebService Project change for V2.0</description>
			<indent type='3'>2</indent>
			<name>Copy Debug Files For Master-V1.2  Branch</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\CustomerService</DestDir>
			<ExclExt><![CDATA[*.exclude
]]></ExclExt>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\CustomerService</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>3</indent>
			<name>Copy Debug-Valut CustomerService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\ProvisionService</DestDir>
			<ExclExt><![CDATA[*.exclude
]]></ExclExt>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\ProvisionService</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>3</indent>
			<name>Copy Debug-Vault ProvisionService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\FilesDebug\PartnerService</DestDir>
			<ExclExt><![CDATA[*.exclude

]]></ExclExt>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\PartnerService</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<condcompareto>Master-V1.2</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%TF_BRANCH%</condexpr>
			<indent type='3'>3</indent>
			<name>Copy Debug-Vault PartnerService Files (Master-V1.2)</name>
		</step>
		<step action='Group'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcompareto>FALSE</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%DEBUG%</condexpr>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Release</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\Files\JobProcessor</DestDir>
			<ExclExt><![CDATA[\Configuration\*
*.exclude
*.pdb
*.cs]]></ExclExt>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Server\JobProcessorService\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<checked type='11'>0</checked>
			<indent type='3'>2</indent>
			<name>Copy JobProcessor Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\Files\BlockManagementService</DestDir>
			<ExclExt><![CDATA[\Configuration\*
*.exclude
*.pdb
*.cs
*.config]]></ExclExt>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Datacastle.Server.BlockManagementService\bin\Release</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Copy BlockManagementService Files</name>
		</step>
		<step action='Group'>
			<condcompareto>V1</condcompareto>
			<condcomparison type='3'>5</condcomparison>
			<condexpr>%TF_BRANCH%</condexpr>
			<description>Works for all post V1 builds</description>
			<indent type='3'>2</indent>
			<name>Copy Release Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\Files\CustomerService</DestDir>
			<ExclExt><![CDATA[*.exclude
*.pdb
]]></ExclExt>
			<Ext><![CDATA[bin\*.dll
*.aspx
*.asmx
*.asax
*.config
*.cs]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Legacy\Datacastle.Server.CustomerService</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy CustomerService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\Files\ProvisionService</DestDir>
			<ExclExt><![CDATA[*.exclude
*.pdb
]]></ExclExt>
			<Ext><![CDATA[bin\*.dll
*.aspx
*.asmx
*.asax
*.config
*.cs]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Legacy\Datacastle.Server.ProvisionService</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>3</indent>
			<name>Copy ProvisionService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\Files\PartnerService</DestDir>
			<ExclExt><![CDATA[\*in\Configuration\*
*.exclude
*.pdb
]]></ExclExt>
			<Ext><![CDATA[bin\*.dll
Global.asax
Web.config
*.as*
*.cs]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Legacy\Datacastle.Server.PartnerService</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcompareto>Master</condcompareto>
			<condexpr>%TF_BRANCH%</condexpr>
			<indent type='3'>3</indent>
			<name>Copy PartnerService Files</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\Vault\Files\DiscoveryService</DestDir>
			<ExclExt><![CDATA[\*in\Configuration\*
\Obj\*\*
\Configuration\*
*.exclude
*.pdb
overrides.config]]></ExclExt>
			<Ext><![CDATA[bin\*.dll
*.aspx
*.asmx
*.asax
*.config]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\Core\Server\Legacy\Datacastle.Server.DiscoveryService</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>3</indent>
			<name>Copy DiscoveryService Files</name>
		</step>
		<step action='Group'>
			<name>Stamp Assembly</name>
		</step>
		<step action='Log Message'>
			<Message>Stamping %ASSEMBLY_SOURCE%</Message>
			<indent type='3'>1</indent>
			<name>Stamping AssemblyInfo.cs</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%ASSEMBLY_SOURCE%</FileIn>
			<FileOut>%ASSEMBLY_SOURCE%</FileOut>
			<Find><![CDATA[assembly:\s+AssemblyFileVersion\(\".+\"\)\]
]]></Find>
			<NoModS type='11'>-1</NoModS>
			<Replace><![CDATA[assembly: AssemblyFileVersion\("%RELEASE_VERSION%.%BUILD_VERSION%"\)\]
]]></Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Stamp AssemblyFileVersion on %ASSEMBLY_SOURCE%</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%ASSEMBLY_SOURCE%</FileIn>
			<FileOut>%ASSEMBLY_SOURCE%</FileOut>
			<Find><![CDATA[assembly:\s+AssemblyVersion\(\".+\"\)\]
]]></Find>
			<NoModS type='11'>-1</NoModS>
			<Replace><![CDATA[assembly: AssemblyVersion\("%RELEASE_VERSION%.%BUILD_VERSION%"\)\]
]]></Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Stamp AssemblyVersion on %ASSEMBLY_SOURCE%</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%ASSEMBLY_SOURCE%</FileIn>
			<FileOut>%ASSEMBLY_SOURCE%</FileOut>
			<Find><![CDATA[assembly:\s+AssemblyInformationalVersion\(\".+\"\)\]
]]></Find>
			<NoModS type='11'>-1</NoModS>
			<Replace><![CDATA[assembly: AssemblyInformationalVersion\("%RELEASE_VERSION%.%BUILD_VERSION%"\)\]
]]></Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Stamp AssemblyInformationalVersion on %ASSEMBLY_SOURCE%</name>
		</step>
		<step action='Replace in File'>
			<Append><![CDATA[
[[assembly:AssemblyKeyFileAttribute("%STRONG_NAME_KEY%")]]
[[assembly:AssemblyDelaySignAttribute(true)]]]]></Append>
			<Attr type='11'>-1</Attr>
			<CaseSensitive type='11'>-1</CaseSensitive>
			<FileIn>%ASSEMBLY_SOURCE%</FileIn>
			<FileOut>%ASSEMBLY_SOURCE%</FileOut>
			<Find><![CDATA[AssemblyKeyFileAttributeAlwaysAdd
]]></Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>wont be found</Replace>
			<checked type='11'>0</checked>
			<description><![CDATA[[assembly:AssemblyKeyFileAttribute("myKey.snk")]
[assembly:AssemblyDelaySignAttribute(true)]]]></description>
			<indent type='3'>1</indent>
			<name>Stamp AssemblyKeyFileAttribute - DelaySign on %ASSEMBLY_SOURCE%</name>
		</step>
		<step action='Replace in File'>
			<Append><![CDATA[
[[assembly:AssemblyKeyFileAttribute("%STRONG_NAME_KEY%")]]
]]></Append>
			<Attr type='11'>-1</Attr>
			<CaseSensitive type='11'>-1</CaseSensitive>
			<FileIn>%ASSEMBLY_SOURCE%</FileIn>
			<FileOut>%ASSEMBLY_SOURCE%</FileOut>
			<Find><![CDATA[AssemblyKeyFileAttributeAlwaysAdd
]]></Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>wont be found</Replace>
			<checked type='11'>0</checked>
			<description><![CDATA[[assembly:AssemblyKeyFileAttribute("myKey.snk")]
]]></description>
			<indent type='3'>1</indent>
			<name>Stamp AssemblyKeyFileAttribute on %ASSEMBLY_SOURCE%</name>
		</step>
		<step action='Group'>
			<name>Update App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_MainService_ServiceName" value=")([[A-Za-z0-9\.\-\ \_]]+)("/>$)]]></Find>
			<Replace>$1$2_%UNIQUE_SYSTEM_NAME%$3</Replace>
			<indent type='3'>1</indent>
			<name>MainService_ServiceName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_MainService_DisplayName" value=")([[A-Za-z0-9\.\-\ \_]]+)("/>$)]]></Find>
			<Replace>$1$2_%UNIQUE_SYSTEM_NAME%$3</Replace>
			<indent type='3'>1</indent>
			<name>MainService_DisplayName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_MainService_AccountName" value=")([[A-Za-z0-9\.\-\ \_]]+)("/>$)]]></Find>
			<Replace>$1%SVC_ACCOUNT%$3</Replace>
			<indent type='3'>1</indent>
			<name>MainService_AccountName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_MainService_AccountFullName" value=")([[A-Za-z0-9\.\-\ \_]]+)("/>$)]]></Find>
			<Replace>$1$2\(%UNIQUE_SYSTEM_NAME%\)$3</Replace>
			<indent type='3'>1</indent>
			<name>MainService_AccountFullName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_TransportService_ServiceName" value=")([[A-Za-z0-9\.\-\ \_]]+)("/>$)]]></Find>
			<Replace>$1$2_%UNIQUE_SYSTEM_NAME%$3</Replace>
			<indent type='3'>1</indent>
			<name>TransportService_ServiceName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_TransportService_DisplayName" value=")([[A-Za-z0-9\.\-\ \_]]+)("/>$)]]></Find>
			<Replace>$1$2_%UNIQUE_SYSTEM_NAME%$3</Replace>
			<indent type='3'>1</indent>
			<name>TransportService_DisplayName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Registry_HKLM_ApplicationKey" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1$2_%UNIQUE_SYSTEM_NAME%$3</Replace>
			<indent type='3'>1</indent>
			<name>Registry_HKLM_ApplicationKey</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1$2 \(%UNIQUE_SYSTEM_NAME%\)$3</Replace>
			<indent type='3'>1</indent>
			<name>ClientTool_ApplicationName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_TitleBarName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1$2 \(%UNIQUE_SYSTEM_NAME%\)$3</Replace>
			<indent type='3'>1</indent>
			<name>ClientTool_TitleBarName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_MutexName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1%CLIENT_MUTEX%$3</Replace>
			<indent type='3'>1</indent>
			<name>ClientTool_MutexName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Notifier_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1$2 \(%UNIQUE_SYSTEM_NAME%\)$3</Replace>
			<indent type='3'>1</indent>
			<name>Notifier_ApplicationName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Notifier_MutexName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1%NOTIFIER_MUTEX%$3</Replace>
			<indent type='3'>1</indent>
			<name>Notifier_MutexName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Miscellaneous_BITSJobNamePrefix" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1%UNIQUE_SYSTEM_NAME%_$2$3</Replace>
			<indent type='3'>1</indent>
			<name>Miscellaneous_BITSJobNamePrefix</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Miscellaneous_DatapathFolderName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1$2_%UNIQUE_SYSTEM_NAME%$3</Replace>
			<indent type='3'>1</indent>
			<name>Miscellaneous_DatapathFolderName</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="RemotingConfig_MainServiceRemotingUri" value=")[[a-zA-Z0-9\/\:\.\_]]+("/>$)]]></Find>
			<Replace>$1%MAIN_REMOTING_URI%$2</Replace>
			<indent type='3'>1</indent>
			<name>Remoting - MainServiceRemotingUri</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="RemotingConfig_TransportServiceRemotingUri" value=")[[a-zA-Z0-9\/\:\.\_]]+("/>$)]]></Find>
			<Replace>$1%TRANSPORT_REMOTING_URI%$2</Replace>
			<indent type='3'>1</indent>
			<name>Remoting - TransportServiceRemotingUri</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="RemotingConfig_NotifierRemotingUri" value=")[[a-zA-Z0-9\/\:\.\_]]+("/>$)]]></Find>
			<Replace>$1%NOTIFIER_REMOTING_URI%$2</Replace>
			<indent type='3'>1</indent>
			<name>Remoting - NotifierRemotingUri</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%APP_CONFIG%</FileIn>
			<FileOut>%APP_CONFIG%</FileOut>
			<Find><![CDATA[(^\s+<add key="RemotingConfig_ClientRemotingUri" value=")[[a-zA-Z0-9\/\:\.\_]]+("/>$)]]></Find>
			<Replace>$1%CLIENT_REMOTING_URI%$2</Replace>
			<indent type='3'>1</indent>
			<name>Remoting - ClientRemotingUri</name>
		</step>
		<step action='Group'>
			<description>Checks a nominated drive to report free space</description>
			<name>Check Free Space on Disk</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[Set objWMIService = GetObject("winmgmts:")
Set objLogicalDisk = objWMIService.Get("Win32_LogicalDisk.DeviceID='%DISK_DRIVE%:'")

iSpc= objLogicalDisk.FreeSpace/1000
iSpc= iSpc/1000
iSpc= iSpc/1000
iSpc= FormatNumber(iSpc,1)

'To capture the Date & Time, use "Now" function instead of "Date"
Wscript.Echo " %DISK_DRIVE%: " & iSpc & " GB Free space or " & objLogicalDisk.FreeSpace

Project.Macros.Add "FREE_SPACE_GB", iSpc

If iSpc < %GB_FREE% Then
	Wscript.Echo "Free space alert - LOW DISK SPACE"
	Project.Macros.Add "FREE_SPACE_ALERT", 1
ELSE
	Project.Macros.Add "FREE_SPACE_ALERT", 0
End If
]]></Script>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Free Disk Space</name>
		</step>
		<step action='Exit'>
			<Message>Disk Space is low.</Message>
			<Status type='3'>1</Status>
			<condcompareto>1</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%FREE_SPACE_ALERT%</condexpr>
			<indent type='3'>1</indent>
			<name>Exit</name>
		</step>
		<step action='Group'>
			<name>Check Strong Naming</name>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.BackupService.exe"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.BackupTransportService.exe"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.ClientTool.exe"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.Common.dll"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.FileStore.dll"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.Notifier.exe"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.ServiceLibrary.dll"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Client.ServiceSchemas.dll"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Common.Bits.dll"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Common.Common.dll"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>sn.exe -v "%ASSEMBLY_FOLDER%Datacastle.Common.DTOSchemas.dll"</command>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Run Program</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<name>Build Branded Setup</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Theme</DestDir>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\Src\Branding\%BRAND_NAME%\Theme</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcompareto>Carbonite</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BRAND_NAME%</condexpr>
			<continueonfail type='11'>-1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy Files Themes (Not Carbonite)</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Theme</DestDir>
			<Ext>theme.xml</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Client\ClientTool\Theme</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcompareto>Carbonite</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BRAND_NAME%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy theme.xml to branded releases (Not Carbonite)</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<CaseSensitive type='11'>-1</CaseSensitive>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\ReadMe.rtf</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\ReadMe.rtf</FileOut>
			<Find>@INSTALLER_BRAND_NAME@</Find>
			<Literal type='11'>-1</Literal>
			<Replace>%INSTALLER_BRAND_NAME%</Replace>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Update @INSTALLER_BRAND_NAME@ token in ReadMe.rtf</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<CaseSensitive type='11'>-1</CaseSensitive>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\InstallationReadMe.rtf</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\InstallationReadMe.rtf</FileOut>
			<Find>[Datacastle]</Find>
			<Literal type='11'>-1</Literal>
			<Replace>%INSTALLER_BRAND_NAME%</Replace>
			<checked type='11'>0</checked>
			<indent type='3'>1</indent>
			<name>Update [Datacastle] token in InstallationReadMe.rtf</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout</DestDir>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\Src\Branding\%BRAND_NAME%\Install</SourceDir>
			<TBD type='11'>-1</TBD>
			<buildfailsteps type='11'>0</buildfailsteps>
			<condcompareto>Carbonite</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BRAND_NAME%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>1</indent>
			<name>Copy install rtf files from brand (Not Carbonite)</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Theme\Icons\Application.ico" "%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Theme\Icons\App_%FULL_BUILD_NUMBER%.ico" </command>
			<condcompareto>Carbonite</condcompareto>
			<condcomparison type='3'>5</condcomparison>
			<condexpr>%BRAND_NAME%</condexpr>
			<indent type='3'>1</indent>
			<name>Copy the Application.Ico to App_%FULL_BUILD_NUMBER%.ico</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Theme</DestDir>
			<ExclExt>/unused_items</ExclExt>
			<Ext>*.*</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Client\ClientTool\Theme</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcompareto>Carbonite</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BRAND_NAME%</condexpr>
			<indent type='3'>1</indent>
			<name>Copy Files Themes (Carbonite only)</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\</DestDir>
			<Ext><![CDATA[Datacastle.Client.ClientTool.exe
Datacastle.Client.Notifier.exe]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Client\SharedFiles-PostSigning\SetupAssemblies\</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BRAND_SIGNED_FLAG%</condexpr>
			<description><![CDATA[If %BRAND_SIGNED_FLAG% set to True grab the Signed Client Tool & Notifier]]></description>
			<indent type='3'>1</indent>
			<name>Copy Signed Client Tool Files to Deployment Layout</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\</DestDir>
			<Ext><![CDATA[Datacastle.Client.ClientTool.exe
Datacastle.Client.Notifier.exe]]></Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Client\SharedFilesForSigning-PreSigning\SetupAssemblies</SourceDir>
			<TBD type='11'>-1</TBD>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BRAND_SIGNED_FLAG%</condexpr>
			<description><![CDATA[If %BRAND_SIGNED_FLAG% not set to True grab the Signed Client Tool & Notifier]]></description>
			<indent type='3'>1</indent>
			<name>Copy unsigned Client Tool Files to Deployment Layout</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="AppUpdate_SetupComplete" value=")(\w+)(" />$)
]]></Find>
			<Replace>($1)true($3)\r\n</Replace>
			<indent type='3'>1</indent>
			<name>Update AppUpdate_SetupComplete = true</name>
		</step>
		<step action='Group'>
			<condcompareto>Carbonite</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BRAND_NAME%</condexpr>
			<indent type='3'>1</indent>
			<name>Make updates for branding build</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_ApplicationName for Client Tool App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.Notifier.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.Notifier.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_ApplicationName for Notifier App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Service\Datacastle.Client.BackupService.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Service\Datacastle.Client.BackupService.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_ApplicationName for Backup Service App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Transport Service\Datacastle.Client.BackupTransportService.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Transport Service\Datacastle.Client.BackupTransportService.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_ApplicationName for Transport Service App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_TitleBarName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_TitleBarName for Client Tool App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.Notifier.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.Notifier.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_TitleBarName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_TitleBarName for Notifier App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Service\Datacastle.Client.BackupService.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Service\Datacastle.Client.BackupService.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_TitleBarName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_TitleBarName for Backup Service App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Transport Service\Datacastle.Client.BackupTransportService.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Transport Service\Datacastle.Client.BackupTransportService.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_ClientTool_TitleBarName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME%$3</Replace>
			<indent type='3'>2</indent>
			<name>ClientTool_TitleBarName for Transport Service App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Notifier_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME% Notifier$3 </Replace>
			<indent type='3'>2</indent>
			<name>Notifier_ApplicationName for Client Tool App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.Notifier.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.Notifier.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Notifier_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME% Notifier$3 </Replace>
			<indent type='3'>2</indent>
			<name>Notifier_ApplicationName for Notifier App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Service\Datacastle.Client.BackupService.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Service\Datacastle.Client.BackupService.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Notifier_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME% Notifier$3 </Replace>
			<indent type='3'>2</indent>
			<name>Notifier_ApplicationName for Backup Service App Config</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Transport Service\Datacastle.Client.BackupTransportService.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Services\Backup Transport Service\Datacastle.Client.BackupTransportService.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="WellKnownName_Notifier_ApplicationName" value=")([[A-Za-z0-9\.\-\ \_\\]]+)("/>$)]]></Find>
			<Replace>$1\%BRAND_SYSTEM_RENAME% Notifier$3 </Replace>
			<indent type='3'>2</indent>
			<name>Notifier_ApplicationName for Transport Service App Config</name>
		</step>
		<step action='Write INI'>
			<Filename>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini</Filename>
			<Section>Variables</Section>
			<ValueData>%INSTALLER_BRAND_NAME%</ValueData>
			<ValueName>BRANDNAME</ValueName>
			<indent type='3'>2</indent>
			<name>Update Brand Name in MSIFactory INI</name>
		</step>
		<step action='Write INI'>
			<Filename>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini</Filename>
			<Section>Variables</Section>
			<ValueData>%INSTALLER_BRAND_CORP_NAME%</ValueData>
			<ValueName>BRANDCORPNAME</ValueName>
			<indent type='3'>2</indent>
			<name>Update Brand Corp Name in MSIFactory INI</name>
		</step>
		<step action='Write INI'>
			<Filename>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini</Filename>
			<Section>Variables</Section>
			<ValueData>%INSTALLER_BRAND_INFO_URL%</ValueData>
			<ValueName>BRANDINFOURL</ValueName>
			<indent type='3'>2</indent>
			<name>Update Brand Info Url in MSIFactory INI</name>
		</step>
		<step action='Write INI'>
			<Filename>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini</Filename>
			<Section>Variables</Section>
			<ValueData>%INSTALLER_BRAND_SUPPORT_URL%</ValueData>
			<ValueName>BRANDSUPPORTURL</ValueName>
			<indent type='3'>2</indent>
			<name>Update Brand Support Url in MSIFactory INI</name>
		</step>
		<step action='Write INI'>
			<Filename>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini</Filename>
			<Section>Variables</Section>
			<ValueData>%INSTALLER_BRAND_UPDATE_URL%</ValueData>
			<ValueName>BRANDUPDATEURL</ValueName>
			<indent type='3'>2</indent>
			<name>Update Brand Update Url in MSIFactory INI</name>
		</step>
		<step action='InstallAWARE'>
			<BuildType type='3'>1</BuildType>
			<Filename>%WORKING_DIRECTORY%\WIP\src\setup\InstallAware.ClientTool\Datacastle.ClientTool.Setup.mpr</Filename>
			<RevCode type='11'>-1</RevCode>
			<ShowCmd type='11'>-1</ShowCmd>
			<checked type='11'>0</checked>
			<indent type='3'>1</indent>
			<name>Build Client Setup - InstallAware (release)</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<checked type='11'>0</checked>
			<command>signtool.exe sign /f "d:\Datacastle\Code Signing Certificate\datacastle.pfx" /d "Carbonite Setup" /t "http://timestamp.verisign.com/scripts/timstamp.dll" /v "%WORKING_DIRECTORY%\WIP\src\setup\InstallAware.ClientTool\Release\Single\Datacastle.ClientTool.Setup.exe"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[Signed the Installaware installer ALWAYS

]]></description>
			<indent type='3'>1</indent>
			<name>Sign InstallerAware Setup</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[Wscript.Echo "Building for %BRAND_NAME%"

if "%BRAND_SIGNED_FLAG%" = "True" Then
		wscript.Echo "Building branded release Signed Release with Signed Exes & Installer - %WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%.exe"
		Project.Macros.Add "SETUP_NAME", "%WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%.exe"
ELSE
		wscript.Echo "Building Standard unsigned Release with Signed Exes & Installer - %WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%-Unsigned.exe"
		Project.Macros.Add "SETUP_NAME", "%WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%-Unsigned.exe"
End If

Wscript.Echo "Building %SETUP_NAME%"
]]></Script>
			<checked type='11'>0</checked>
			<description><![CDATA[Do not change order of BRAND.INI this happens to snure all brands will be signed
]]></description>
			<indent type='3'>1</indent>
			<name>Determine setup exe name</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<checked type='11'>0</checked>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\setup\InstallAware.ClientTool\Release\Single\Datacastle.ClientTool.Setup.exe" %SETUP_NAME%</command>
			<indent type='3'>1</indent>
			<name>Copy InstallerAware Setup exe</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Write INI'>
			<Filename>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini</Filename>
			<Section>Variables</Section>
			<ValueData>%FULL_BUILD_NUMBER%</ValueData>
			<ValueName>BUILDNUM</ValueName>
			<indent type='3'>1</indent>
			<name>Update Build number in MSIFactory INI</name>
		</step>
		<step action='Group'>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BRAND_MSIPASSPHRASE%</condexpr>
			<indent type='3'>1</indent>
			<name>MSIFactory Installer (if MSIPASSPHRASE = True)</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileOut>
			<Find>C:\Users\garysu\Desktop\temp</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout</Replace>
			<checked type='11'>0</checked>
			<indent type='3'>2</indent>
			<name>Replace source location in msifact file</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileOut>
			<Find>C:\Users\garysu\Documents\MSI Factory\Projects\FinalizeInstall.lua</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\FinalizeInstall.lua</Replace>
			<checked type='11'>0</checked>
			<indent type='3'>2</indent>
			<name>Replace location of lua companion file</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\</DestDir>
			<Ext>autoconfig.xml</Ext>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SkipExist type='11'>-1</SkipExist>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Copy autoconfig.xml to client dir</name>
		</step>
		<step action='Write XML'>
			<Create type='11'>-1</Create>
			<Filename>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\autoconfig.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%BRAND_ACTIVATIONURL%</Text>
			<XPath>/AutoConfig/ActivationUrl</XPath>
			<condcompareto>NOURL</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BRAND_ACTIVATIONURL%</condexpr>
			<indent type='3'>2</indent>
			<name>Write branded URL</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\autoconfig.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\autoconfig.xml</FileOut>
			<Find><![CDATA[><]]></Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace><![CDATA[>
<]]></Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>2</indent>
			<name>Fix xml formatting</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"C:\Program Files\MSI Factory\MSI Factory.exe" /build "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact" "/STDOUT" "/VARS:%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini"</command>
			<condcompareto>0</condcompareto>
			<condexpr>%BRAND_LOOP_COUNT%</condexpr>
			<indent type='3'>2</indent>
			<name>Call MSIFactory to build MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>signtool.exe sign /f "d:\Datacastle\Code Signing Certificate\datacastle.pfx" /d "Carbonite Setup" /t "http://timestamp.verisign.com/scripts/timstamp.dll" /v "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.msi"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[Signed the Installaware installer ALWAYS

]]></description>
			<indent type='3'>2</indent>
			<name>Sign MSIFactory MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>signtool.exe sign /f "d:\Datacastle\Code Signing Certificate\datacastle.pfx" /d "Carbonite Setup" /t "http://timestamp.verisign.com/scripts/timstamp.dll" /v "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.exe"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[Signed the Installaware installer ALWAYS

]]></description>
			<indent type='3'>2</indent>
			<name>Sign MSIFactory EXE</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.MSI" "%WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%.MSI"</command>
			<indent type='3'>2</indent>
			<name>Copy MSIFactory MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.exe" "%WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%-MSI.EXE"</command>
			<indent type='3'>2</indent>
			<name>Copy MSIFactory EXE</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BRAND_MSINOPASSPHRASE%</condexpr>
			<indent type='3'>1</indent>
			<name>MSIFactory Installer (if MSINoPassphrase = True)</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileOut>
			<Find>C:\Users\garysu\Desktop\temp</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout</Replace>
			<indent type='3'>2</indent>
			<name>Replace source location in msifact file</name>
		</step>
		<step action='Replace in File'>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact</FileOut>
			<Find>C:\Users\garysu\Documents\MSI Factory\Projects\FinalizeInstall.lua</Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace>%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\FinalizeInstall.lua</Replace>
			<indent type='3'>2</indent>
			<name>Replace location of lua companion file</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\NoPassphrase-autoconfig.xml" "%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\autoconfig.xml"</command>
			<indent type='3'>2</indent>
			<name>Copy NoPassphrase-autoconfig.xml</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Write XML'>
			<Create type='11'>-1</Create>
			<Filename>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\autoconfig.xml</Filename>
			<ForceXPath type='11'>-1</ForceXPath>
			<ProhibitDTD type='11'>-1</ProhibitDTD>
			<Text>%BRAND_ACTIVATIONURL%</Text>
			<XPath>/AutoConfig/ActivationUrl</XPath>
			<condcompareto>NOURL</condcompareto>
			<condcomparison type='3'>4</condcomparison>
			<condexpr>%BRAND_ACTIVATIONURL%</condexpr>
			<indent type='3'>2</indent>
			<name>Write branded URL</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\autoconfig.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\autoconfig.xml</FileOut>
			<Find><![CDATA[><]]></Find>
			<Literal type='11'>-1</Literal>
			<NoModS type='11'>-1</NoModS>
			<Replace><![CDATA[>
<]]></Replace>
			<buildfailsteps type='11'>0</buildfailsteps>
			<continueonfail type='3'>1</continueonfail>
			<indent type='3'>2</indent>
			<name>Fix xml formatting</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>"C:\Program Files\MSI Factory\MSI Factory.exe" /build "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\Datacastle Installer.msifact" "/STDOUT" "/VARS:%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIFactory.ini"</command>
			<condcompareto>0</condcompareto>
			<condexpr>%BRAND_LOOP_COUNT%</condexpr>
			<indent type='3'>2</indent>
			<name>Call MSIFactory to build MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>signtool.exe sign /f "d:\Datacastle\Code Signing Certificate\datacastle.pfx" /d "Carbonite Setup" /t "http://timestamp.verisign.com/scripts/timstamp.dll" /v "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.msi"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[Signed the Installaware installer ALWAYS

]]></description>
			<indent type='3'>2</indent>
			<name>Sign MSIFactory MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<buildfailsteps type='11'>0</buildfailsteps>
			<command>signtool.exe sign /f "d:\Datacastle\Code Signing Certificate\datacastle.pfx" /d "Carbonite Setup" /t "http://timestamp.verisign.com/scripts/timstamp.dll" /v "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.exe"</command>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>0</condcomparison>
			<condexpr>%DoNotIncludeSigning%</condexpr>
			<continueonfail type='3'>1</continueonfail>
			<description><![CDATA[Signed the Installaware installer ALWAYS

]]></description>
			<indent type='3'>2</indent>
			<name>Sign MSIFactory EXE</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.MSI" "%WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%.MSI"</command>
			<indent type='3'>2</indent>
			<name>Copy MSIFactory MSI</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\setup\MSIFactory\MSIMasterSetup.exe" "%WORKING_DIRECTORY%\DeploymentFiles\DC-%FULL_BUILD_NUMBER%-%BRAND_NAME%-MSI.EXE"</command>
			<indent type='3'>2</indent>
			<name>Copy MSIFactory EXE</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<description>used for datacastle updater</description>
			<indent type='3'>1</indent>
			<name>Create Update Zip</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[dim GuidMaker
dim NewGuid

Set GuidMaker = CreateObject("GuidMakr.GUID")
NewGuid = guidMaker.GetGUID()

wscript.Echo newguid

If Len(newguid) < 2 Then
	wscript.Stop
else
	NewGuid = Left(newguid, len(newguid) - 1)
	NewGuid = Right(newguid, len(newguid) - 1)
End If

wscript.Echo "Labeling the manifest with guid: " & newguid

Project.Macros.Add "UPDATER_GUID", newguid
]]></Script>
			<indent type='3'>2</indent>
			<name>Generate Manifest GUID</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[dim GuidMaker
dim NewGuid

Set GuidMaker = CreateObject("GuidMakr.GUID")
NewGuid = guidMaker.GetGUID()

wscript.Echo newguid

If Len(newguid) < 2 Then
	wscript.Stop
else
	NewGuid = Left(newguid, len(newguid) - 1)
	NewGuid = Right(newguid, len(newguid) - 1)
End If

wscript.Echo "Labeling the master manifest with guid: " & newguid

Project.Macros.Add "UPDATER_GUID_MASTER", newguid
]]></Script>
			<indent type='3'>2</indent>
			<name>Generate Master Manifest GUID</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout\Client Tool\Datacastle.Client.ClientTool.exe.config</FileOut>
			<Find><![CDATA[(^\s+<add key="AppUpdate_SetupComplete" value=")(\w+)(" />$)
]]></Find>
			<Replace>($1)false($3)\r\n</Replace>
			<indent type='3'>2</indent>
			<name>Update AppUpdate_SetupComplete</name>
		</step>
		<step action='Group'>
			<condcompareto>True</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BRAND_SIGNED_FLAG%</condexpr>
			<indent type='3'>2</indent>
			<name>Create Signed Manual Update Pack</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\ManualClientUpdate-%RELEASE_VERSION%.%BUILD_VERSION%.zip</Dest>
			<ExclExt><![CDATA[\Client Tool\Theme\*.*
\Logging\*.*
\Tools\*.*
\Client Tool\*.config
\Services\Backup Service\*.config
\Services\Backup Transport Service\*.config
*.rtf]]></ExclExt>
			<Ext>*.*</Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout</Source>
			<condcompareto>Carbonite</condcompareto>
			<condcomparison type='3'>3</condcomparison>
			<condexpr>%BRAND_NAME%</condexpr>
			<indent type='3'>3</indent>
			<name>Create Manual updater pack zip file</name>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\%BRAND_NAME%\%RELEASE_VERSION%.%BUILD_VERSION%\ClientUpdate-%RELEASE_VERSION%.%BUILD_VERSION%.zip</Dest>
			<Ext>*.*</Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\DeploymentLayout</Source>
			<indent type='3'>2</indent>
			<name>Create updater zip file</name>
		</step>
		<step action='Group'>
			<indent type='3'>2</indent>
			<name>Add .Net 3.5 checker to update packs</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Client\SharedFiles\Framework35CheckAndInstall.exe" "%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Client\SharedFiles\UpgradeDependencies.EXE"</command>
			<indent type='3'>3</indent>
			<name>Rename .Net 3.5 checker/installer to update pack bootstrapper well known EXE name</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Enhanced Zip Files'>
			<Action type='3'>2</Action>
			<ComprMethod type='3'>1</ComprMethod>
			<Compression>5</Compression>
			<Dest>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\%BRAND_NAME%\%RELEASE_VERSION%.%BUILD_VERSION%\ClientUpdate-%RELEASE_VERSION%.%BUILD_VERSION%.zip</Dest>
			<Ext>UpgradeDependencies*.EXE</Ext>
			<Hidden type='11'>-1</Hidden>
			<LogDetail type='11'>-1</LogDetail>
			<Recurse type='11'>-1</Recurse>
			<Source>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Client\SharedFiles</Source>
			<indent type='3'>3</indent>
			<name>Add to updater zip file</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileOut>
			<Find><![CDATA[(^\s+<description>Version=)([[\d\.]]+)(:.+$)]]></Find>
			<Replace>($1)%RELEASE_VERSION%.%BUILD_VERSION%($3)</Replace>
			<indent type='3'>2</indent>
			<name>Update manifest.xml - Description Version</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileOut>
			<Find>(^\s+manifestId=")([[a-zA-Z0-9\-]]+)(".+$)</Find>
			<Replace>($1)%UPDATER_GUID%($3)</Replace>
			<indent type='3'>2</indent>
			<name>Update manifest.xml - Manifest ID</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileOut>
			<Find><![CDATA[(^\s+<files base="[[\w\:\/]]+Datacastle/)1.0.0.0(".+)]]></Find>
			<Replace>($1)%RELEASE_VERSION%.%BUILD_VERSION%($2)</Replace>
			<indent type='3'>2</indent>
			<name>Update manifest.xml - files base</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileOut>
			<Find><![CDATA[(^\s+<file source=")[[\w\.]]+(".+)]]></Find>
			<Replace>($1)ClientUpdate-%RELEASE_VERSION%.%BUILD_VERSION%.zip($2)</Replace>
			<indent type='3'>2</indent>
			<name>Update manifest.xml - files source</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[Private Function GetFileSizeMB(Filename)
    Dim Size
    Dim FSize
    Dim fs

    Set fs = CreateObject("Scripting.FileSystemObject")
    Set fsfile = fs.GetFile(filename)
    Size = fsfile.Size

    If Size = "" Then
        Exit Function
    End If

    FSize = ((Size / (1024)) / 1024)
    GetFileSizeMB = Round(FSize, 2)
End Function

Dim FileSizeMB

filesizemb = GetFileSizeMB("%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\%BRAND_NAME%\%RELEASE_VERSION%.%BUILD_VERSION%\ClientUpdate-%RELEASE_VERSION%.%BUILD_VERSION%.zip")

wscript.Echo "update zip is " & filesizemb & "MB"

Project.Macros.Add "UpdateZipSizeMB", filesizemb
]]></Script>
			<indent type='3'>2</indent>
			<name>Set variable - UpdateZipSizeMB</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\manifest.xml</FileOut>
			<Find>(^.+DownloadSize=)[[\d\.]]+(MB:.+)</Find>
			<Replace>($1)%UpdateZipSizeMB%($2)</Replace>
			<indent type='3'>2</indent>
			<name>Update manifest.xml - file size</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\Mastermanifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\Mastermanifest.xml</FileOut>
			<Find><![CDATA[(^\s+<manifest location=")[[\d\.]]+(/manifest.xml" manifestId=")[[\w\-]]+(" />)]]></Find>
			<Replace>($1)%RELEASE_VERSION%.%BUILD_VERSION%($2)%UPDATER_GUID%($3)</Replace>
			<indent type='3'>2</indent>
			<name>Update Mastermanifest.xml - include manifest</name>
		</step>
		<step action='Replace in File'>
			<Attr type='11'>-1</Attr>
			<FileIn>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\Mastermanifest.xml</FileIn>
			<FileOut>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\Mastermanifest.xml</FileOut>
			<Find><![CDATA[(^\s+<description>)([[\d\.]]+)(</description>$)]]></Find>
			<Replace>($1)%RELEASE_VERSION%.%BUILD_VERSION%($3)</Replace>
			<indent type='3'>2</indent>
			<name>Update Mastermanifest.xml - Description Version</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\%BRAND_NAME%</DestDir>
			<Ext>mastermanifest.xml</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Copy Files - Mastermanifest</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\DeploymentFiles\UpdatePacks\%BRAND_NAME%\%RELEASE_VERSION%.%BUILD_VERSION%</DestDir>
			<Ext>manifest.xml</Ext>
			<Incremental type='11'>-1</Incremental>
			<LogCopied type='11'>-1</LogCopied>
			<ReadOnly type='11'>-1</ReadOnly>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<SourceDir>%WORKING_DIRECTORY%\WIP\src\main\Datacastle\Setup\SetupFiles\</SourceDir>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Copy Files - manifest</name>
		</step>
		<step action='Group'>
			<name>File Exists</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[Dim fs
Set fs = CreateObject("Scripting.FileSystemObject")

If fs.FileExists("%FILE_EXISTS_NAME%") Then
	Wscript.Echo "File Exists - %FILE_EXISTS_NAME%"
	Project.Macros.Add "FILE_EXISTS", 1
ELSE
	Wscript.Echo "File DOES NOT Exist - %FILE_EXISTS_NAME%"
	Project.Macros.Add "FILE_EXISTS", 0
End If
]]></Script>
			<indent type='3'>1</indent>
			<name>Does File Exists</name>
		</step>
		<step action='Group'>
			<description>Logs the passed in message with timing. Useful to easily search in log file to see how long build taking.</description>
			<name>Log Major Build Stage</name>
		</step>
		<step action='Log Message'>
			<Message><![CDATA[

%DATETIME%: ---------- MAJOR BUILD STAGE LOG: %BUILD_STAGE%]]></Message>
			<indent type='3'>1</indent>
			<name>Log Message</name>
		</step>
		<step action='Write File'>
			<Append type='11'>-1</Append>
			<Filename>%TIMER_DATA%</Filename>
			<Text><![CDATA[EndpointMidmarket, %BUILD_LEVEL%, %BRANCH%, %BUILD_ID%, %DATETIME%, Execute, Build, %TIMER_MAJOR_STAGE%, %TIMER_MINOR_STAGE%, [Int(Timer() - %TIMER_MINOR%)]
]]></Text>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%TIMER_MINOR_STAGE%</condexpr>
			<indent type='3'>1</indent>
			<name>Write Minor Timing data to  File</name>
		</step>
		<step action='Write File'>
			<Append type='11'>-1</Append>
			<Filename>%TIMER_DATA%</Filename>
			<Text><![CDATA[EndpointMidmarket, %BUILD_LEVEL%, %BRANCH%, %BUILD_ID%, %DATETIME%, Execute, Build, %TIMER_MAJOR_STAGE%, Total, [int(Timer() - %TIMER_MAJOR%)]
]]></Text>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%TIMER_MAJOR_STAGE%</condexpr>
			<indent type='3'>1</indent>
			<name>Write Major Timing data to  File</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr>Start timer so we can write out timing data once this stage is done</MacroDescr>
			<MacroName>TIMER_MAJOR</MacroName>
			<MacroValue>"[Timer()]"</MacroValue>
			<indent type='3'>1</indent>
			<name>Set Major Timer</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr>Store the current stage so we can write out timing data once it is done</MacroDescr>
			<MacroName>TIMER_MAJOR_STAGE</MacroName>
			<MacroValue>%BUILD_STAGE%</MacroValue>
			<indent type='3'>1</indent>
			<name>Set Major Timer Stage</name>
		</step>
		<step action='Set Macro'>
			<Category>Temporary</Category>
			<DeleteMacro type='11'>-1</DeleteMacro>
			<MacroDescr>Store the current seconds since midnight so we can write out timing data once it is done</MacroDescr>
			<MacroName>TIMER_MINOR</MacroName>
			<indent type='3'>1</indent>
			<name>Clear Minor Timer</name>
		</step>
		<step action='Set Macro'>
			<Category>Temporary</Category>
			<DeleteMacro type='11'>-1</DeleteMacro>
			<MacroName>TIMER_MINOR_STAGE</MacroName>
			<indent type='3'>1</indent>
			<name>Clear Minor Timer Stage</name>
		</step>
		<step action='Group'>
			<description>Logs the passed in message with timing. Useful to easily search in log file to see how long build taking.</description>
			<name>Log Minor Build Stage</name>
		</step>
		<step action='Log Message'>
			<Message><![CDATA[
%DATETIME%: ----- MINOR BUILD STAGE LOG: %BUILD_STAGE%]]></Message>
			<indent type='3'>1</indent>
			<name>Log Message</name>
		</step>
		<step action='Write File'>
			<Append type='11'>-1</Append>
			<Filename>%TIMER_DATA%</Filename>
			<Text><![CDATA[EndpointMidmarket, %BUILD_LEVEL%, %BRANCH%, %BUILD_ID%, %DATETIME%, Execute, Build, %TIMER_MAJOR_STAGE%, %TIMER_MINOR_STAGE%, [Int(Timer() - %TIMER_MINOR%)]
]]></Text>
			<condcomparison type='3'>1</condcomparison>
			<condexpr>%TIMER_MINOR_STAGE%</condexpr>
			<indent type='3'>1</indent>
			<name>Write Minor Timing data to  File</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr>Start timer so we can write out timing data once this stage is done</MacroDescr>
			<MacroName>TIMER_MINOR</MacroName>
			<MacroValue>"[Timer()]"</MacroValue>
			<indent type='3'>1</indent>
			<name>Set Minor Timer</name>
		</step>
		<step action='Set Macro'>
			<MacroDescr>Store the current stage so we can write out timing data once it is done</MacroDescr>
			<MacroName>TIMER_MINOR_STAGE</MacroName>
			<MacroValue>%BUILD_STAGE%</MacroValue>
			<indent type='3'>1</indent>
			<name>Set Minor Timer Stage</name>
		</step>
		<step action='Group'>
			<description>Logs the passed in message with timing. Useful to easily search in log file to see how long build taking.</description>
			<name>BuildLocalizedMSI</name>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandSupportsMultipleLocales%</condexpr>
			<indent type='3'>1</indent>
			<name>If this brand is localized</name>
		</step>
		<step action='Copy Files'>
			<Delay>15</Delay>
			<DestDir>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</DestDir>
			<Empty type='11'>-1</Empty>
			<Ext><![CDATA[*.msi
*.mst]]></Ext>
			<Hidden type='11'>-1</Hidden>
			<IgnoreSrc type='11'>-1</IgnoreSrc>
			<Purge type='11'>-1</Purge>
			<ReadOnly type='11'>-1</ReadOnly>
			<Recurse type='11'>-1</Recurse>
			<Restartable type='11'>-1</Restartable>
			<Retries>10</Retries>
			<TBD type='11'>-1</TBD>
			<indent type='3'>2</indent>
			<name>Delete MSI/MSTs from loc working folder</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c move "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\en-us\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1033.msi"</command>
			<indent type='3'>2</indent>
			<name>Move EN-US MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesGerman%</condexpr>
			<indent type='3'>2</indent>
			<name>If German prepare the German MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\de-de\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1031.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy DE-DE MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1031.msi 1031.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for German to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1031.mst 1031</command>
			<indent type='3'>3</indent>
			<name>Merge German MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesFrench%</condexpr>
			<indent type='3'>2</indent>
			<name>If French prepare the French MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\fr-fr\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1036.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy FR-FR MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1036.msi 1036.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for French to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1036.mst 1036</command>
			<indent type='3'>3</indent>
			<name>Merge French MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesSpanish%</condexpr>
			<indent type='3'>2</indent>
			<name>If Spanish prepare the Spanish MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\es-es\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\3082.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy ES-ES MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 3082.msi 3082.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Spanish to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 3082.mst 3082</command>
			<indent type='3'>3</indent>
			<name>Merge Spanish MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesItalian%</condexpr>
			<indent type='3'>2</indent>
			<name>If Italian prepare the Italian MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\it-it\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1040.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy IT-IT MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1040.msi 1040.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Italian to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1040.mst 1040</command>
			<indent type='3'>3</indent>
			<name>Merge Italian MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesPolish%</condexpr>
			<indent type='3'>2</indent>
			<name>If Polish prepare the Polish MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\pl-pl\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1045.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy pl-pl MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1045.msi 1045.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Polish to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1045.mst 1045</command>
			<indent type='3'>3</indent>
			<name>Merge Polish MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesJapanese%</condexpr>
			<indent type='3'>2</indent>
			<name>If Japanese prepare the Japanese MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\ja-jp\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1041.msi"</command>
			<condrepeat type='11'>-1</condrepeat>
			<indent type='3'>3</indent>
			<name>Copy ja-jp MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1041.msi 1041.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Japanese to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1041.mst 1041</command>
			<indent type='3'>3</indent>
			<name>Merge Japanese MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesKorean%</condexpr>
			<indent type='3'>2</indent>
			<name>If Korean prepare the Korean MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\ko-kr\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1042.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy ko-kr MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1042.msi 1042.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Korean to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1042.mst 1042</command>
			<indent type='3'>3</indent>
			<name>Merge Korean MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesPortuguese%</condexpr>
			<indent type='3'>2</indent>
			<name>If Portuguese prepare the Portuguese MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\pt-br\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1046.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy pt-br MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1046.msi 1046.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Portuguese to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1046.mst 1046</command>
			<indent type='3'>3</indent>
			<name>Merge Portuguese MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesChinese%</condexpr>
			<indent type='3'>2</indent>
			<name>If Chinese prepare the Chinese MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\zh-cn\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\2052.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy zh-cn MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 2052.msi 2052.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Chinese to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 2052.mst 2052</command>
			<indent type='3'>3</indent>
			<name>Merge Chinese MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Group'>
			<condcomparison type='3'>6</condcomparison>
			<condexpr>%BRAND_BrandIncludesTurkish%</condexpr>
			<indent type='3'>2</indent>
			<name>If Turkish prepare the Turkish MST</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\tr-tr\DCProtect.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1055.msi"</command>
			<indent type='3'>3</indent>
			<name>Copy tr-tr MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Msitran.exe -g 1033.msi 1055.msi 1055.mst</command>
			<indent type='3'>3</indent>
			<name>Generate MST for Turkish to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c Wisubstg.vbs 1033.msi 1055.mst 1055</command>
			<indent type='3'>3</indent>
			<name>Merge Turkish MST into main one in loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c cscript /B WiLangId.vbs 1033.msi Package %BRAND_LocLCIDs%</command>
			<indent type='3'>2</indent>
			<name>Set the languages available in the resultant MSI to loc working folder</name>
			<outputfrom type='3'>1</outputfrom>
			<startin>%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers</startin>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy "%WORKING_DIRECTORY%\Deployment\Client\win setup\LocHerlpers\1033.msi" "%WORKING_DIRECTORY%\Deployment\Client\win setup\DCProtect\bin\Release\en-us\DCProtect.msi" </command>
			<indent type='3'>2</indent>
			<name>Copy the result from loc working folder back to where installer came from in DCProtect output</name>
			<outputfrom type='3'>1</outputfrom>
		</step></steps>
	<steps type='2'>
		<step action='Group'>
			<name>Exit</name>
		</step>
		<step action='Write File'>
			<Filename>Failure.txt</Filename>
			<Text>%FAILSTEP_OUTPUT%</Text>
			<condcompareto>INTERNAL</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>1</indent>
			<name>Write summary log to BuildOutput</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<checked type='11'>0</checked>
			<command>cmd /c move %LOGFILE% %BUILDOUTPUTDIR_ALL%\</command>
			<condcompareto>INTERNAL</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>1</indent>
			<name>Save Failed Build Log with BuildOutput directory</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Exit'>
			<Status type='3'>1</Status>
			<indent type='3'>1</indent>
			<name>Exit</name>
		</step>
		<step action='Group'>
			<name>Report Unit Test Error</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy %LOGFILE% %BUILDOUTPUTDIR_ALL%\</command>
			<condcompareto>INTERNAL</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>1</indent>
			<name>Save Failed Build Log with BuildOutput directory</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Write File'>
			<Filename>%BUILDOUTPUTDIR_ALL%\TestResults\Result-Summary_%FULL_BUILD_NUMBER%.txt</Filename>
			<Text>%FAILSTEP_OUTPUT%</Text>
			<indent type='3'>1</indent>
			<name>Write File</name>
		</step>
		<step action='Run Script'>
			<Language>VBScript</Language>
			<Script><![CDATA[Dim fso
Dim file
Dim line
Dim FailedTests
Const TestResults = "%BUILDOUTPUTDIR_ALL%\TestResults\Result-Summary_%FULL_BUILD_NUMBER%.txt"

Set fso = CreateObject("Scripting.FileSystemObject")
Set file = fso.OpenTextFile(TestResults, 1, False)

Do Until file.AtEndOfStream
	line = file.ReadLine
	If Left(line, Len("Failed")) = "Failed" Then
		FailedTests = FailedTests + line + vbcrlf
	End If
Loop


wscript.Echo "Failed Tests are: " & vbcrlf & FailedTests

if FailedTests = "" Then
	wscript.Echo "No tests actually failed"
	Set objMacro = vbld_TempMacros.Add("SEND_FAILED_MAIL", "false")
	vbld_AllMacros.Item("UNIT_TESTS_FAILED").Value = "false"
else
	wscript.Echo "Tests actually failed"
	vbld_TempMacros.add "FailedUnitTests", FailedTests, "", "", false
	Set objMacro = vbld_TempMacros.Add("SEND_FAILED_MAIL", "true")
	vbld_AllMacros.Item("UNIT_TESTS_FAILED").Value = "true"
end if

wscript.Echo "Send Mail: " & vbld_AllMacros.Item("SEND_FAILED_MAIL").Value]]></Script>
			<indent type='3'>1</indent>
			<name><![CDATA[Get Failed & Errored Tests]]></name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c copy %LOGFILE% %LOGFILE%_failed_%RELEASE_VERSION%.%BUILD_VERSION%.%BUILD_DATE%.txt</command>
			<indent type='3'>1</indent>
			<name>Backup Failed Build Log</name>
			<outputfrom type='3'>1</outputfrom>
		</step>
		<step action='Group'>
			<name>Report Build of Tests Failure</name>
		</step>
		<step action='Write File'>
			<Filename>%BUILDOUTPUTDIR_ALL%\Failure_%BUILD_LABEL%.txt</Filename>
			<Text>%FAILSTEP_OUTPUT%</Text>
			<checked type='11'>0</checked>
			<condcompareto>INTERNAL</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>1</indent>
			<name>Write summary log to BuildOutput</name>
		</step>
		<step action='Run Program'>
			<ShowCmd type='11'>-1</ShowCmd>
			<command>cmd /c move %LOGFILE% %BUILDOUTPUTDIR_ALL%\</command>
			<condcompareto>INTERNAL</condcompareto>
			<condexpr>%BUILD_TYPE%</condexpr>
			<indent type='3'>1</indent>
			<name>Save Failed Build Log with BuildOutput directory</name>
			<outputfrom type='3'>1</outputfrom>
		</step></steps>
	<macros>
		<macro name='1.0.1.1800'>
			<value>0.1.1800</value>
		</macro>
		<macro name='BRAND_INI'>
			<description>This file keeps track of all Branded releases</description>
			<value>%WORKING_DIRECTORY%\WIP\src\Branding\brand.ini</value>
		</macro>
		<macro name='BRAND_INI_VNEXT'>
			<description>This file keeps track of all Branded releases</description>
			<value>%WORKING_DIRECTORY%\Deployment\Client\Branding\brand.ini</value>
		</macro>
		<macro name='BRAND_LOOP_COUNT'>
			<description>Allows iterations through the ini file</description>
			<value>0</value>
		</macro>
		<macro name='BRAND_LOOP_UBOUND'>
			<description>Number of brands found in the ini files</description>
			<value>0</value>
		</macro>
		<macro name='BRAND_NAME'>
			<description>Brand name found in the ini file</description>
			<value>0</value>
		</macro>
		<macro name='BUILD_DEPENDENCIES'>
			<value>D:\Datacastle\Build\BuildDependencies</value>
		</macro>
		<macro name='BUILD_DEPLOYMENTCONFIG'>
			<value>FremontBob.Config</value>
		</macro>
		<macro name='BUILD_DIRECTORY'>
			<value>%WORKING_DIRECTORY%\Build</value>
		</macro>
		<macro name='BUILD_LOGS'>
			<description>Location to keep copies of old buildlogs in</description>
			<value>buildlogs</value>
		</macro>
		<macro name='BUILD_TYPE'>
		</macro>
		<macro name='BUILD_WORKING'>
			<value>%PROJDIR%\util</value>
		</macro>
		<macro name='BUILDOUTPUT_BASE'>
			<value>%WORKING_DIRECTORY%\BuildOutput</value>
		</macro>
		<macro name='BUILDOUTPUT_PRIVATE'>
			<value>%BUILDOUTPUT_BASE%\Private</value>
		</macro>
		<macro name='BUILDOUTPUT_PUBLIC'>
			<value>%BUILDOUTPUT_BASE%\Public</value>
		</macro>
		<macro name='COMPANY_NAME'>
			<value>Carbonite</value>
		</macro>
		<macro name='COPYRIGHT'>
			<value>Copyright © 2005-2019</value>
		</macro>
		<macro name='DB_PASSWORD'>
			<value>Mon0r4iL</value>
		</macro>
		<macro name='DB_SERVER'>
			<value>APP</value>
		</macro>
		<macro name='DB_USERNAME'>
			<value>dba</value>
		</macro>
		<macro name='DCDB'>
			<description>Name of the database to use for install</description>
			<value>DCTest</value>
		</macro>
		<macro name='DCPASSWD'>
			<value>1234567890</value>
		</macro>
		<macro name='DCUSER'>
			<value>DEVTEST\DCIIS</value>
		</macro>
		<macro name='DEPLOY'>
			<description>Used to kick off "Deploy Vault to test environment (Nightly only) "</description>
			<value>false</value>
		</macro>
		<macro name='DEPLOY_CONFIG'>
			<description><![CDATA[Deployment Config required for deployment of the vault
]]></description>
			<value>FremontBOB</value>
		</macro>
		<macro name='DEPLOY_DIR'>
			<description>NOT EVERYTHING USES THIS YET! The directory to deploy the applications to (on the server)</description>
			<value>c:\datacastle</value>
		</macro>
		<macro name='DEPLOY_INSTALL_ROOT'>
			<value>D:\Datacastle\DEPLOYMENT\</value>
		</macro>
		<macro name='DEPLOY_PASSWORD'>
			<description>Password for the DEPLOY_USER account</description>
			<value>DcBUil4</value>
		</macro>
		<macro name='DEPLOY_SERVER'>
			<description>Name of the server to deploy</description>
			<value>WEB</value>
		</macro>
		<macro name='DEPLOY_USER'>
			<description>Administrator level account on deploy machine, required for deploy</description>
			<value>DCBUILD</value>
		</macro>
		<macro name='DNGuardFolder'>
			<value>C:\Program Files (x86)\DNGuard EnterpriseV380</value>
		</macro>
		<macro name='DOMAIN_NAME'>
			<value>devtest.local</value>
		</macro>
		<macro name='DOTFUSCATOR_FOLDER'>
			<value>C:\Program Files (x86)\PreEmptive Solutions\Dotfuscator Professional Edition 4.33.0</value>
		</macro>
		<macro name='DOTFUSCATOR_VAULT_OBFUSCATE_INI'>
			<value>%WORKING_DIRECTORY%\Deployment\Server\VaultMSIProductionTemplateConfig\DotfuscatorObfuscateSettings.ini</value>
		</macro>
		<macro name='FILE_EXISTS'>
			<value>1</value>
		</macro>
		<macro name='FREE_SPACE_ALERT'>
			<value>0</value>
		</macro>
		<macro name='FREE_SPACE_GB'>
			<value>91.5</value>
		</macro>
		<macro name='INSTALLER_BRAND_CORP_NAME_DEFAULT'>
			<value>Carbonite Corporation</value>
		</macro>
		<macro name='INSTALLER_BRAND_INFO_URL_DEFAULT'>
			<value>www.carbonite.com</value>
		</macro>
		<macro name='INSTALLER_BRAND_NAME_DEFAULT'>
			<value>Carbonite</value>
		</macro>
		<macro name='INSTALLER_BRAND_SUPPORT_URL_DEFAULT'>
			<value>https://support.carbonite.com/endpoint</value>
		</macro>
		<macro name='INSTALLER_BRAND_UPDATE_URL_DEFAULT'>
			<value>https://support.carbonite.com/endpoint</value>
		</macro>
		<macro name='INSTALLER_MANUFACTURER'>
			<value>Carbonite Corporation</value>
		</macro>
		<macro name='INSTALLER_PRODUCT_CODE'>
			<value>{59560D4E-2CEF-446B-A070-B355B1332C99}</value>
		</macro>
		<macro name='INSTALLER_PRODUCTNAME'>
			<value>Carbonite</value>
		</macro>
		<macro name='INSTALLER_REGISTRY'>
			<value>Software\\Datacastle</value>
		</macro>
		<macro name='INSTALLER_REVISION_CODE'>
			<value>{5DDC5742-E0A3-4D24-B0B8-82E4D489957B}</value>
		</macro>
		<macro name='INSTALLER_UPGRADECODE'>
			<value>{DFF9D5AC-C4B0-47CA-B99F-F1BF06014751}</value>
		</macro>
		<macro name='INTERNAL'>
			<value>FALSE</value>
		</macro>
		<macro name='LOGFILE'>
			<value>%PROJDIR%\%PROJROOT%.log</value>
		</macro>
		<macro name='MACBUILD'>
			<value>172.30.19.95</value>
		</macro>
		<macro name='MAIL_SERVER'>
			<description>was mx1.123together.com</description>
			<value>datacastlecorp-com.mail.eo.outlook.com</value>
		</macro>
		<macro name='MAPDIR'>
			<description>Stores Xenocode's mapping file for each build</description>
			<value>%WORKING_DIRECTORY%\buildMaps</value>
		</macro>
		<macro name='MSI_PRODUCTVERSION'>
			<value>3.2.4047</value>
		</macro>
		<macro name='PRODUCT_CODE'>
			<value>{6F683814-7AA0-4456-92BA-DF74FA0CE749}</value>
		</macro>
		<macro name='PRODUCT_NAME'>
			<value>Carbonite</value>
		</macro>
		<macro name='PROGFILES'>
			<value>C:\Program Files (x86)</value>
		</macro>
		<macro name='QuickCache_OBFUSCATE_INI'>
			<value>%WORKING_DIRECTORY%\Deployment\Server\QuickCacheProductionTemplateConfig\DNGuardObfuscateSettings.ini</value>
		</macro>
		<macro name='RELEASE_VERSION_INI'>
			<value>%PROJDIR%\version.ini</value>
		</macro>
		<macro name='ResetServer_OBFUSCATE_INI'>
			<value>%WORKING_DIRECTORY%\Deployment\Server\ResetServerProductionTemplateConfig\DNGuardObfuscateSettings.ini</value>
		</macro>
		<macro name='REVISION_CODE'>
			<value>{C306637E-32C0-4728-9938-149A25CD2D24}</value>
		</macro>
		<macro name='RUN_ATF_TESTS'>
			<description>Set this to run for ATF tests</description>
			<value>FALSE</value>
		</macro>
		<macro name='RUN_AUTOMATED_TESTS'>
			<description>Used to Run Automated Tests (Nightly)</description>
			<value>false</value>
		</macro>
		<macro name='RUN_UNIT_TESTS'>
			<description>Used to Run Unit Tests</description>
			<value>true</value>
		</macro>
		<macro name='RUN_UNIT_TESTS_OBFUSCATED'>
			<description>Used to Run Obfuscated Unit Tests</description>
			<value>false</value>
		</macro>
		<macro name='SEND_MAIL'>
			<value>FALSE</value>
		</macro>
		<macro name='SETUP_NAME'>
			<value>D:\Datacastle\build\Master\DeploymentFiles\DC-2.0.3.2815-Debug.exe</value>
		</macro>
		<macro name='SIGN_DIR'>
			<value>%PROJDIR%</value>
		</macro>
		<macro name='STRONG_NAME_KEY'>
			<value>\\..\\..\\..\\Datacastle\\StrongName\\DCStrongNameKey.snk</value>
		</macro>
		<macro name='TEMP'>
			<envvar type='11'>-1</envvar>
			<value>%WORKING_DIRECTORY%\TEMP</value>
		</macro>
		<macro name='TEST_TYPE'>
			<value>MINIMUM</value>
		</macro>
		<macro name='TF_BRANCH'>
			<description>Name of TFS Branch the code resides (Default Master)</description>
			<value>Main</value>
		</macro>
		<macro name='TF_PROJECT'>
			<description>Name of TFS Project the code resides</description>
			<value>Datacastle</value>
		</macro>
		<macro name='TF_SERVER'>
			<description>Name of Team Foundation Server</description>
			<value>Mocha</value>
		</macro>
		<macro name='TIMER_DATA'>
			<value>%WORKING_DIRECTORY%\build_times.csv</value>
		</macro>
		<macro name='TMP'>
			<envvar type='11'>-1</envvar>
			<value>%TEMP%</value>
		</macro>
		<macro name='tmp_ChangeSet'>
			<description><![CDATA[e.g.
Backup Performance Test;joed]]></description>
			<value>change set name goes here;user-that-submitted-changset</value>
		</macro>
		<macro name='UNIT_TESTS_FAILED'>
			<value>false</value>
		</macro>
		<macro name='UPDATER_GUID'>
			<value>1021BE14-8D7F-47BC-ABD8-0F0A2317FDB7</value>
		</macro>
		<macro name='UPDATER_GUID_MASTER'>
			<value>599EBC47-2D62-4906-8F24-93B023B97E0C</value>
		</macro>
		<macro name='UpdateZipSizeMB'>
			<value>13.16</value>
		</macro>
		<macro name='WEB_NAME'>
			<value>DCTEST</value>
		</macro>
		<macro name='WORKING_DIRECTORY'>
			<value>%PROJDIR%\..</value>
		</macro></macros>
	<script language='VBScript'><![CDATA[Option Explicit

'-------------------------------------------------------------------------------
' Returns a list of the files (not the folders!) under the specified folder
'-------------------------------------------------------------------------------
Public Function GetFilesRecursively(directory, files())
    ReDim files(0) 'Empty the contents of the current files array
    GetFilesRecursively = GetFilesAndFoldersRecursively(directory, files, 0, True)
End Function

'-------------------------------------------------------------------------------
' Returns the FileSystemObject GetFileName() for the given filename
' Note: Used to clean & verify filename
'-------------------------------------------------------------------------------
Public Function GetFileName(filename)
    Dim fs
    Set fs = CreateObject("Scripting.FileSystemObject")
	GetFileName = fs.GetFileName(filename)
End Function

'-------------------------------------------------------------------------------
' Returns true is the specified folder exists
'-------------------------------------------------------------------------------
Public Function DoesFolderExist(folder)
    Dim fs
    Set fs = CreateObject("Scripting.FileSystemObject")
    DoesFolderExist = fs.FolderExists(folder)
End Function

'-------------------------------------------------------------------------------
' Recursively retrieves a list of all Files and Folders
'-------------------------------------------------------------------------------
Public Function GetFilesAndFoldersRecursively(rootFolder, fileList(), numberFiles, filesOnly)

    Dim fso, folder, folders
    Dim files, file, subfolder

    Set fso = CreateObject("Scripting.FileSystemObject")

    If Right(rootFolder, 1) <> "\" Then
        rootFolder = rootFolder & "\"
    End If

    If Not DoesFolderExist(rootFolder) Then
        GetFilesAndFoldersRecursively = -1
        Exit Function
    End If

    Set folder = fso.GetFolder(rootFolder)

    'Get the list of files in the folder
    Set files = folder.files
    For Each file In files
        ReDim Preserve fileList(numberFiles)
        fileList(numberFiles) = rootFolder & file.Name 'add the file to the array
        numberFiles = numberFiles + 1
    Next

    'Get the folder's subfolders
    Set folders = folder.SubFolders
    For Each subfolder In folders
        If Not filesOnly Then
            ReDim Preserve fileList(numberFiles)
            fileList(numberFiles) = rootFolder & subfolder.Name & "\" 'add the file to the array
            numberFiles = numberFiles + 1
        End If
        GetFilesAndFoldersRecursively (rootFolder & subfolder.Name), fileList, numberFiles, filesOnly
    Next

    GetFilesAndFoldersRecursively = numberFiles
End Function

'----------------------------------------------------------------------------------------------------
' Surrounds a given file name with quotation marks
'----------------------------------------------------------------------------------------------------
Public Function QuoteFileName(filename)
	QuoteFileName = """" & filename & """"
End Function

'----------------------------------------------------------------------------------------------------
' Create all levels of specificed directory path
'----------------------------------------------------------------------------------------------------
Public Sub CreatePath(path)
	Dim folders, tempPath, index, startIndex
	'Strip off trailing backslash
	If Right(path, 1) = "\" Then
		path = Left(path, len(path) - 1)
	End If
	'Split path into tokens for each drive/share and folder
	folders = Split(path, "\", -1, vbTextCompare)
	'Handle UNC paths differently to local ones.
	If Left(path, 2) = "\\" Then
		'If path is UNC, then begin creation following the server and share tokens.
		startIndex = LBOUND(folders) + 4
		If startIndex > UBOUND(folders) Then
			'Path does not specify any folders beneath the UNC share level.
			Exit Sub
		End If
		tempPath = "\\" & folders(LBOUND(folders) + 2) & "\" & folders(LBOUND(folders) + 3) & "\"
	Else
		'If path is local, then begin creation following the drive designator.
		startIndex = LBOUND(folders) + 1
		If startIndex > UBOUND(folders) Then
			'Path does not specify any folders beneath the drive level.
			Exit Sub
		End If
		tempPath = folders(LBOUND(folders)) & "\"
	End If
	'Loop through remaining tokens (all folders) and ensure they exist.
	For index = startIndex to UBOUND(folders)
		tempPath = vbld_FSO.BuildPath(tempPath, folders(index))
		If Not (vbld_FSO.FolderExists(tempPath)) Then
			Call vbld_FSO.CreateFolder(tempPath)
			Builder.LogMessage("Created Folder: " & tempPath)
		End If
	Next
End Sub

'----------------------------------------------------------------------------------------------------
'
'----------------------------------------------------------------------------------------------------
Public Sub SaveProjectStatus()
	' Ensure that the file is not read-only
	Call vbld_MakeFileWriteable(Project.Name)
	' The build failed; Save the project with status so it will continue from the failure step during the next build
	Call Project.Save(Project.Name, vbldSaveStatusInclude)
	' Log a message to indicate that the save happened
	Call Builder.LogMessage("Failed Build: Project saved with status")
End Sub

'----------------------------------------------------------------------------------------------------
'
'----------------------------------------------------------------------------------------------------
Public Sub ClearProjectStatus()
	' Ensure that the file is not read-only
	Call vbld_MakeFileWriteable(Project.Name)
	' The build succeeded; Save the project without status so it will begin from the start during the next build
	Call Project.Save(Project.Name, vbldSaveStatusExclude)
	' Log a message to indicate that the save happened
	Call Builder.LogMessage("Good Build: Project status is clean")

End Sub

'----------------------------------------------------------------------------------------------------
'
'----------------------------------------------------------------------------------------------------
Public Function DoesProcessIDExist(ProcessID, ServerName)
    Dim wmi, processlist, process
    Set wmi = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & ServerName & "\root\cimv2")
    Set processlist = wmi.ExecQuery("Select * from Win32_Process where ProcessId = '" & ProcessID & "'")
    For Each process In processlist
        DoesProcessIDExist = true
        Exit Function
    Next
    DoesProcessIDExist = false
End Function

'----------------------------------------------------------------------------------------------------
'
'----------------------------------------------------------------------------------------------------
Public Function CreateProcess(AppExe, ServerName, WaitForCompletion)
	Dim wmi, objProcess, retCode, processID
	Set wmi = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & ServerName & "\root\cimv2")
	Set objProcess = wmi.Get("Win32_Process")
	retCode = objProcess.Create(AppExe, Null, Null, ProcessID)
	If retCode <> 0 Then 'This is just the return code from WMI, not the process return code
		CreateProcess = false
		Exit Function
	End If
	If WaitForCompletion Then
		Do While DoesProcessIDExist(processID, ServerName)
			wscript.Sleep 1000
		Loop
	End If
	CreateProcess = true
End Function]]></script>
</project>